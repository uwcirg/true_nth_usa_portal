{"version":3,"sources":["webpack:///webpack/bootstrap","webpack:///./static/js/src/modules/SYSTEM_IDENTIFIER_ENUM.js","webpack:///./static/js/src/modules/Utility.js","webpack:///./static/js/src/modules/TnthDate.js","webpack:///./static/js/src/modules/CLINICAL_CODE_ENUM.js","webpack:///./static/js/src/modules/TnthAjax.js","webpack:///./static/js/src/modules/OrgTool.js","webpack:///./static/js/src/modules/Procedures.js","webpack:///./static/js/src/profile.js"],"names":["installedModules","__webpack_require__","moduleId","exports","module","i","l","modules","call","m","c","d","name","getter","o","Object","defineProperty","enumerable","get","r","Symbol","toStringTag","value","t","mode","__esModule","ns","create","key","bind","n","object","property","prototype","hasOwnProperty","p","s","__webpack_exports__","external_study_id","external_site_id","practice_region","race","race_system","ethnicity","ethnicity_system","indigenous","timezone","language","language_system","shortname","SNOMED_SYS_URL","CLINICAL_SYS_URL","CANCER_TREATMENT_CODE","NONE_TREATMENT_CODE","getExportFileName","getUrlParameter","UtilityObj","Utility","this","requestAttempts","hasValue","val","String","showMain","$","css","visibility","-ms-filter","filter","-moz-opacity","-khtml-opacity","opacity","hideLoader","delay","time","hide","setTimeout","fadeOut","loader","show","document","getElementById","isDelayLoading","self","DELAY_LOADING","isTouchDevice","window","DocumentTouch","getIEVersion","match","navigator","userAgent","parseInt","newHttpRequest","url","params","callBack","xmlhttp","param","XDomainRequest","onload","responseText","XMLHttpRequest","ActiveXObject","onreadystatechange","readyState","status","error","open","setRequestHeader","cache","send","ajaxRequest","callback","i18next","defaults","type","contentType","timeout","extend","uself","ajax","done","data","fail","always","initWorker","callbackFunc","worker","Worker","postMessage","addEventListener","e","terminate","console","log","lineno","filename","message","workerAllowed","getRequestMethod","sendRequest","useWorker","LRKeyEvent","length","on","keyCode","toggleClass","getLoaderHTML","concat","convertToNumericField","field","each","prop","isString","obj","toString","disableHeaderFooterLinks","links","not","addClass","off","preventDefault","pad","isNaN","escapeHtml","text","replace","a","\"","&","'","/","<",">","containHtmlTags","test","prefix","Date","getDate","slice","getMonth","getFullYear","capitalize","str","txt","charAt","toUpperCase","substr","toLowerCase","restoreVis","loadingElement","mainElement","setAttribute","VueErrorHandling","Vue","config","errorHandler","err","vm","info","handler","current","$options","$parent","extension","results","RegExp","exec","location","search","decodeURIComponent","resetBrowserBackHistory","locationUrl","stateObject","title","historyDefined","history","pushState","href","forward","handlePostLogout","sessionStorage","getItem","orgin","removeItem","displaySystemOutageMessage","locale","MAINTENANCE_MESSAGE","MAINTENANCE_WINDOW","messageElement","querySelector","createElement","classList","add","appendChild","innerHTML","d1","d2","startDate","endDate","hoursTil","Math","floor","getTime","options","year","month","day","hour","minute","second","hour12","timeZoneName","displayStartDate","toLocaleString","displayEndDate","join","validateDateInputFields","tnthDates","monthField","dayField","yearField","errorFieldId","y","validity","valid","errorField","today","date","html","setHours","swap_mm_dd","currentDate","splitDate","split","convertMonthNumeric","jan","feb","mar","apr","may","jun","jul","aug","sep","oct","nov","dec","convertMonthString","1","2","3","4","5","6","7","8","9","10","11","12","isDate","displayDateString","getDateDiff","dateToCalc","dateTime","isValidDefaultDateFormat","dArray","trim","dt","isDateObj","isValidDate","errorMsg","getDateObj","convertedDate","getConvertedDate","givenDate","getGivenDate","h","mi","dateObj","formatDateString","dateString","format","hours","minutes","seconds","nd","iosDateTest","getHours","getMinutes","getSeconds","convertToLocalTime","newDate","getTimezoneOffset","offset","getDateWithTimeZone","dObj","utcDate","getTodayDateObj","td","tm","ty","th","tmi","ts","gmtToday","displayDay","displayMonth","displayYear","displayHour","displayMinute","displaySecond","gmtDate","dateValidator","restrictToPresent","errorMessage","iy","im","iid","CLINICAL_CODE_ENUM","biopsy","code","display","pca_diag","pca_localized","beforeSend","ajaxSetup","xhr","settings","crossDomain","method","userId","defaultParams","attempts","max_attempts","dataType","sync","async","fieldHelper","FieldLoaderHelper","targetField","showLoader","result","JSON","parse","sendError","showError","showUpdate","headers","cache-control","expires","pragma","stringify","reportError","arguments","undefined","page_url","subject_id","delayDuration","el","attr","__timeout","containerId","successField","loadingField","removeClass","animate","getCurrentUser","currentUser","id","setItem","getStillNeededCoreData","entry_method","__url","getRequiredCoreData","required","getOptionalCoreData","sessionStorageKey","getPortalFooter","getOrgs","demoOrgsData","getConsent","setConsent","hasConsent","org","testPatient","user_id","organization_id","agreement_url","agreementUrl","staff_editable","include_in_reports","send_reminders","acceptance_date","deleteConsent","consented","getAllValidConsent","arrExcludedOrgIds","exclude","arrConsents","grep","orgId","eOrg","forEach","withdrawConsent","arrConsent","consent_agreements","item","expired","deleted","consentedOrgIds","map","filterStatus","getDemo","demoDataKey","clearDemoSessionData","putDemo","toSend","getLocale","communication","hasTreatment","entry","sortedArray","sort","b","resource","meta","lastUpdated","found","resourceItemCode","coding","system","procId","SYSTEM_IDENTIFIER_ENUM","getTreatment","postTreatment","started","treatmentDate","deleteTreatment","procID","procArray","subject","reference","performedDateTime","postProc","treatmentData","deleteProc","getProc","newEntry","procedureId","getRoleList","getRoles","removeCachedRoles","putRoles","deleteRoles","getClinical","getObservationId","obId","_code","content","postClinical","toCall","obsCode","obsArray","issued","issuedDate","valueQuantity","units","performer","obsId","getTermsUrl","getInstrumentsList","qList","organization","orgID","questionnaires","q","inArray","questionnaire","push","getTerms","postTermsByUser","postTerms","accessUrl","access_url","invite","passwordReset","assessmentStatus","updateAssessment","assessmentList","assessmentReport","instrumentId","getCurrentQB","completionDate","as_of_date","patientReport","setTablePreference","tableName","getTablePreference","emailLog","auditLog","setting","deactivateUser","reactivateUser","getConfigurationByKey","configVar","sessionConfigKey","getConfiguration","getEmailReady","OrgObj","OrgTool","_SYSTEM_IDENTIFIER_ENUM_js__WEBPACK_IMPORTED_MODULE_0__","_TnthAjax_js__WEBPACK_IMPORTED_MODULE_1__","orgName","parentOrg","children","parentOrgId","isTopLevel","TOP_LEVEL_ORGS","orgsList","initialized","init","orgsData","populateOrgsList","tnthAjax","onLoaded","doPopulateUI","setUserId","populateUI","getUserId","array","Array","isArray","index","getElementParentOrg","closest","getTopLevelOrgs","ml","getOrgsList","orgList","getOrgName","filterOrgs","leafOrgs","allChildrenHidden","subOrgs","find","allSubOrgsHidden","isVisible","is","ip","findOrg","items","keys","parentId","partOf","pop","identifier","getShortName","shortName","orgItem","orgsHTML","container","parentContent","getState","parentOrgsArray","orgA","orgB","parentDiv","parentFragment","createDocumentFragment","parentOrgItem","orgShortName","parentState","parentOrgName","childClinic","_parentOrgId","_parentOrg","_isTopLevel","state","topLevelOrgId","getTopLevelParentOrg","attrObj","dataAttributes","containerClass","textClass","parentOrgContainer","append","getSelectedOrgTopLevelParentOrg","getSelectedOrg","getUserTopLevelParentOrgs","uo","parentList","currentOrg","currentOrgItem","getChildOrgs","orgs","mainOrgsList","childOrgs","getHereBelowOrgs","userOrgs","here_below_orgs","selectedOrg","co","cOrgs","morphPatientOrgs","checkedOrgs","_TnthAjax_js__WEBPACK_IMPORTED_MODULE_0__","_TnthDate_js__WEBPACK_IMPORTED_MODULE_1__","_Utility_js__WEBPACK_IMPORTED_MODULE_2__","_SYSTEM_IDENTIFIER_ENUM_js__WEBPACK_IMPORTED_MODULE_3__","subjectId","currentUserId","dateFields","entries","initCounts","initUserIds","setError","getOptions","getUserProcedures","initFieldExtension","initFieldEvents","initViaTemplate","ready","profileSubject","setSubjectId","setCurrentUserId","setTreatmentOptionsSelector","optionsList","treatmentOptions","treatment_options","getCreatorDisplay","creator","defaultDisplay","getDeleteInvocationDisplay","setNewEntry","highestId","setProcedureRowsView","hasClass","setNoDataDisplay","onDidGetProcedures","eventInput","data-name","data-system","checkSubmit","fn","setDate","remove","initPopoverEvents","popover","trigger","placement","parents","prev","populateProcedureRows","contentHTML","proceduresHtml","otherHtml","indexOf","creatorRef","by","dateEdited","creationText","toLocaleDateString","deleteInvocation","max","fadeIn","handleOtherProcedures","otherProcElements","setAccountCreationRowDisplay","arrProcAttrs","stopImmediatePropagation","isAccountCreation","selectVal","selectDate","selectSystem","selectFriendly","resourceType","reset","data-date","data-date-read","btnId","removeAttr","isTouchScreen","checkDate","df","mf","yf","deField","passedDate","_modules_TnthAjax_js__WEBPACK_IMPORTED_MODULE_0__","_modules_TnthDate_js__WEBPACK_IMPORTED_MODULE_1__","_modules_OrgTool_js__WEBPACK_IMPORTED_MODULE_2__","_modules_SYSTEM_IDENTIFIER_ENUM_js__WEBPACK_IMPORTED_MODULE_3__","_modules_Procedures_js__WEBPACK_IMPORTED_MODULE_4__","_modules_Utility_js__WEBPACK_IMPORTED_MODULE_5__","ProfileObj","components","section-view","props","template","section-view-extension","email-ready-message","errorCaptured","Error","Component","dataError","errorElement","warn","created","registerDependencies","getOrgTool","setUserSettings","onBeforeSectionsLoad","setCurrentUserOrgs","initStartTime","initChecks","setDemoData","setSectionLoaders","onInitChecksDone","roles","role","currentUserRoles","setConfiguration","mounted","nextTick","initIntervalId","setInterval","initEndTime","elapsedTime","clearInterval","initSections","onSectionsDidLoad","handleOptionalCoreData","orgTool","userRoles","userEmailReady","messages","userEmailReadyMessage","userInviteEmailInfoMessage","userInviteEmailErrorMessage","demo","email","given","family","birthDay","birthMonth","birthYear","stateDict","AL","AK","AS","AZ","AR","CA","CO","CT","DE","DC","FM","FL","GA","GU","HI","ID","IL","IN","IA","KS","KY","LA","ME","MH","MD","MA","MI","MN","MS","MO","MT","NE","NV","NH","NJ","NM","NY","NC","ND","MP","OH","OK","OR","PW","PA","PR","RI","SC","SD","TN","TX","UT","VT","VI","VA","WA","WV","WI","WY","CONSENT_ENUM","suspended","purged","consent","consentHeaderArray","consentHistoryHeaderArray","consentLabels","default","withdrawn","consentItems","currentItems","historyItems","touObj","consentDisplayRows","consentListErrorMessage","consentLoading","saveLoading","showInitialConsentTerms","assessment","assessmentListItems","assessmentListError","hasP3PReport","manualEntry","loading","initloading","consentDate","todayObj","patientEmailForm","disableFields","topLevelOrgs","fillViews","bootstrapTableConfig","smartDisplay","showToggle","showColumns","undefinedText","pagination","pageSize","pageList","formatShowingRows","pageFrom","pageTo","totalRows","formatAllRows","formatSearch","formatNoMatches","formatRecordsPerPage","pageNumber","rowStyle","row","background-color","methods","portalModules","notProvidedText","setBootstrapTableConfig","careProvider","isUserEmailReady","setUserEmailReady","reason","isDisableField","fieldId","handleMedidataRaveFields","MEDIDATA_RAVE_FIELDS","MEDIDATA_RAVE_ORG","merge","setDisableAccountCreation","setDisableEditButtons","dataSection","getAttribute","setDisableFields","isAdmin","isSubjectPatient","telecom","use","cellPhone","homePhone","fullName","datesArray","birthDate","displayBirthDate","displayDeceasedDate","deceasedDateTime","deceasedDateObj","getUTCMonth","getUTCDate","getUTCFullYear","toUTCString","deceasedDay","deceasedMonth","deceasedYear","siteId","studyId","languageCode","languageDisplay","valueCodeableConcept","ethnicityCodes","raceCodes","acoContainer","isConsentEditable","isStaff","isCurrentUserPatient","isEditableByStaff","CONSENT_EDIT_PERMISSIBLE_ROLES","isEditableByPatient","isTestEnvironment","SYSTEM_TYPE","initUserRoles","isProxy","currenUserId","isConsentWithTopLevelOrg","CONSENT_WITH_TOP_LEVEL_ORG","getShowInMacro","SHOW_PROFILE_MACROS","clearSectionLoaders","initFieldsEvent","initLoginAsButtons","setView","initEditButtons","ajaxStop","stopPropagation","clear","handleLoginAs","fillSectionView","attachId","targetFields","triggerEvent","parentContainer","setDemoInterval","customErrorField","hasError","errorBlock","sectionsInitialized","initCount","sectionId","initSection","targetSection","optional","sectionElement","section","parent","visibleRows","noDataContainer","btn","sectionID","setContent","clinical","f","initNameSection","initBirthdaySection","initEmailSection","initPhoneSection","initAltPhoneSection","initOrgsStateSelectorSection","initConsentSection","initDefaultOrgsSection","initResetPasswordSection","initCommunicationSection","initPatientEmailFormSection","initStaffRegistrationEmailSection","initDeceasedSection","initPatientReportSection","initAssessmentListSection","initClinicalQuestionsSection","initCustomPatientDetailSection","initProcedureSection","initRolesListSection","initAuditLogSection","ex","alert","postDemoData","editButton","formGroup","getTelecomData","emailVal","phone","altphone","getIdentifierData","studyIdField","siteIdField","identifiers","studyIdObj","siteIdObj","getExtensionData","ethnicityIDs","raceIDs","tzID","tz","__convertToNumericField","blur","updateEmailVis","emailValue","updateTelecomData","event","target","updateExtensionData","updateGenderData","gender","updateLocaleData","targetElement","selectedLocale","clearSessionLocale","reload","updateIdentifierData","getAccessUrl","reloadSendPatientEmailForm","checkedOrgInput","ACCEPT_TERMS_ON_NEXT_ORG","user_documents","pcpReports","getEmailContent","messageId","body","modal","getEmailLog","sent_at","bootstrapTable","classes","sortName","sortOrder","toolbar","columns","searchable","sortable","class","width","emailType","btnEmail","emailTypeElem","selectedOption","btnSelf","emailUrl","returnUrl","accessUrlError","resetBtn","disabled","showLoading","recipients","parentName","return_url","clinicName","btnRef","updateDeceasedSection","isChecked","hasSuspendedConsent","confirmationRequired","LOCALIZED_AFFILIATE_ORG","deceasedBoolean","setDisabledFields","disabledFlag","hidePopover","clearFields","selectedOrgElement","reloadConsentList","fd","fData","document_type","uploaded_at","actions","visible","sessionUserId","arrRefs","authoredDate","authored","reportLink","link","handleSelectedState","newValue","orgsSelector","selectedState","isAcceptOnNextOrg","defaultPrompt","states","__state","region","prepend","parentOrgs","oo_1","oo_2","oo","getParentState","after","selectOptions","selectSortedOptions","sortOptions","empty","getDefaultModal","handleOrgsEvent","setOrgsVis","getConsentList","ckOrg","topLevelOrg","orgsElements","updateOrgs","__modal","getConsentModal","setDefaultConsent","thisElement","handleConsent","handlePcaLocalized","getNoOrgDisplay","getOrgsDisplay","demoArray","preselectClinic","orgIDs","tOrg","__defaultModal","getDefaultAgreementUrl","stockConsentUrl","orgElement","encodeURIComponent","consentParams","removeObsoleteConsent","OT","po","cto","orgModalId","consentText","orgModalElement","clone","tempHTML","__self","modalElements","closeButtons","agreemntUrl","postUpdate","checkedOrg","isLocalizedAffiliatedOrg","updateClinicalSection","clinicalItem","clinicalValue","clinicalUnit","truesyValue","falsyValue","ci","$radios","dString","next","updateTreatment","treatmentCode","hasCancerTreatment","onBeforeInitClinicalQuestionsSection","thisItem","nextAll","diag","patch_dstu2","biopsyDate","arrQ","fieldName","focus","ProcApp","manualEntryModalVis","continueToAssessment","assessment_url","still_needed","winLocation","dataArray","isValid","gmtDateObj","cConsentDate","cToday","nCompletionDate","nConsentDate","nToday","delegate","linkUrl","questionnaire_bank","assessment_status","outstanding_indefinite_work","updateRolesData","audits","ww","len","comment","substring","getConsentHeaderRow","header","getConsentEditDisplayIconHTML","targetElementId","getConsentStatusHTMLObj","statusText","getLREditIconHTML","LROrgId","editorUrlEl","dataShow","isConsentStatusEditable","getConsentStatus","isConsentDateEditable","getConsentRow","sDisplay","statusHTML","contentArray","getConsentOrgDisplayName","_class","viewLinkHTML","isDefaultConsent","getConsentHistoryRow","getRecordedDisplayDate","recorded","cell","topOrgID","topOrg","recordedDate","consentStatus","cflag","se","sr","ir","oDisplayText","tous","fType","truenth_name","accepted","display_type","eproms_agreement_text","truenth_agreement_text","eproms_url_text","truenth_url_text","view","initConsentItemEvent","relatedTarget","data-agreementUrl","data-userId","data-orgId","modalElement","initConsentDateEvents","data-status","datepicker","forceParse","autoclose","ct","cDate","showConsentHistory","hasConsentHistory","hasCurrentConsent","getConsentHistory","consentListReadyIntervalId","existingOrgs"],"mappings":"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","file":"profile.bundle.js","sourcesContent":[" \t// The module cache\n \tvar installedModules = {};\n\n \t// The require function\n \tfunction __webpack_require__(moduleId) {\n\n \t\t// Check if module is in cache\n \t\tif(installedModules[moduleId]) {\n \t\t\treturn installedModules[moduleId].exports;\n \t\t}\n \t\t// Create a new module (and put it into the cache)\n \t\tvar module = installedModules[moduleId] = {\n \t\t\ti: moduleId,\n \t\t\tl: false,\n \t\t\texports: {}\n \t\t};\n\n \t\t// Execute the module function\n \t\tmodules[moduleId].call(module.exports, module, module.exports, __webpack_require__);\n\n \t\t// Flag the module as loaded\n \t\tmodule.l = true;\n\n \t\t// Return the exports of the module\n \t\treturn module.exports;\n \t}\n\n\n \t// expose the modules object (__webpack_modules__)\n \t__webpack_require__.m = modules;\n\n \t// expose the module cache\n \t__webpack_require__.c = installedModules;\n\n \t// define getter function for harmony exports\n \t__webpack_require__.d = function(exports, name, getter) {\n \t\tif(!__webpack_require__.o(exports, name)) {\n \t\t\tObject.defineProperty(exports, name, { enumerable: true, get: getter });\n \t\t}\n \t};\n\n \t// define __esModule on exports\n \t__webpack_require__.r = function(exports) {\n \t\tif(typeof Symbol !== 'undefined' && Symbol.toStringTag) {\n \t\t\tObject.defineProperty(exports, Symbol.toStringTag, { value: 'Module' });\n \t\t}\n \t\tObject.defineProperty(exports, '__esModule', { value: true });\n \t};\n\n \t// create a fake namespace object\n \t// mode & 1: value is a module id, require it\n \t// mode & 2: merge all properties of value into the ns\n \t// mode & 4: return value when already ns object\n \t// mode & 8|1: behave like require\n \t__webpack_require__.t = function(value, mode) {\n \t\tif(mode & 1) value = __webpack_require__(value);\n \t\tif(mode & 8) return value;\n \t\tif((mode & 4) && typeof value === 'object' && value && value.__esModule) return value;\n \t\tvar ns = Object.create(null);\n \t\t__webpack_require__.r(ns);\n \t\tObject.defineProperty(ns, 'default', { enumerable: true, value: value });\n \t\tif(mode & 2 && typeof value != 'string') for(var key in value) __webpack_require__.d(ns, key, function(key) { return value[key]; }.bind(null, key));\n \t\treturn ns;\n \t};\n\n \t// getDefaultExport function for compatibility with non-harmony modules\n \t__webpack_require__.n = function(module) {\n \t\tvar getter = module && module.__esModule ?\n \t\t\tfunction getDefault() { return module['default']; } :\n \t\t\tfunction getModuleExports() { return module; };\n \t\t__webpack_require__.d(getter, 'a', getter);\n \t\treturn getter;\n \t};\n\n \t// Object.prototype.hasOwnProperty.call\n \t__webpack_require__.o = function(object, property) { return Object.prototype.hasOwnProperty.call(object, property); };\n\n \t// __webpack_public_path__\n \t__webpack_require__.p = \"\";\n\n\n \t// Load entry module and return exports\n \treturn __webpack_require__(__webpack_require__.s = 13);\n","export default {\n    \"external_study_id\": \"http://us.truenth.org/identity-codes/external-study-id\",\n    \"external_site_id\": \"http://us.truenth.org/identity-codes/external-site-id\",\n    \"practice_region\": \"http://us.truenth.org/identity-codes/practice-region\",\n    \"race\": \"http://hl7.org/fhir/StructureDefinition/us-core-race\",\n    \"race_system\": \"http://hl7.org/fhir/v3/Race\",\n    \"ethnicity\": \"http://hl7.org/fhir/StructureDefinition/us-core-ethnicity\",\n    \"ethnicity_system\": \"http://hl7.org/fhir/v3/Ethnicity\",\n    \"indigenous\": \"http://us.truenth.org/fhir/StructureDefinition/AU-NHHD-METeOR-id-291036\",\n    \"timezone\": \"http://hl7.org/fhir/StructureDefinition/user-timezone\",\n    \"language\": \"http://hl7.org/fhir/valueset/languages\",\n    \"language_system\": \"urn:ietf:bcp:47\",\n    \"shortname\": \"http://us.truenth.org/identity-codes/shortname\",\n    SNOMED_SYS_URL: \"http://snomed.info/sct\",\n    CLINICAL_SYS_URL: \"http://us.truenth.org/clinical-codes\",\n    CANCER_TREATMENT_CODE: \"118877007\",\n    NONE_TREATMENT_CODE: \"999\"\n};\n\n","var Utility = (function() {\n    var UtilityObj = function() { /*global $ */\n        this.requestAttempts = 0;\n    };\n    UtilityObj.prototype.hasValue = function(val) {\n        return String(val) !== \"null\" && String(val) !== \"\" && String(val) !== \"undefined\";\n    };\n    UtilityObj.prototype.showMain = function() {\n        $(\"#mainHolder\").css({\n            \"visibility\": \"visible\",\n            \"-ms-filter\": \"progid:DXImageTransform.Microsoft.Alpha(Opacity=100)\",\n            \"filter\": \"alpha(opacity=100)\",\n            \"-moz-opacity\": 1,\n            \"-khtml-opacity\": 1,\n            \"opacity\": 1\n        });\n    };\n    UtilityObj.prototype.hideLoader = function(delay, time) {\n        if (delay) {\n            $(\"#loadingIndicator\").hide();\n            return;\n        }\n        setTimeout(function() {\n            $(\"#loadingIndicator\").fadeOut();\n        }, time || 200);\n    };\n    UtilityObj.prototype.loader = function(show) {\n        //landing page\n        if (document.getElementById(\"fullSizeContainer\")) {\n            this.hideLoader();\n            this.showMain();\n            return false;\n        }\n        if (show) {\n            $(\"#loadingIndicator\").show();\n            return;\n        }\n        if (!this.isDelayLoading()) {\n            var self = this;\n            setTimeout(function() {\n                self.showMain();\n            }, 100);\n            this.hideLoader(true, 350);\n        }\n    };\n    UtilityObj.prototype.isDelayLoading = function() { /*global DELAY_LOADING*/\n        return (typeof DELAY_LOADING !== \"undefined\") && DELAY_LOADING;\n    };\n    UtilityObj.prototype.isTouchDevice = function() {\n        return true === (\"ontouchstart\" in window || window.DocumentTouch && document instanceof window.DocumentTouch);\n    };\n    UtilityObj.prototype.getIEVersion = function() {\n        var match = navigator.userAgent.match(/(?:MSIE |Trident\\/.*; rv:)(\\d+)/);\n        return match ? parseInt(match[1]) : false;\n    };\n    UtilityObj.prototype.newHttpRequest = function(url, params, callBack) { /* note: this function supports older version of IE (version <= 9) - jquery ajax calls errored in older IE version*/\n        this.requestAttempts++;\n        var xmlhttp, self = this;\n        callBack = callBack || function() {};\n        if (window.XDomainRequest) { /*global XDomainRequest */\n            xmlhttp = new XDomainRequest();\n            xmlhttp.onload = function() {\n                callBack(xmlhttp.responseText);\n            };\n        } else if (window.XMLHttpRequest) {\n            xmlhttp = new XMLHttpRequest();\n        } else {\n            xmlhttp = new ActiveXObject(\"Microsoft.XMLHTTP\"); /*global ActiveXObject */\n        }\n        xmlhttp.onreadystatechange = function() {\n            if (xmlhttp.readyState === 4) {\n                if (xmlhttp.status === 200) {\n                    callBack(xmlhttp.responseText);\n                    self.requestAttempts = 0;\n                    return;\n                }\n                if (self.requestAttempts < 3) {\n                    setTimeout(function() {\n                        self.newHttpRequest(url, params, callBack);\n                    }, 3000);\n                } else {\n                    callBack({error: xmlhttp.responseText});\n                    self.loader();\n                    self.requestAttempts = 0;\n                }\n            }\n        };\n        params = params || {};\n        xmlhttp.open(\"GET\", url, true);\n        for (var param in params) {\n            if (params.hasOwnProperty(param)) {\n                xmlhttp.setRequestHeader(param, params[param]);\n            }\n        }\n        if (!params.cache) {\n            xmlhttp.setRequestHeader(\"cache-control\", \"no-cache\");\n            xmlhttp.setRequestHeader(\"expires\", \"-1\");\n            xmlhttp.setRequestHeader(\"pragma\", \"no-cache\"); //legacy HTTP 1.0 servers and IE support\n        }\n        xmlhttp.send();\n    };\n    UtilityObj.prototype.ajaxRequest = function(url, params, callback) {\n        callback = callback || function() {};\n        if (!url) {\n            callback({error: i18next.t(\"Url is required.\")});\n            return false;\n        }\n        var defaults = {\n            url: url,\n            type: \"GET\",\n            contentType: \"text/plain\",\n            timeout: 5000,\n            cache: false\n        };\n        params = params || defaults;\n        params = $.extend({}, defaults, params);\n        this.requestAttempts++;\n        var uself = this;\n        $.ajax(params).done(function(data) {\n            callback(data);\n            uself.requestAttempts = 0;\n        }).fail(function() {\n            if (uself.requestAttempts <= 3) {\n                setTimeout(function() { uself.ajaxRequest(url, params, callback);}, 3000);\n            } else {\n                callback({error: i18next.t(\"Error occurred processing request\")}); /*global i18next */\n                uself.requestAttempts = 0;\n                uself.loader();\n            }\n        }).always(function() {\n            uself.loader();\n        });\n    };\n    UtilityObj.prototype.initWorker = function(url, params, callbackFunc) {\n        var worker = new Worker(\"/static/js/ajaxWorker.js\");\n        var self = this;\n        worker.postMessage({url: url, params: params});\n        worker.addEventListener(\"message\", function(e) {\n            (callbackFunc).call(self, e.data);\n            worker.terminate();\n        }, false);\n        worker.addEventListener(\"error\", function(e) {\n            console.log(\"Worker runtime error: Line \", e.lineno, \" in \", e.filename, \": \", e.message);\n            worker.terminate();\n        }, false);\n    };\n    UtilityObj.prototype.workerAllowed = function() {\n        return window.Worker && !this.isTouchDevice();\n    };\n    UtilityObj.prototype.getRequestMethod = function() {\n        return this.getIEVersion() ? this.newHttpRequest: this.ajaxRequest; //NOTE JQuery ajax request does not work for IE <= 9\n    };\n    UtilityObj.prototype.sendRequest = function(url, params, callback) { /*generic function for sending GET ajax request, make use of worker if possible */\n        params = params || {};\n        if (params.useWorker && this.workerAllowed()) {\n            this.initWorker(url, params, callback);\n            return true;\n        }\n        var useFunc = this.getRequestMethod();\n        (useFunc).call(this, url, params, function(data) { (callback).call(this, data);});\n    };\n    UtilityObj.prototype.LRKeyEvent = function() {\n        var LR_INVOKE_KEYCODE = 187;\n        if ($(\".button--LR\").length > 0) {\n            $(\"html\").on(\"keydown\", function(e) {\n                if (parseInt(e.keyCode) === parseInt(LR_INVOKE_KEYCODE)) {\n                    $(\".button--LR\").toggleClass(\"data-show\");\n                }\n            });\n        }\n    };\n    UtilityObj.prototype.getLoaderHTML = function(message) {\n        return `<div class=\"loading-message-indicator\"><i class=\"fa fa-spinner fa-spin fa-2x\"></i>${message ? \"&nbsp;\" + message : \"\"}</div>`;\n    };\n    UtilityObj.prototype.convertToNumericField = function(field) {\n        if (!field) {\n            return;\n        }\n        if (this.isTouchDevice()) {\n            field.each(function() {\n                $(this).prop(\"type\", \"tel\");\n            });\n        }\n    };\n    UtilityObj.prototype.isString = function(obj) {\n        return (Object.prototype.toString.call(obj) === \"[object String]\");\n    };\n    UtilityObj.prototype.disableHeaderFooterLinks = function() {\n        var links = $(\"#tnthNavWrapper a, #homeFooter a\").not(\"a[href*='logout']\").not(\"a.required-link\").not(\"a.home-link\");\n        links.addClass(\"disabled\");\n        links.prop(\"onclick\", null).off(\"click\");\n        links.on(\"click\", function(e) {\n            e.preventDefault();\n            return false;\n        });\n    };\n    UtilityObj.prototype.pad = function(n) {\n        n = parseInt(n);\n        return (!isNaN(n) && n < 10) ? \"0\" + n : n;\n    };\n    UtilityObj.prototype.escapeHtml = function(text) {\n        \"use strict\";\n        if (text === null || text !== \"undefined\" || String(text).length === 0) {\n            return text;\n        }\n        return text.replace(/[\\\"&'\\/<>]/g, function(a) {\n            return {\n                '\"': \"&quot;\",\n                \"&\": \"&amp;\",\n                \"'\": \"&#39;\",\n                \"/\": \"&#47;\",\n                \"<\": \"&lt;\",\n                \">\": \"&gt;\"\n            }[a];\n        });\n    };\n    UtilityObj.prototype.containHtmlTags = function(text) {\n        if (!text) {\n            return false;\n        }\n        return /[<>]/.test(text);\n    };\n    UtilityObj.prototype.getExportFileName = function(prefix) {\n        var d = new Date();\n        return (prefix ? prefix : \"ExportList_\") + (\"00\" + d.getDate()).slice(-2) + (\"00\" + (d.getMonth() + 1)).slice(-2) + d.getFullYear();\n    };\n    UtilityObj.prototype.capitalize = function(str) {\n        return str.replace(/\\w\\S*/g, function(txt) {\n            return txt.charAt(0).toUpperCase() + txt.substr(1).toLowerCase();\n        });\n    };\n    UtilityObj.prototype.restoreVis = function() {\n        var loadingElement = document.getElementById(\"loadingIndicator\"), mainElement = document.getElementById(\"mainHolder\");\n        if (loadingElement) { loadingElement.setAttribute(\"style\", \"display:none; visibility:hidden;\"); }\n        if (mainElement) { mainElement.setAttribute(\"style\", \"visibility:visible;-ms-filter:'progid:DXImageTransform.Microsoft.Alpha(Opacity=100)';filter:alpha(opacity=100); -moz-opacity:1; -khtml-opacity:1; opacity:1\"); }\n    };\n    UtilityObj.prototype.VueErrorHandling = function() {\n        if (typeof Vue === \"undefined\") { return false; } /*global Vue */\n        var self = this;\n        Vue.config.errorHandler = function (err, vm, info)  {\n            var handler, current = vm;\n            if (vm.$options.errorHandler) {\n                handler = vm.$options.errorHandler;\n            } else {\n                while (!handler && current.$parent) {\n                    current = current.$parent;\n                    handler = current.$options.errorHandler;\n                }\n            }\n            self.restoreVis();\n            if (handler) {\n                handler.call(current, err, vm, info);\n                return;\n            }\n            console.log(err);\n        };\n    };\n    UtilityObj.prototype.extend = function(obj, extension) { // Extend an object with an extension\n        for (var key in extension) {\n            if (extension.hasOwnProperty(key)) {\n                obj[key] = extension[key];\n            }\n        }\n        return obj;\n    };\n    UtilityObj.prototype.getUrlParameter = function(name) {\n        name = name.replace(/[\\[]/, \"\\\\[\").replace(/[\\]]/, \"\\\\]\");\n        var regex = new RegExp(\"[\\\\?&]\" + name + \"=([^&#]*)\");\n        var results = regex.exec(location.search);\n        return results === null ? \"\" : decodeURIComponent(results[1]);\n    };\n    UtilityObj.prototype.resetBrowserBackHistory = function(locationUrl, stateObject, title) {\n        var historyDefined = typeof history !== \"undefined\" && history.pushState;\n        locationUrl = locationUrl || location.href;\n        if (historyDefined) {\n            history.pushState(stateObject, title, locationUrl);\n        }\n        window.addEventListener(\"popstate\", function() {\n            if (historyDefined) {\n                history.pushState(stateObject, title, locationUrl);\n            } else {\n                window.history.forward(1);\n            }\n        });\n    };\n    UtilityObj.prototype.handlePostLogout = function() {\n        if (typeof sessionStorage === \"undefined\") {\n            return false;\n        }\n        if (sessionStorage.getItem(\"logout\")) {\n            this.resetBrowserBackHistory(location.orgin, \"logout\"); /* global resetBrowserBackHistory */\n            sessionStorage.removeItem(\"logout\");\n        }\n    };\n    UtilityObj.prototype.displaySystemOutageMessage = function(locale) {\n        locale = locale || \"en-us\";\n        locale = locale.replace(\"_\", \"-\");\n        var systemMaintenanceElId = \"systemMaintenanceContainer\";\n        if (!document.getElementById(systemMaintenanceElId)) { //check for system outage maintenance message element\n            return;\n        }\n        var self = this;\n        this.ajaxRequest(\"api/settings\", {contentType: \"application/json; charset=utf-8\"}, function(data) {\n            if (!data || !(data.MAINTENANCE_MESSAGE || data.MAINTENANCE_WINDOW)) {\n                return false;\n            }\n            var messageElement = document.querySelector(\".message-container\");\n            if (!messageElement) {\n                messageElement = document.createElement(\"div\");\n                messageElement.classList.add(\"message-container\");\n                document.getElementById(systemMaintenanceElId).appendChild(messageElement);\n            }\n            if (data.MAINTENANCE_MESSAGE) {\n                messageElement.innerHTML = self.escapeHtml(data.MAINTENANCE_MESSAGE);\n                return;\n            }\n            if (!data.MAINTENANCE_WINDOW || !data.MAINTENANCE_WINDOW.length) {\n                return;\n            }\n            //use maintenance window specified in config to compose the message, assuming in following example format: [\"2018-11-02T12:00:00Z\", \"2018-11-02T18:00:00Z\"], dates in system ISO format\n            var hoursDiff = function(d1, d2) {\n                if (!d1 || !d2) {\n                    return 0;\n                }\n                return Math.floor(((d2.getTime() - d1.getTime())/ (1000 * 60 * 60)) % 24);\n            };\n            //date object automatically convert iso date/time to local date/time as it assumes a timezone of UTC if date in ISO format\n            var startDate = new Date(data.MAINTENANCE_WINDOW[0]), endDate = new Date(data.MAINTENANCE_WINDOW[1]);\n            var hoursTil = hoursDiff(new Date(), startDate);\n            if (hoursTil < 0 || isNaN(hoursTil)) { //maintenance window has passed\n                document.getElementById(systemMaintenanceElId).classList.add(\"tnth-hide\");\n                return;\n            }\n            /*global i18next */\n            //construct message based on maintenance window\n            try {\n                var options = {year: \"numeric\", month: \"long\", day: \"numeric\", hour: \"numeric\", minute: \"numeric\", second: \"numeric\", hour12: true, timeZoneName: \"short\"};\n                var displayStartDate = startDate.toLocaleString(locale,options).replace(/[,]/g, \" \"); //display language-sensitive representation of date/time\n                var displayEndDate = endDate.toLocaleString(locale, options).replace(/[,]/g, \" \");\n                var message = [\"<div>\" + i18next.t(\"Hi there.\") + \"</div>\",\n                    \"<div>\" + i18next.t(\"TrueNTH will be down for website maintenance starting <b>{startdate}</b>. This should last until <b>{enddate}</b>.\".replace(\"{startdate}\", displayStartDate).replace(\"{enddate}\", displayEndDate)) + \"</div>\",\n                    \"<div>\" + i18next.t(\"Thanks for your patience while we upgrade our site.\") + \"</div>\"].join(\"\");\n                messageElement.innerHTML = self.escapeHtml(message);\n            } catch(e) {\n                console.log(\"Error occurred converting system outage date/time \", e); /*eslint no-console:off */\n                document.getElementById(systemMaintenanceElId).classList.add(\"tnth-hide\");\n            }\n        });\n    };\n    return new UtilityObj();\n})();\nexport default Utility;\nexport var getExportFileName = Utility.getExportFileName; /* expose common functions */\nexport var getUrlParameter= Utility.getUrlParameter;\n","var tnthDates =  { /*global i18next */\n    /** validateDateInputFields  check whether the date is a sensible date in month, day and year fields.\n     ** params: month, day and year fields and error field ID\n     ** NOTE this can replace the custom validation check; hook this up to the onchange/blur event of birthday field\n     ** work better in conjunction with HTML5 native validation check on the field e.g. required, pattern match  ***/\n    \"validateDateInputFields\": function(monthField, dayField, yearField, errorFieldId) {\n        var m = $(monthField).val(), d = $(dayField).val(), y = $(yearField).val();\n        if (m && d && y) {\n            if ($(yearField).get(0).validity.valid && $(monthField).get(0).validity.valid && $(dayField).get(0).validity.valid) {\n                m = parseInt(m);\n                d = parseInt(d);\n                y = parseInt(y);\n                var errorField = $(\"#\" + errorFieldId);\n\n                if (!(isNaN(m)) && !(isNaN(d)) && !(isNaN(y))) {\n                    var today = new Date();\n                    var date = new Date(y, m - 1, d);\n                    if (!(date.getFullYear() === y && (date.getMonth() + 1) === m && date.getDate() === d)) { // Check to see if this is a real date\n                        errorField.html(i18next.t(\"Invalid date. Please try again.\")).show();\n                        return false;\n                    } else if (date.setHours(0, 0, 0, 0) > today.setHours(0, 0, 0, 0)) {\n                        errorField.html(i18next.t(\"Date must not be in the future. Please try again.\")).show();\n                        return false; //shouldn't be in the future\n                    } else if (y < 1900) {\n                        errorField.html(i18next.t(\"Date must not be before 1900. Please try again.\")).show();\n                        return false;\n                    }\n                    errorField.html(\"\").hide();\n                    return true;\n                } else {\n                    return false;\n                }\n            } else {\n                return false;\n            }\n        } else {\n            return false;\n        }\n    },\n    /**\n     * Simply swaps: a/b/cdef to b/a/cdef (single & double digit permutations accepted...)\n     * Does not check for valid dates on input or output!\n     * @param currentDate string eg 7/4/1976\n     * @returns string eg 4/7/1976\n     */\n    \"swap_mm_dd\": function(currentDate) {\n        var splitDate = currentDate.split(\"/\");\n        return splitDate[1] + \"/\" + splitDate[0] + \"/\" + splitDate[2];\n    },\n    \"convertMonthNumeric\": function(month) { //Convert month string to numeric\n        if (!month) { return \"\"; }\n        else {\n            var month_map = {\"jan\": 1,\"feb\": 2,\"mar\": 3,\"apr\": 4,\"may\": 5,\"jun\": 6,\"jul\": 7,\"aug\": 8,\"sep\": 9,\"oct\": 10,\"nov\": 11,\"dec\": 12};\n            var m = month_map[month.toLowerCase()];\n            return m ? m : \"\";\n        }\n    },\n    \"convertMonthString\": function(month) { //Convert month string to text\n        if (!month) {\n            return \"\";\n        } else {\n            var numeric_month_map = {1: \"Jan\",2: \"Feb\",3: \"Mar\",4: \"Apr\",5: \"May\",6: \"Jun\",7: \"Jul\",8: \"Aug\",9: \"Sep\",10: \"Oct\",11: \"Nov\",12: \"Dec\"};\n            var m = numeric_month_map[parseInt(month)];\n            return m ? m : \"\";\n        }\n    },\n    \"isDate\": function(obj) {\n        return Object.prototype.toString.call(obj) === \"[object Date]\" && !isNaN(obj.getTime());\n    },\n    \"displayDateString\": function(m, d, y) {\n        var s = \"\";\n        s += (d ? d : \"\");\n        if (m) {\n            s += (s ? \" \" : \"\") + this.convertMonthString(m);\n        }\n        if (y) {\n            s += (s ? \" \" : \"\") + y;\n        }\n        return s;\n    },\n    /***\n     * Calculates number of days between two dates. Used in mPOWEr for surgery/discharge\n     * @param startDate - required. Assumes YYYY-MM-DD. This is typically the date of surgery or discharge\n     * @param dateToCalc - optional. If empty, then assumes today's date\n     * @returns number of days\n     */\n    \"getDateDiff\": function(startDate, dateToCalc) {\n        if (!startDate) {\n            return 0;\n        }\n        var a = startDate.split(/[^0-9]/);\n        var dateTime = new Date(a[0], a[1] - 1, a[2]).getTime();\n        var d;\n        if (dateToCalc) {\n            var c = dateToCalc.split(/[^0-9]/);\n            d = new Date(c[0], c[1] - 1, c[2]).getTime();\n        } else { // If no baseDate, then use today to find the number of days between dateToCalc and today\n            d = new Date().getTime();\n        }\n        return Math.floor((d - dateTime) / (1000 * 60 * 60 * 24)); // Round down to floor so we don't add an extra day if session is 12+ hours into the day\n    },\n    \"isValidDefaultDateFormat\": function(date, errorField) {\n        if (!date || date.length < 10) { return false; }\n        var dArray = $.trim(date).split(\" \");\n        if (dArray.length < 3) { return false; }\n        var day = parseInt(dArray[0])+\"\", month = dArray[1], year = dArray[2];\n        if (day.length < 1 || month.length < 3 || year.length < 4) { return false; }\n        if (!/(0)?[1-9]|1\\d|2\\d|3[01]/.test(day)) { return false; }\n        if (!/jan|feb|mar|apr|may|jun|jul|aug|sep|oct|nov|dec/i.test(month)) { return false; }\n        if (!/(19|20)\\d{2}/.test(year)) { return false; }\n        var dt = new Date(date);\n        if (!this.isDateObj(dt)) { return false; }\n        else if (!this.isValidDate(year, this.convertMonthNumeric(month), day)) {\n            return false;\n        } else {\n            var today = new Date(),\n                errorMsg = \"\";\n            if (dt.getFullYear() < 1900) { errorMsg = \"Year must be after 1900\"; }\n            // Only allow if date is before today\n            if (dt.setHours(0, 0, 0, 0) > today.setHours(0, 0, 0, 0)) {\n                errorMsg = \"The date must not be in the future.\";\n            }\n            if (errorMsg) {\n                $(errorField).text(errorMsg);\n                return false;\n            } else {\n                $(errorField).text(\"\");\n                return true;\n            }\n        }\n    },\n    \"isDateObj\": function(d) {\n        return Object.prototype.toString.call(d) === \"[object Date]\" && !isNaN(d.getTime());\n    },\n    \"isValidDate\": function(y, m, d) {\n        var date = this.getDateObj(y, m, d), convertedDate = this.getConvertedDate(date), givenDate = this.getGivenDate(y, m, d);\n        return String(givenDate) === String(convertedDate);\n    },\n    /*\n     * method does not check for valid numbers, will return NaN if conversion failed\n     */\n    \"getDateObj\": function(y, m, d, h, mi, s) {\n        h = h || 0;\n        mi = mi || 0;\n        s = s || 0;\n        return new Date(parseInt(y), parseInt(m) - 1, parseInt(d), parseInt(h), parseInt(mi), parseInt(s));\n    },\n    \"getConvertedDate\": function(dateObj) {\n        if (dateObj && this.isDateObj(dateObj)) { return \"\" + dateObj.getFullYear() + (dateObj.getMonth() + 1) + dateObj.getDate(); }\n        else { return \"\"; }\n    },\n    \"getGivenDate\": function(y, m, d) {\n        return \"\" + y + m + d;\n    },\n    \"formatDateString\": function(dateString, format) { //NB For dateString in ISO-8601 format date as returned from server e.g. '2011-06-29T16:52:48'\n        if (dateString) {\n            var iosDateTest = /^([\\+-]?\\d{4}(?!\\d{2}\\b))((-?)((0[1-9]|1[0-2])(\\3([12]\\d|0[1-9]|3[01]))?|W([0-4]\\d|5[0-2])(-?[1-7])?|(00[1-9]|0[1-9]\\d|[12]\\d{2}|3([0-5]\\d|6[1-6])))([T\\s]((([01]\\d|2[0-3])((:?)[0-5]\\d)?|24\\:?00)([\\.,]\\d+(?!:))?)?(\\17[0-5]\\d([\\.,]\\d+)?)?([zZ]|([\\+-])([01]\\d|2[0-3]):?([0-5]\\d)?)?)?)?$/;\n            var d = new Date(dateString);\n            var day, month, year, hours, minutes, seconds, nd;\n            if (!iosDateTest && !isNaN(d) && !this.isDateObj(d)) { //note instantiating ios formatted date using Date object resulted in error in IE\n                return \"\";\n            }\n            if (iosDateTest.test(dateString)) {\n                //IOS date, no need to convert again to date object, just parse it as is\n                //issue when passing it into Date object, the output date is inconsistent across from browsers\n                var dArray = $.trim($.trim(dateString).replace(/[\\.TZ:\\-]/gi, \" \")).split(\" \");\n                year = dArray[0];\n                month = dArray[1];\n                day = dArray[2];\n                hours = dArray[3] || \"0\";\n                minutes = dArray[4] || \"0\";\n                seconds = dArray[5] || \"0\";\n            } else {\n                day = d.getDate();\n                month = d.getMonth() + 1;\n                year = d.getFullYear();\n                hours = d.getHours();\n                minutes = d.getMinutes();\n                seconds = d.getSeconds();\n                nd = \"\";\n            }\n            var pad = function(n) {n = parseInt(n); return (n < 10) ? \"0\" + n : n;};\n            day = pad(day);\n            month = pad(month);\n            hours = pad(hours);\n            minutes = pad(minutes);\n            seconds = pad(seconds);\n\n            switch (format) {\n            case \"mm/dd/yyyy\":\n                nd = month + \"/\" + day + \"/\" + year;\n                break;\n            case \"mm-dd-yyyy\":\n                nd = month + \"-\" + day + \"-\" + year;\n                break;\n            case \"mm-dd-yyyy hh:mm:ss\":\n                nd = month + \"-\" + day + \"-\" + year + \" \" + hours + \":\" + minutes + \":\" + seconds;\n                break;\n            case \"dd/mm/yyyy\":\n                nd = day + \"/\" + month + \"/\" + year;\n                break;\n            case \"dd/mm/yyyy hh:mm:ss\":\n                nd = day + \"/\" + month + \"/\" + year + \" \" + hours + \":\" + minutes + \":\" + seconds;\n                break;\n            case \"dd-mm-yyyy\":\n                nd = day + \"-\" + month + \"-\" + year;\n                break;\n            case \"dd-mm-yyyy hh:mm:ss\":\n                nd = day + \"-\" + month + \"-\" + year + \" \" + hours + \":\" + minutes + \":\" + seconds;\n                break;\n            case \"iso-short\":\n            case \"yyyy-mm-dd\":\n                nd = year + \"-\" + month + \"-\" + day;\n                break;\n            case \"iso\":\n            case \"yyyy-mm-dd hh:mm:ss\":\n                nd = year + \"-\" + month + \"-\" + day + \" \" + hours + \":\" + minutes + \":\" + seconds;\n                break;\n            case \"system\":\n                nd = year + \"-\" + month + \"-\" + day + \"T\" + hours + \":\" + minutes + \":\" + seconds + \"Z\";\n                break;\n            case \"d M y hh:mm:ss\":\n                nd = this.displayDateString(month, day, year);\n                nd = nd + \" \" + hours + \":\" + minutes + \":\" + seconds;\n                break;\n            case \"d M y\":\n                nd = this.displayDateString(month, day, year);\n                break;\n            default:\n                nd = this.displayDateString(month, day, year);\n                break;\n            }\n            return nd;\n        } else {\n            return \"\";\n        }\n    },\n    \"convertToLocalTime\": function(dateString) {\n        var convertedDate = \"\";\n        if (dateString) { //assuming dateString is UTC date/time\n            var d = new Date(dateString);\n            var newDate = new Date(d.getTime() + d.getTimezoneOffset() * 60 * 1000);\n            var offset = d.getTimezoneOffset() / 60;\n            var hours = d.getHours();\n            newDate.setHours(hours - offset);\n            var options = {year: \"numeric\", day: \"numeric\", month: \"short\", hour: \"numeric\", minute: \"numeric\", second: \"numeric\", hour12: false};\n            convertedDate = newDate.toLocaleString(options);\n        }\n        return convertedDate;\n    },\n    getDateWithTimeZone: function(dObj) {\n        /*\n         * param is a date object - calculating UTC date using Date object's timezoneOffset method\n         * the method return offset in minutes, so need to convert it to miliseconds - adding the resulting offset will be the UTC date/time\n         */\n        var utcDate = new Date(dObj.getTime() + (dObj.getTimezoneOffset()) * 60 * 1000);\n        return this.formatDateString(utcDate, \"yyyy-mm-dd hh:mm:ss\");  //I believe this is a valid python date format, will save it as GMT date/time NOTE, conversion already occurred, so there will be no need for backend to convert it again\n    },\n    getTodayDateObj: function() { //return object containing today's date/time information\n        var today = new Date();\n        var td = today.getDate(), tm = today.getMonth() + 1, ty = today.getFullYear();\n        var th = today.getHours(), tmi = today.getMinutes(), ts = today.getSeconds();\n        var gmtToday = this.getDateWithTimeZone(this.getDateObj(ty, tm, td, th, tmi, ts));\n        var pad = function(n) {n = parseInt(n); return (n < 10) ? \"0\" + n : n;};\n        return {\n            date: today,\n            day: td,\n            month: tm,\n            year: ty,\n            hour: th,\n            minute: tmi,\n            second: ts,\n            displayDay: pad(td),\n            displayMonth: pad(tm),\n            displayYear: pad(ty),\n            displayHour: pad(th),\n            displayMinute: pad(tmi),\n            displaySecond: pad(ts),\n            gmtDate: gmtToday\n        };\n    },\n    dateValidator: function(day, month, year, restrictToPresent) { //parameters: day, month and year values in numeric, boolean value for restrictToPresent, true if the date needs to be before today, false is the default\n        var errorMessage = \"\";\n        if (day && month && year) {\n            var iy = parseInt(year), im = parseInt(month), iid = parseInt(day), date = new Date(iy, im - 1, iid);\n            if (date.getFullYear() === iy && (date.getMonth() + 1) === im && date.getDate() === iid) { // Check to see if this is a real date\n                if (iy < 1900) {\n                    errorMessage = i18next.t(\"Year must be after 1900\");\n                }\n                if (restrictToPresent) { // Only allow if date is before today\n                    var today = new Date();\n                    if (date.setHours(0, 0, 0, 0) > today.setHours(0, 0, 0, 0)) {\n                        errorMessage = i18next.t(\"The date must not be in the future.\");\n                    }\n                }\n            } else {\n                errorMessage = i18next.t(\"Invalid Date. Please enter a valid date.\");\n            }\n        } else {\n            errorMessage = i18next.t(\"Missing value.\");\n        }\n        return errorMessage;\n    }\n};\nexport default tnthDates;\nexport var validateDateInputFields = tnthDates.validateDateInputFields; /* generic validation function for global use */\n\n","export default {\n    \"biopsy\": {\n        code: \"111\",\n        display: \"biopsy\"\n    },\n    \"pca_diag\": {\n        code: \"121\",\n        display: \"PCa diagnosis\"\n    },\n    \"pca_localized\": {\n        code: \"141\",\n        display: \"PCa localized diagnosis\"\n    }\n};\n\n","import Utility from \"./Utility.js\";\nimport tnthDates from \"./TnthDate.js\";\nimport SYSTEM_IDENTIFIER_ENUM from \"./SYSTEM_IDENTIFIER_ENUM.js\";\nimport CLINICAL_CODE_ENUM from \"./CLINICAL_CODE_ENUM.js\";\nexport default { /*global $ */\n    \"beforeSend\": function() {\n        $.ajaxSetup({\n            beforeSend: function(xhr, settings) {\n                if (!/^(GET|HEAD|OPTIONS|TRACE)$/i.test(settings.type) && !this.crossDomain) {\n                    xhr.setRequestHeader(\"X-CSRFToken\", $(\"#__CRSF_TOKEN\").val());\n                }\n            }\n        });\n    },\n    \"sendRequest\": function(url, method, userId, params, callback) {\n        if (!url) { return false; }\n        var defaultParams = {type: method ? method : \"GET\", url: url, attempts: 0, max_attempts: 3, contentType: \"application/json; charset=utf-8\", dataType: \"json\", sync: false, timeout: 5000, data: null, useWorker: false, async: true};\n        params = params || defaultParams;\n        params = $.extend({}, defaultParams, params);\n        params.async = params.sync ? false: params.async;\n        var self = this;\n        var fieldHelper = this.FieldLoaderHelper, targetField = params.targetField || null;\n        callback = callback || function() {};\n        params.attempts++;\n        fieldHelper.showLoader(targetField);\n        if (params.useWorker && window.Worker && !Utility.isTouchDevice()) { /*global isTouchDevice()*/\n            Utility.initWorker(url, params, function(result) { /*global initWorker*/\n                var data;\n                try {\n                    data = JSON.parse(result);\n                } catch(e) {\n                    callback({error: \"Error occurred parsing data for \" + url});\n                    return false;\n                }\n                if (!data) {\n                    callback({\"error\": true, \"data\": \"no data returned\"});\n                    fieldHelper.showError(targetField);\n                } else if (data.error) {\n                    callback({\"error\": true, \"data\": data});\n                    self.sendError(data, url, userId, params);\n                    fieldHelper.showError(targetField);\n                } else {\n                    callback(data);\n                    fieldHelper.showUpdate(targetField);\n                }\n            });\n            return true;\n        }\n        if (!params.cache) {\n            params.headers = {\n                \"cache-control\": \"no-cache\",\n                \"expires\": \"-1\",\n                \"pragma\": \"no-cache\"\n            };\n        }\n        $.ajax(params).done(function(data) {\n            params.attempts = 0;\n            if (data) {\n                fieldHelper.showUpdate(targetField);\n                callback(data);\n            } else {\n                fieldHelper.showError(targetField);\n                callback({\"error\": true, \"data\": \"no data returned\"});\n            }\n        }).fail(function(xhr) {\n            if (params.attempts < params.max_attempts) {\n                (function(self, url, method, userId, params, callback) {\n                    setTimeout(function() {\n                        self.sendRequest(url, method, userId, params, callback);\n                    }, 3000); //retry after 3 seconds\n                })(self, url, method, userId, params, callback);\n            } else {\n                params.attempts = 0;\n                fieldHelper.showError(targetField);\n                callback({\"error\": true, \"data\": xhr});\n                self.sendError(xhr, url, userId, params);\n            }\n        });\n    },\n    \"sendError\": function(xhr, url, userId, params) {\n        if (!xhr) { return false; }\n        var errorMessage = \"[Error occurred processing request]  status - \" + (parseInt(xhr.status) === 0 ? \"request timed out/network error\" : xhr.status) + \", response text - \" + (xhr.responseText ? xhr.responseText : \"no response text returned from server\");\n        if (params) {\n            try {\n                errorMessage += \" [data sent]: \" + JSON.stringify(params); //error can happen if for some reason the params are malformed\n            } catch(e) {\n                errorMessage += \" Error occurred transforming sent data: \" + e.message;\n            }\n        }\n        this.reportError(userId ? userId : \"Not available\", url, errorMessage, true);\n    },\n    \"reportError\": function(userId=0, page_url, message, sync) {\n        //params need to contain the following: subject_id: User on which action is being attempted message: Details of the error event page_url: The page requested resulting in the error\n        var params = {};\n        page_url = page_url || window.location.href;\n        params.subject_id = userId;\n        params.page_url = page_url;\n        params.message = \"Error generated in JS - \" + (message ? message.replace(/[\"']/g, \"\") : \"no detail available\"); //don't think we want to translate message sent back to the server here\n        console.log(\"Errors occurred.....\"); /*eslint no-console: off */\n        console.log(params); /*global console*/\n        $.ajax({\n            type: \"GET\",\n            url: \"/report-error\",\n            contentType: \"application/json; charset=utf-8\",\n            cache: false,\n            async: (sync ? false : true),\n            data: params\n        }).done(function() {}).fail(function() {});\n    },\n    \"FieldLoaderHelper\": {\n        delayDuration: 300,\n        showLoader: function(targetField) {\n            if (!targetField || targetField.length === 0) { return false; }\n            var el = $(\"#\" + (targetField.attr(\"data-save-container-id\") || targetField.attr(\"id\")) + \"_load\");\n            el.css(\"opacity\", 1);\n            el.addClass(\"loading\");\n        },\n        showUpdate: function(targetField) {\n            var __timeout = this.delayDuration;\n            if (!targetField || targetField.length === 0) { return false; }\n            setTimeout(function() {\n                (function(targetField) {\n                    var containerId = targetField.attr(\"data-save-container-id\") || targetField.attr(\"id\");\n                    var errorField = $(\"#\" + containerId + \"_error\");\n                    var successField = $(\"#\" + containerId + \"_success\");\n                    var loadingField = $(\"#\" + containerId + \"_load\");\n                    loadingField.removeClass(\"loading\");\n                    errorField.text(\"\").css(\"opacity\", 0);\n                    successField.text(i18next.t(\"success\"));\n                    loadingField.animate({\"opacity\": 0}, __timeout, function() {\n                        successField.animate({\"opacity\": 1}, __timeout, function() {\n                            setTimeout(function() {\n                                successField.animate({\"opacity\": 0}, __timeout * 2);\n                            }, __timeout * 2);\n                        });\n                    });\n                })(targetField);\n            }, __timeout);\n        },\n        showError: function(targetField) {\n            targetField = targetField || $(targetField);\n            var __timeout = this.delayDuration;\n            if (!targetField || targetField.length === 0) { return false; }\n            setTimeout(function() {\n                (function(targetField) {\n                    var containerId = targetField.attr(\"data-save-container-id\") || targetField.attr(\"id\");\n                    var errorField = $(\"#\" + containerId + \"_error\");\n                    var successField = $(\"#\" + containerId + \"_success\");\n                    var loadingField = $(\"#\" + containerId + \"_load\");\n                    loadingField.removeClass(\"loading\");\n                    errorField.text(i18next.t(\"Unable to update. System/Server Error.\"));\n                    successField.text(\"\").css(\"opacity\", 0);\n                    loadingField.animate({\"opacity\": 0}, __timeout, function() {\n                        errorField.animate({\"opacity\": 1}, __timeout, function() {\n                            setTimeout(function() {\n                                errorField.animate({\"opacity\": 0}, __timeout * 2);\n                            }, __timeout * 2);\n                        });\n                    });\n                })(targetField);\n            }, __timeout);\n        }\n    },\n    \"getCurrentUser\": function(callback, params) {\n        callback = callback||function() {};\n        if (sessionStorage.currentUser) {\n            callback(JSON.parse(sessionStorage.currentUser));\n        } else {\n            this.sendRequest(\"/api/me\", \"GET\", \"\", params, function(data) {\n                if (data && data.id) { //make sure the necessary data is there before setting session\n                    sessionStorage.setItem(\"currentUser\", JSON.stringify(data));\n                }\n                callback(data);\n            });\n        }\n    },\n    \"getStillNeededCoreData\": function(userId, sync, callback, entry_method) {\n        callback = callback || function() {};\n        if (!userId) {\n            callback({\"error\": i18next.t(\"User Id is required\")});\n            return false;\n        }\n        var __url = \"/api/coredata/user/\" + userId + \"/still_needed\" + (entry_method ? \"?entry_method=\" + (entry_method).replace(/\\_/g, \" \") : \"\");\n        this.sendRequest(__url, \"GET\", userId, {sync: sync,cache: true}, function(data) {\n            if (!data) {\n                callback({\"error\": i18next.t(\"no data returned\")});\n                return false;\n            }\n            if (data.error) {\n                callback({\"error\": i18next.t(\"unable to get needed core data\")});\n                return false;\n            }\n            callback(data);\n        });\n    },\n    \"getRequiredCoreData\": function(userId, sync, callback) {\n        callback = callback || function() {};\n        if (!userId) {\n            callback({\"error\": i18next.t(\"User Id is required\")});\n            return false;\n        }\n        this.sendRequest(\"/api/coredata/user/\" + userId + \"/required\", \"GET\", userId, {sync: sync,cache: true}, function(data) {\n            if (data) {\n                if (!data.error) {\n                    if (data.required) {\n                        callback(data.required);\n                    } else {\n                        callback({\"error\": i18next.t(\"no data returned\")});\n                    }\n                } else {\n                    callback({\"error\": i18next.t(\"unable to get required core data\")});\n                }\n            } else {\n                callback({\"error\": i18next.t(\"no data returned\")});\n            }\n        });\n    },\n    \"getOptionalCoreData\": function(userId, params, callback) {\n        callback = callback || function() {};\n        if (!userId) {\n            callback({\"error\": i18next.t(\"User Id is required\")});\n            return false;\n        }\n        var __url = \"/api/coredata/user/\" + userId + \"/optional\", sessionStorageKey = \"optionalCoreData_\" + userId;\n        if (sessionStorage.getItem(sessionStorageKey)) {\n            callback(JSON.parse(sessionStorage.getItem(sessionStorageKey)));\n        } else {\n            this.sendRequest(__url, \"GET\", userId, params, function(data) {\n                if (data) {\n                    callback(data);\n                } else {\n                    callback({\"error\": i18next.t(\"no data found\")});\n                }\n            });\n        }\n    },\n    \"getPortalFooter\": function(userId, sync, containerId, callback) {\n        callback = callback || function() {};\n        if (!userId) {\n            callback(\"<div class='error-message'>\" + i18next.t(\"User Id is required\") + \"</div>\");\n            return false;\n        }\n        this.sendRequest(\"/api/portal-footer-html/\", \"GET\", userId, {sync: sync,cache: true,\"dataType\": \"html\"}, function(data) {\n            if (data) {\n                if (!data.error) {\n                    if (containerId) {\n                        $(\"#\" + containerId).html(data);\n                    }\n                    callback(data);\n                } else {\n                    callback(\"<div class='error-message'>\" + i18next.t(\"Unable to retrieve portal footer html\") + \"</div>\");\n                }\n            } else {\n                callback(\"<div class='error-message'>\" + i18next.t(\"No data found\") + \"</div>\");\n            }\n        });\n    },\n    \"getOrgs\": function(userId, params, callback) {\n        callback = callback || function() {};\n        this.sendRequest(\"/api/organization\", \"GET\", userId, params, function(data) {\n            if (sessionStorage.demoOrgsData) {\n                callback(JSON.parse(sessionStorage.demoOrgsData));\n                return true;\n            }\n            if (!data.error) {\n                $(\".get-orgs-error\").html(\"\");\n                sessionStorage.setItem(\"demoOrgsData\", JSON.stringify(data));\n                callback(data);\n            } else {\n                var errorMessage = i18next.t(\"Server error occurred retrieving organization/clinic information.\");\n                $(\".get-orgs-error\").html(errorMessage);\n                callback({\"error\": errorMessage});\n            }\n        });\n    },\n    \"getConsent\": function(userId, params, callback) {\n        callback = callback || function() {};\n        if (!userId) {\n            callback({error: i18next.t(\"User id is required.\")});\n            return false;\n        }\n        this.sendRequest(\"/api/user/\" + userId + \"/consent\", \"GET\", userId, params, function(data) {\n            if (data) {\n                if (!data.error) {\n                    $(\".get-consent-error\").html(\"\");\n                    callback(data);\n                    return true;\n                } else {\n                    var errorMessage = i18next.t(\"Server error occurred retrieving consent information.\");\n                    callback({\"error\": errorMessage});\n                    $(\".get-consent-error\").html(errorMessage);\n                    return false;\n                }\n            }\n        });\n    },\n    \"setConsent\": function(userId, params, status, sync, callback) {\n        callback = callback || function() {};\n        if (!userId && !params) {\n            callback({\"error\": i18next.t(\"User id and parameters are required\")});\n            return false;\n        }\n        var consented = this.hasConsent(userId, params.org, status);\n        var __url = \"/api/user/\" + userId + \"/consent\";\n        if (consented && !params.testPatient) {\n            callback({\"error\": false});\n            return;\n        }\n        var data = {};\n        data.user_id = userId;\n        data.organization_id = params.org;\n        data.agreement_url = params.agreementUrl;\n        data.staff_editable = (String(params.staff_editable) !== \"null\"  && String(params.staff_editable) !== \"undefined\" ? params.staff_editable : false);\n        data.include_in_reports = (String(params.include_in_reports) !== \"null\" && String(params.include_in_reports) !== \"undefined\" ? params.include_in_reports : false);\n        data.send_reminders = (String(params.send_reminders) !== \"null\" &&  String(params.send_reminders) !== \"undefined\"? params.send_reminders : false);\n        if (params.acceptance_date) {\n            data.acceptance_date = params.acceptance_date;\n        }\n        this.sendRequest(__url, \"POST\", userId, {sync: sync, data: JSON.stringify(data)}, function(data) {\n            if (!data.error) {\n                $(\".set-consent-error\").html(\"\");\n                callback(data);\n            } else {\n                var errorMessage = i18next.t(\"Server error occurred setting consent status.\");\n                callback({\"error\": errorMessage});\n                $(\".set-consent-error\").html(errorMessage);\n            }\n        });\n    },\n    deleteConsent: function(userId, params={}) {\n        if (!userId) {\n            return false;\n        }\n        var consented = this.getAllValidConsent(userId, params.org);\n        if (!consented) {\n            return false;\n        }\n        var arrExcludedOrgIds = params.exclude ? params.exclude.split(\",\"): [];\n        var arrConsents = $.grep(consented, function(orgId) {\n            var inArray = $.grep(arrExcludedOrgIds, function(eOrg) {\n                return String(eOrg) === String(orgId);\n            });\n            return !(inArray.length); //filter out org Id(s) that are in the array of org Ids to be excluded;\n        });\n        var self = this;\n        arrConsents.forEach(function(orgId) { //delete all consents for the org\n            self.sendRequest(\"/api/user/\" + userId + \"/consent\", \"DELETE\", userId, {data: JSON.stringify({\"organization_id\": parseInt(orgId)})}, function(data) {\n                if (!data) {\n                    return false;\n                }\n                if (!data.error) {\n                    $(\".delete-consent-error\").html(\"\");\n                } else {\n                    $(\".delete-consent-error\").html(i18next.t(\"Server error occurred removing consent.\"));\n                }\n            });\n        });\n    },\n    withdrawConsent: function(userId, orgId, params, callback) {\n        callback = callback || function() {};\n        params = params || {};\n        if (!userId || !orgId) {\n            callback({\"error\": i18next.t(\"User id and organization id are required.\")});\n            return false;\n        }\n        var self = this, arrConsent = [];\n        this.sendRequest(\"/api/user/\" + userId + \"/consent\", \"GET\", userId, params, function(data) {\n            if (data && data.consent_agreements && data.consent_agreements.length) {\n                arrConsent = $.grep(data.consent_agreements, function(item) {\n                    var expired = tnthDates.getDateDiff(String(item.expires)); /*global tnthDates */\n                    return (String(orgId) === String(item.organization_id)) && !item.deleted && !(expired > 0) && String(item.status) === \"suspended\";\n                });\n            }\n            if (arrConsent.length) { //don't send request if suspended consent already existed\n                callback({\"data\": \"success\"});\n                return false;\n            }\n            self.sendRequest(\"/api/user/\" + userId + \"/consent/withdraw\",\n                \"POST\",\n                userId, {sync: params.sync,data: JSON.stringify({organization_id: orgId})},\n                function(data) {\n                    if (data.error) {\n                        callback({\"error\": i18next.t(\"Error occurred setting suspended consent status.\")});\n                        return false;\n                    }\n                    callback(data);\n                });\n        });\n    },\n    getAllValidConsent: function(userId, orgId) {\n        if (!userId || !orgId) { return false; }\n        var consentedOrgIds = [];\n        this.sendRequest(\"/api/user/\" + userId + \"/consent\", \"GET\", userId, {sync: true}, function(data) {\n            if (!data || data.error || !data.consent_agreements || !data.consent_agreements.length) {\n                return consentedOrgIds;\n            }\n            consentedOrgIds = $.grep(data.consent_agreements, function(item) {\n                var expired = tnthDates.getDateDiff(String(item.expires));\n                return !item.deleted && !(expired > 0) && (String(orgId).toLowerCase() === \"all\" || String(orgId) === String(item.organization_id));\n            });\n            consentedOrgIds = (consentedOrgIds).map(function(item) {\n                return item.organization_id;\n            });\n            return consentedOrgIds;\n        });\n        return consentedOrgIds;\n    },\n    hasConsent: function(userId, orgId, filterStatus) {  /****** NOTE - this will return the latest updated consent entry *******/\n        if (!userId || !orgId || String(filterStatus) === \"default\") { return false; }\n        var consentedOrgIds = [];\n        var __url = \"/api/user/\" + userId + \"/consent\", self = this;\n        self.sendRequest(__url, \"GET\", userId, {sync: true}, function(data) {\n            if (!data || data.error || (data.consent_agreements && data.consent_agreements.length === 0)) {\n                return false;\n            }\n            consentedOrgIds = $.grep(data.consent_agreements, function(item) {\n                var expired = item.expires ? tnthDates.getDateDiff(String(item.expires)) : 0; /*global tnthDates */\n                return (String(orgId) === String(item.organization_id)) && !item.deleted && !(expired > 0) && item.staff_editable && item.send_reminders && item.include_in_reports;\n            });\n        });\n        return consentedOrgIds.length;\n    },\n    \"getDemo\": function(userId, params, callback) {\n        callback = callback || function() {};\n        if (!userId) {\n            callback({\"error\": i18next.t(\"User id is required.\")});\n            return false;\n        }\n        params = params || {};\n        var demoDataKey = \"demoData_\"+userId;\n        if (sessionStorage.getItem(demoDataKey)) {\n            callback(JSON.parse(sessionStorage.getItem(demoDataKey)));\n            return;\n        }\n        this.sendRequest(\"/api/demographics/\" + userId, \"GET\", userId, params, function(data) {\n            var errorMessage = \"\";\n            if (data.error) {\n                errorMessage = i18next.t(\"Server error occurred retrieving demographics information.\");\n                $(\".get-demo-error\").html(errorMessage);\n                callback({\"error\": errorMessage});\n                return false;\n            }\n            $(\".get-demo-error\").html(errorMessage);\n            sessionStorage.setItem(demoDataKey, JSON.stringify(data));\n            callback(data);\n        });\n    },\n    \"clearDemoSessionData\": function(userId) {\n        sessionStorage.removeItem(\"demoData_\"+userId);\n    },\n    \"putDemo\": function(userId, toSend, targetField, sync, callback) {\n        callback = callback || function() {};\n        if (!userId) {\n            callback({\"error\": i18next.t(\"User Id is required\")});\n            return false;\n        }\n        this.clearDemoSessionData(userId);\n        this.sendRequest(\"/api/demographics/\" + userId, \"PUT\", userId, {sync: sync, data: JSON.stringify(toSend),targetField: targetField}, function(data) {\n            if (!data.error) {\n                $(\".put-demo-error\").html(\"\");\n            } else {\n                $(\".put-demo-error\").html(i18next.t(\"Server error occurred setting demographics information.\"));\n            }\n            callback(data);\n        });\n    },\n    \"getLocale\": function(userId) {\n        this.sendRequest(\"/api/demographics/\" + userId, \"GET\", userId, null, function(data) {\n            if (data) {\n                if (!data.error) {\n                    if (data.communication) {\n                        $(\"#profileLocaleTimezoneContainer .get-locale-error\").html(\"\");\n                    }\n                } else {\n                    $(\"#profileLocaleTimezoneContainer .get-locale-error\").html(i18next.t(\"Server error occurred retrieving locale information.\"));\n                }\n            }\n        });\n    },\n    \"hasTreatment\": function(data) {\n        if (!data || !data.entry || data.entry.length === 0) {\n            return false;\n        }\n        var sortedArray = data.entry.sort(function(a, b) { // sort from newest to oldest based on lsat updated date\n            return new Date(b.resource.meta.lastUpdated) - new Date(a.resource.meta.lastUpdated);\n        });\n        var found = false;\n        sortedArray.forEach(function(item) {\n            if (found) { return true; }\n            var resourceItemCode = String(item.resource.code.coding[0].code);\n            var system = String(item.resource.code.coding[0].system);\n            var procId = item.resource.id;\n            if ((resourceItemCode === SYSTEM_IDENTIFIER_ENUM.CANCER_TREATMENT_CODE && (system === SYSTEM_IDENTIFIER_ENUM.SNOMED_SYS_URL)) || (resourceItemCode === SYSTEM_IDENTIFIER_ENUM.NONE_TREATMENT_CODE && (system === SYSTEM_IDENTIFIER_ENUM.CLINICAL_SYS_URL))) {\n                found = {\"code\": resourceItemCode,\"id\": procId};\n            }\n        });\n        return found;\n    },\n    \"getTreatment\": function(userId, params, callback) {\n        callback = callback || function() {};\n        if (!userId) {\n            callback({error: i18next.t(\"User id is required\")});\n            return false;\n        }\n        this.sendRequest(\"/api/patient/\" + userId + \"/procedure\", \"GET\", userId, params, function(data) {\n            if (data.error) {\n                $(\"#userProcedures\").html(\"<span class='error-message'>\" + i18next.t(\"Error retrieving data from server\") + \"</span>\");\n            }\n            callback(data);\n        });\n    },\n    \"postTreatment\": function(userId, started, treatmentDate, targetField) {\n        if (!userId) { return false;}\n        this.deleteTreatment(userId, targetField);\n        var code = SYSTEM_IDENTIFIER_ENUM.NONE_TREATMENT_CODE, display = \"None\", system = SYSTEM_IDENTIFIER_ENUM.CLINICAL_SYS_URL;\n        if (started) {\n            code = SYSTEM_IDENTIFIER_ENUM.CANCER_TREATMENT_CODE;\n            display = \"Procedure on prostate\";\n            system = SYSTEM_IDENTIFIER_ENUM.SNOMED_SYS_URL;\n        }\n        if (!treatmentDate) {\n            var date = new Date();\n            treatmentDate = date.getFullYear() + \"-\" + (date.getMonth() + 1) + \"-\" + date.getDate();  //in yyyy-mm-dd format\n        }\n        var procID = [{\"code\": code,\"display\": display,\"system\": system}];\n        var procArray = {};\n        procArray.resourceType = \"Procedure\";\n        procArray.subject = {\"reference\": \"Patient/\" + userId};\n        procArray.code = {\"coding\": procID};\n        procArray.performedDateTime = treatmentDate ? treatmentDate : \"\";\n        this.postProc(userId, procArray, targetField);\n    },\n    deleteTreatment: function(userId, targetField) {\n        var self = this;\n        this.sendRequest(\"/api/patient/\" + userId + \"/procedure\", \"GET\", userId, {sync: true}, function(data) {\n            if (!data || data.error) { return false; }\n            var treatmentData = self.hasTreatment(data);\n            if (!treatmentData) { return false; }\n            if (String(treatmentData.code) === String(SYSTEM_IDENTIFIER_ENUM.CANCER_TREATMENT_CODE)){\n                self.deleteProc(treatmentData.id, targetField, true);\n                return true;\n            }\n            self.deleteProc(treatmentData.id, targetField, true);\n        });\n    },\n    \"getProc\": function(userId, newEntry, callback) {\n        callback = callback || function() {};\n        this.sendRequest(\"/api/patient/\" + userId + \"/procedure\", \"GET\", userId, null, function(data) {\n            callback(data);\n        });\n    },\n    \"postProc\": function(userId, toSend, targetField, callback) {\n        callback = callback || function() {};\n        this.sendRequest(\"/api/procedure\", \"POST\", userId, {data: JSON.stringify(toSend),targetField: targetField}, function(data) {\n            if (!data) {\n                callback({\"error\": i18next.t(\"no data returned\")});\n                return false;\n            }\n            if (data.error) {\n                var errorMessage = i18next.t(\"Server error occurred saving procedure/treatment information.\");\n                $(\"#userProcuedures .get-procs-error\").html(errorMessage);\n                callback({error: errorMessage});\n                return false;\n            }\n            $(\".get-procs-error\").html(\"\");\n            callback(data);\n        });\n    },\n    \"deleteProc\": function(procedureId, targetField, sync) {\n        this.sendRequest(\"/api/procedure/\" + procedureId, \"DELETE\", null, {sync: sync,targetField: targetField}, function(data) {\n            if (!data.error) {\n                $(\".del-procs-error\").html(\"\");\n            } else {\n                $(\".del-procs-error\").html(i18next.t(\"Server error occurred removing procedure/treatment information.\"));\n            }\n        });\n    },\n    \"getRoleList\": function(params, callback) {\n        this.sendRequest(\"/api/roles\", \"GET\", null, params, function(data) {\n            callback = callback || function() {};\n            if (!data.error) {\n                callback(data);\n            } else {\n                var errorMessage = i18next.t(\"Server error occurred retrieving roles information.\");\n                $(\".get-roles-error\").html(errorMessage);\n                callback({\"error\": errorMessage});\n            }\n        });\n    },\n    \"getRoles\": function(userId, callback, params) {\n        callback = callback || function() {};\n        var sessionStorageKey = \"userRole_\" + userId;\n        if (sessionStorage.getItem(sessionStorageKey)) {\n            var data = JSON.parse(sessionStorage.getItem(sessionStorageKey));\n            callback(data);\n        } else {\n            this.sendRequest(\"/api/user/\" + userId + \"/roles\", \"GET\", userId, params, function(data) {\n                if (data) {\n                    if (!data.error) {\n                        $(\".get-roles-error\").html(\"\");\n                        sessionStorage.setItem(sessionStorageKey, JSON.stringify(data));\n                        callback(data);\n                    } else {\n                        var errorMessage = i18next.t(\"Server error occurred retrieving user role information.\");\n                        $(\".get-roles-error\").html(errorMessage);\n                        callback({\"error\": errorMessage});\n                    }\n                }\n            });\n        }\n    },\n    \"removeCachedRoles\": function(userId) {\n        sessionStorage.removeItem(\"userRole_\"+userId);\n    },\n    \"putRoles\": function(userId, toSend, targetField, callback) {\n        callback = callback || function() {};\n        if (!userId) {\n            callback({error: i18next.t(\"User Id is required.\")});\n            return false;\n        }\n        this.removeCachedRoles(userId);\n        this.sendRequest(\"/api/user/\" + userId + \"/roles\", \"PUT\", userId, {data: JSON.stringify(toSend),targetField: targetField}, function(data) {\n            if (!data || data.error) {\n                var errorMessage = i18next.t(\"Server error occurred setting user role information.\");\n                $(\".put-roles-error\").html(errorMessage);\n                callback({error: errorMessage});\n                return;\n            }\n            $(\".put-roles-error\").html(\"\");\n            sessionStorage.setItem(\"userRole_\" + userId, \"\");\n            callback(data);\n        });\n    },\n    \"deleteRoles\": function(userId, toSend) {\n        if (!userId) {\n            return false;\n        }\n        this.removeCachedRoles(userId);\n        this.sendRequest(\"/api/user/\" + userId, \"GET\", userId, {data: JSON.stringify(toSend)}, function(data) {\n            if (data) {\n                if (!data.error) {\n                    $(\".delete-roles-error\").html(\"\");\n                } else {\n                    $(\".delete-roles-error\").html(i18next.t(\"Server error occurred deleting user role.\"));\n                }\n            }\n        });\n    },\n    \"getClinical\": function(userId, params, callback) {\n        callback = callback || function() {};\n        this.sendRequest(\"/api/patient/\" + userId + \"/clinical\", \"GET\", userId, params, function(data) {\n            if (data) {\n                if (!data.error) {\n                    $(\".get-clinical-error\").html(\"\");\n                    callback(data);\n                } else {\n                    var errorMessage = i18next.t(\"Server error occurred retrieving clinical data.\");\n                    $(\".get-clinical-error\").html(errorMessage);\n                    callback({\"error\": errorMessage});\n                }\n            }\n        });\n    },\n    \"getObservationId\": function(userId, code) {\n        if (!userId) { return false; }\n        var obId = \"\",_code = \"\";\n        this.sendRequest(\"/api/patient/\" + userId + \"/clinical\", \"GET\", userId, {sync: true}, function(data) {\n            if (data) {\n                if (!data.error) {\n                    if (data.entry) {\n                        (data.entry).forEach(function(item) {\n                            if (!obId) {\n                                _code = item.content.code.coding[0].code;\n                                if (String(_code) === String(code)) {\n                                    obId = item.content.id;\n                                }\n                            }\n                        });\n                    }\n                }\n            }\n        });\n        return obId;\n    },\n    \"postClinical\": function(userId, toCall, toSend, status, targetField, params, callback) {\n        if (!userId) { return false; }\n        params = params || {};\n        var code = \"\", display = \"\";\n        if (CLINICAL_CODE_ENUM.hasOwnProperty(String(toCall).toLowerCase())) {\n            var match = CLINICAL_CODE_ENUM[toCall];\n            code = match.code;\n            display = match.display;\n        }\n        if (!code) {\n            return false;\n        }\n        var self = this;\n        var system = SYSTEM_IDENTIFIER_ENUM.CLINICAL_SYS_URL;\n        var method = \"POST\";\n        var url = \"/api/patient/\" + userId + \"/clinical\";\n        var obsCode = [{\"code\": code,\"display\": display,\"system\": system}];\n        var obsArray = {};\n        obsArray.resourceType = \"Observation\";\n        obsArray.code = {\"coding\": obsCode};\n        obsArray.issued = params.issuedDate ? params.issuedDate : \"\";\n        obsArray.status = status ? status : \"\";\n        obsArray.valueQuantity = {\"units\": \"boolean\",\"value\": toSend};\n        if (params.performer) {\n            obsArray.performer = params.performer;\n        }\n        var obsId = self.getObservationId(userId, code);\n        if (obsId) {\n            method = \"PUT\";\n            url = url + \"/\" + obsId;\n        }\n        callback = callback || function() {};\n        this.sendRequest(url, method, userId, {data: JSON.stringify(obsArray),targetField: targetField}, function(data) {\n            if (!data || data.error) {\n                var errorMessage = i18next.t(\"Server error occurred updating clinical data.\");\n                $(\".post-clinical-error\").html(errorMessage).show();\n                callback({error: errorMessage});\n                return;\n            }\n            $(\".post-clinical-error\").html(\"\").hide();\n            callback(data);\n        });\n    },\n    \"getTermsUrl\": function(sync, callback) { /*global i18next */\n        callback = callback || function() {};\n        this.sendRequest(\"/api/tou\", \"GET\", null, {sync: sync}, function(data) {\n            if (data) {\n                if (!data.error) {\n                    $(\".get-tou-error\").html(\"\");\n                    if (data.url) {\n                        $(\"#termsURL\").attr(\"data-url\", data.url);\n                        $(\"#termsCheckbox_default .terms-url\").attr(\"href\", data.url);\n                        callback({\"url\": data.url});\n                    } else {\n                        callback({\"error\": i18next.t(\"no url returned\")});\n                    }\n                } else {\n                    $(\".get-tou-error\").html(i18next.t(\"Server error occurred retrieving tou url.\"));\n                    callback({\"error\": i18next.t(\"Server error\")});\n                }\n            }\n        });\n    },\n    \"getInstrumentsList\": function(sync, callback) { //return instruments list by organization(s)\n        callback = callback || function() {};\n        this.sendRequest(\"api/questionnaire_bank\", \"GET\", null, {\n            sync: sync\n        }, function(data) {\n            if (!data || data.error) {\n                callback({\"error\": i18next.t(\"error retrieving instruments list\")});\n                return;\n            }\n            if (!data.entry || !data.entry.length) {\n                callback({\"error\": i18next.t(\"no data returned\")});\n                return;\n            }\n            var qList = {};\n            (data.entry).forEach(function(item) {\n                if (item.organization) {\n                    var orgID = (item.organization.reference).split(\"/\")[2];\n                    if (!qList[orgID]) {\n                        qList[orgID] = []; //don't assign orgID to object if it was already present\n                    }\n                    if (item.questionnaires) {\n                        (item.questionnaires).forEach(function(q) {\n                            /*\n                             * add instrument name to instruments array for the org - will not add if it is already in the array\n                             * NOTE: inArray returns -1 if the item is NOT in the array\n                             */\n                            if ($.inArray(q.questionnaire.display, qList[orgID]) === -1) {\n                                qList[orgID].push(q.questionnaire.display);\n                            }\n                        });\n                    }\n                }\n            });\n            callback(qList);\n\n        });\n    },\n    \"getTerms\": function(userId, type, sync, callback, params) {\n        callback = callback || function() {};\n        params = params || {};\n        var url = \"/api/user/{userId}/tou{type}{all}\".replace(\"{userId}\", userId)\n            .replace(\"{type}\", type ? (\"/\" + type) : \"\")\n            .replace(\"{all}\", (params.hasOwnProperty(\"all\") ? \"?all=true\" : \"\"));\n        this.sendRequest(url, \"GET\", userId, {sync: sync}, function(data) {\n            if (!data || data.error) {\n                var errorMessage = i18next.t(\"Server error occurred retrieving tou data.\");\n                $(\".get-tou-error\").html(errorMessage);\n                callback({\"error\": errorMessage});\n                return;\n            }\n            $(\".get-tou-error\").html(\"\");\n            callback(data);\n        });\n    },\n    \"postTermsByUser\": function(userId, toSend, callback) {\n        callback = callback || function() {};\n        this.sendRequest(\"/api/user/\" + userId + \"/tou/accepted\", \"POST\", userId, {data: JSON.stringify(toSend)}, function(data) {\n            if (!data || data.error) {\n                $(\".post-tou-error\").html(i18next.t(\"Server error occurred saving terms of use information.\"));\n                callback(data);\n                return;\n            }\n            $(\".post-tou-error\").html(\"\");\n            callback(data);\n        });\n    },\n    \"postTerms\": function(toSend, targetField, callback) {\n        callback = callback || function() {};\n        this.sendRequest(\"/api/tou/accepted\", \"POST\", null, {data: JSON.stringify(toSend), targetField: targetField}, function(data) {\n            if (!data || data.error) {\n                var errorMessage = i18next.t(\"Server error occurred saving terms of use information.\");\n                $(\".post-tou-error\").html(errorMessage);\n                callback({error: errorMessage});\n                return;\n            }\n            $(\".post-tou-error\").html(\"\");\n            callback(data);\n        });\n    },\n    \"accessUrl\": function(userId, sync, callback) {\n        callback = callback || function() {};\n        if (!userId) { callback({\"error\": i18next.t(\"User id is required.\")}); return false; }\n        this.sendRequest(\"/api/user/\" + userId + \"/access_url\", \"GET\", userId, {sync: sync}, function(data) {\n            if (data) {\n                if (!data.error) {\n                    callback({url: data.access_url});\n                } else {\n                    callback({\"error\": i18next.t(\"Error occurred retrieving access url.\")});\n                }\n            } else {\n                callback({\"error\": i18next.t(\"no data returned\")});\n            }\n        });\n    },\n    \"invite\": function(userId, data, callback) {\n        callback = callback || function() {};\n        if (!data) { callback({\"error\": i18next.t(\"Invite data are required.\")}); return false; }\n        this.sendRequest(\"/invite\", \"POST\", userId, {\n            \"contentType\": \"application/x-www-form-urlencoded; charset=UTF-8\",\n            \"data\": data,\n            \"dataType\": \"html\"\n        }, function(data) {\n            if (data) {\n                callback(data);\n            } else {\n                callback({\"error\": i18next.t(\"no data returned\")});\n            }\n        });\n    },\n    \"passwordReset\": function(userId, callback) {\n        callback = callback || function() {};\n        if (!userId) { callback({\"error\": i18next.t(\"User id is required.\")}); return false; }\n        this.sendRequest(\"/api/user/\" + userId + \"/password_reset\", \"POST\", userId, {\"contentType\": \"application/x-www-form-urlencoded; charset=UTF-8\"}, function(data) {\n            if (data) {\n                if (!data.error) {\n                    callback(data);\n                } else {\n                    callback({\"error\": i18next.t(\"Error occurred sending password reset request.\")});\n                }\n            } else {\n                callback({\"error\": i18next.t(\"no data returned\")});\n            }\n        });\n    },\n    \"assessmentStatus\": function(userId, callback) {\n        callback = callback || function() {};\n        if (!userId) { callback({\"error\": i18next.t(\"User id is required.\")}); return false; }\n        this.sendRequest(\"/api/patient/\" + userId + \"/assessment-status\", \"GET\", userId, null, function(data) {\n            if (data) {\n                if (!data.error) {\n                    callback(data);\n                } else {\n                    callback({\"error\": i18next.t(\"Error occurred retrieving assessment status.\")});\n                }\n            } else {\n                callback({\"error\": i18next.t(\"no data returned\")});\n            }\n        });\n    },\n    \"updateAssessment\": function(userId, data, callback) {\n        callback = callback || function() {};\n        if (!userId) { callback({\"error\": i18next.t(\"User id is required.\")}); return false; }\n        if (!data) { callback({\"error\": i18next.t(\"Questionnaire response data is required.\")}); return false;}\n        this.sendRequest(\"/api/patient/\" + userId + \"/assessment\", \"PUT\", userId, {data: JSON.stringify(data)}, function(data) {\n            if (data) {\n                if (!data.error) {\n                    callback(data);\n                } else {\n                    callback({\"error\": i18next.t(\"Error occurred retrieving assessment list.\")});\n                }\n\n            } else {\n                callback({\"error\": i18next.t(\"no data returned\")});\n            }\n        });\n    },\n    \"assessmentList\": function(userId, params, callback) {\n        callback = callback || function() {};\n        if (!userId) {\n            callback({error: i18next.t(\"User id is required.\")});\n            return false;\n        }\n        this.sendRequest(\"/api/patient/\" + userId + \"/assessment\", \"GET\", userId, params, function(data) {\n            if (data) {\n                if (!data.error) {\n                    callback(data);\n                } else {\n                    callback({\"error\": i18next.t(\"Error occurred retrieving assessment list.\")});\n                }\n            } else {\n                callback({\"error\": i18next.t(\"no data returned\")});\n            }\n        });\n    },\n    \"assessmentReport\": function(userId, instrumentId, callback) {\n        callback = callback || function() {};\n        if (!userId || !instrumentId) {\n            callback({error: i18next.t(\"User id and instrument Id are required.\")});\n            return false;\n        }\n        this.sendRequest(\"/api/patient/\" + userId + \"/assessment/\" + instrumentId, \"GET\", userId, null, function(data) {\n            if (data) {\n                if (!data.error) {\n                    callback(data);\n                } else {\n                    callback({\"error\": i18next.t(\"Error occurred retrieving assessment report.\")});\n                }\n            } else {\n                callback({\"error\": i18next.t(\"no data returned\")});\n            }\n        });\n    },\n    \"getCurrentQB\": function(userId, completionDate, params, callback) {\n        callback = callback || function() {};\n        if (!userId) {\n            callback({error: i18next.t(\"User id is required.\")});\n            return false;\n        }\n        params = params || {};\n        this.sendRequest(\"/api/user/\" + userId + \"/questionnaire_bank\", \"GET\", userId, {data: {as_of_date: completionDate}, sync: params.sync}, function(data) {\n            if (!data || data.error) {\n                callback({\"error\": i18next.t(\"Error occurred retrieving current questionnaire bank for user.\")});\n                return false;\n            }\n            callback(data);\n        });\n    },\n    \"patientReport\": function(userId, params, callback) {\n        callback = callback || function() {};\n        if (!userId) {\n            callback({error: i18next.t(\"User id is required.\")});\n            return false;\n        }\n        this.sendRequest(\"/api/user/\" + userId + \"/user_documents?document_type=PatientReport\", \"GET\", userId, params, function(data) {\n            if (data) {\n                if (!data.error) {\n                    callback(data);\n                } else {\n                    callback({\"error\": i18next.t(\"Error occurred retrieving patient report.\")});\n                }\n            } else {\n                callback({\"error\": i18next.t(\"no data returned\")});\n            }\n        });\n    },\n    \"setTablePreference\": function(userId, tableName, params, callback) {\n        callback = callback || function() {};\n        params = params || {};\n        if (!userId || !tableName) {\n            callback({error: \"User Id and table name is required for setting preference.\"});\n            return false;\n        }\n        this.sendRequest(\"/api/user/\" + userId + \"/table_preferences/\" + tableName, \"PUT\", userId, {\"data\": params.data,\"sync\": params.sync}, function(data) {\n            if (!data || data.error) {\n                callback({\"error\": i18next.t(\"Error occurred setting table preference.\")});\n                return false;\n            }\n            callback(data);\n        });\n    },\n    \"getTablePreference\": function(userId, tableName, params, callback) {\n        params = params || function() {};\n        callback = callback || function(){};\n        if (!userId) {\n            callback({error: \"User Id is required for setting preference.\"});\n            return false;\n        }\n        this.sendRequest(\"/api/user/\" + userId + \"/table_preferences/\" + tableName, \"GET\", userId, params, function(data) {\n            if (data && data.error) {\n                callback({\"error\": i18next.t(\"Error occurred setting table preference.\")});\n                return;\n            }\n            callback(data);\n        });\n    },\n    \"emailLog\": function(userId, params, callback) {\n        callback = callback || function() {};\n        if (!userId) {\n            callback({error: i18next.t(\"User id is required.\")});\n            return false;\n        }\n        this.sendRequest(\"/api/user/\" + userId + \"/messages\", \"GET\", userId, params, function(data) {\n            if (data) {\n                if (!data.error) {\n                    callback(data);\n                } else {\n                    callback({\"error\": i18next.t(\"Error occurred retrieving email audit entries.\")});\n                }\n            } else {\n                callback({\"error\": i18next.t(\"no data returned\")});\n            }\n        });\n    },\n    \"auditLog\": function(userId, params, callback) {\n        callback = callback || function() {};\n        if (!userId) {\n            callback({error: i18next.t(\"User id is required.\")});\n            return false;\n        }\n        this.sendRequest(\"/api/user/\" + userId + \"/audit\", \"GET\", userId, params, function(data) {\n            if (data) {\n                if (!data.error) {\n                    callback(data);\n                } else {\n                    callback({\"error\": i18next.t(\"Error occurred retrieving audit log.\")});\n                }\n            } else {\n                callback({\"error\": i18next.t(\"no data returned\")});\n            }\n        });\n    },\n    \"setting\": function(key, userId, params, callback) {\n        callback = callback || function() {};\n        if (!key) {\n            callback({\"error\": i18next.t(\"configuration key is required.\")});\n            return false;\n        }\n        params = params || {};\n        this.sendRequest(\"/api/settings/\" + key, \"GET\", userId, {\n            \"sync\": params.sync\n        }, function(data) {\n            if (data) {\n                if (!data.error) {\n                    callback(data);\n                } else {\n                    callback({\"error\": i18next.t(\"Error occurred retrieving content for configuration key.\")});\n                }\n            } else {\n                callback({\"error\": i18next.t(\"no data returned\")});\n            }\n        });\n    },\n    \"deactivateUser\": function(userId, params, callback) {\n        callback = callback||function() {};\n        if (!userId) {\n            callback({\"error\": i18next.t(\"User id is required\")});\n            return false;\n        }\n        this.sendRequest(\"/api/user/\" + userId, \"DELETE\", userId, (params || {}), function(data) {\n            callback = callback||function() {};\n            if (!data || data.error) {\n                callback({\"error\": i18next.t(\"Error occurred deactivating user.\")});\n                return;\n            }\n            callback(data);\n        });\n    },\n    \"reactivateUser\": function(userId, params, callback) {\n        callback = callback||function() {};\n        if (!userId) {\n            callback({\"error\": i18next.t(\"User id is required\")});\n            return false;\n        }\n        this.sendRequest(\"/api/user/\" + userId + \"/reactivate\", \"POST\", userId, (params || {}), function(data) {\n            if (!data || data.error) {\n                callback({\"error\": i18next.t(\"Error occurred reactivating user.\")});\n                return;\n            }\n            callback(data);\n        });\n    },\n    \"getConfigurationByKey\": function(configVar, params, callback) {\n        callback = callback || function() {};\n        if (!configVar) {\n            callback({\"error\": i18next.t(\"configuration variable name is required.\")});\n            return false;\n        }\n        var sessionConfigKey = \"config_\" + configVar;\n        if (sessionStorage.getItem(sessionConfigKey)) {\n            var data = JSON.parse(sessionStorage.getItem(sessionConfigKey));\n            callback(data);\n            return true;\n        }\n        this.sendRequest(\"/api/settings/\" + configVar, \"GET\", null, (params || {}), function(data) {\n            if (!data) {\n                callback({\"error\": i18next.t(\"no data returned\")});\n                return;\n            }\n            callback(data);\n            sessionStorage.setItem(sessionConfigKey, JSON.stringify(data));\n        });\n    },\n    \"getConfiguration\": function(userId, params, callback) {\n        callback = callback || function() {};\n        var sessionConfigKey = \"settings_\" + userId;\n        if (sessionStorage.getItem(sessionConfigKey)) {\n            var data = JSON.parse(sessionStorage.getItem(sessionConfigKey));\n            callback(data);\n            return;\n        }\n        this.sendRequest(\"/api/settings\", \"GET\", userId, (params || {}), function(data) {\n            if (data) {\n                callback(data);\n                sessionStorage.setItem(sessionConfigKey, JSON.stringify(data));\n            } else {\n                callback({\n                    \"error\": i18next.t(\"no data returned\")\n                });\n            }\n        });\n\n    },\n    \"getEmailReady\": function(userId, params, callback) {\n        callback = callback || function() {};\n        if (!userId) {\n            callback({error: i18next.t(\"User id is required.\")});\n            return false;\n        }\n        this.sendRequest(\"/api/user/\" + userId + \"/email_ready\", \"GET\", userId, params, function(data) {\n            callback(data);\n        });\n    }\n};\n","import SYSTEM_IDENTIFIER_ENUM from \"./SYSTEM_IDENTIFIER_ENUM.js\";\nimport tnthAjax from \"./TnthAjax.js\";\nexport default (function() { /*global i18next $ */\n    var OrgObj = function(orgId, orgName, parentOrg) {\n        this.id = orgId;\n        this.name = orgName;\n        this.children = [];\n        this.parentOrgId = parentOrg;\n        this.isTopLevel = false;\n        this.language = null;\n        this.extension = [];\n    };\n\n    var OrgTool = function() {\n        this.TOP_LEVEL_ORGS = [];\n        this.orgsList = {};\n        this.initialized = false;\n    };\n\n    OrgTool.prototype.init = function(callback) {\n        var self = this;\n        callback = callback || function() {};\n        if (sessionStorage.orgsData) {\n            var orgsData = JSON.parse(sessionStorage.orgsData);\n            self.populateOrgsList(orgsData);\n            callback(orgsData);\n        } else {\n            $.ajax({\n                type: \"GET\",\n                url: \"/api/organization\",\n                async: false\n            }).done(function(data) {\n                if (data && data.entry) {\n                    self.populateOrgsList(data.entry);\n                    sessionStorage.setItem(\"orgsData\", JSON.stringify(data.entry));\n                    callback(data.entry);\n                }\n            }).fail(function(xhr) {\n                callback({\"error\": xhr.responseText});\n                tnthAjax.sendError(xhr, \"/api/organization\");\n            });\n        }\n    };\n    OrgTool.prototype.onLoaded = function(userId, doPopulateUI) {\n        if (userId) { this.setUserId(userId); }\n        if (doPopulateUI) { this.populateUI(); }\n        $(\"#userOrgs input[name='organization']\").each(function() {\n            $(this).prop(\"checked\", false);\n        });\n        $(\"#clinics\").attr(\"loaded\", true);\n    };\n    OrgTool.prototype.setUserId = function(userId) {\n        $(\"#fillOrgs\").attr(\"userId\", userId);\n    };\n    OrgTool.prototype.getUserId = function() {\n        return $(\"#fillOrgs\").attr(\"userId\");\n    };\n    OrgTool.prototype.inArray = function(n, array){\n        if (!n || !array || !Array.isArray(array)) { return false; }\n        var found = false;\n        for (var index = 0; !found && index < array.length; index++) {\n            found = String(array[index]) === String(n);\n        }\n        return found;\n    };\n    OrgTool.prototype.getElementParentOrg = function(o){\n        var parentOrg;\n        if (!o) {\n            return false;\n        }\n        parentOrg = $(o).attr(\"data-parent-id\");\n        if (!parentOrg) {\n            parentOrg = $(o).closest(\".org-container[data-parent-id]\").attr(\"data-parent-id\");\n        }\n        return parentOrg;\n    };\n    OrgTool.prototype.getTopLevelOrgs = function() {\n        var ml = this.getOrgsList(), orgList = [];\n        for (var org in ml) {\n            if (ml[org].isTopLevel) {\n                orgList.push(org);\n            }\n        }\n        return orgList;\n    };\n    OrgTool.prototype.getOrgsList = function(){\n        return this.orgsList;\n    };\n    OrgTool.prototype.getOrgName = function(orgId){\n        var orgsList = this.getOrgsList();\n        if (orgId && orgsList.hasOwnProperty(orgId)) {\n            return orgsList[orgId].name;\n        }\n        return \"\";\n    };\n    OrgTool.prototype.filterOrgs = function(leafOrgs) {\n        leafOrgs = leafOrgs || [];\n        if (leafOrgs.length === 0) { return false; }\n        var self = this;\n        $(\"#fillOrgs input[name='organization']\").each(function() {\n            if (!self.inArray($(this).val(), leafOrgs)) {\n                $(this).hide();\n                if (self.orgsList[$(this).val()]) {\n                    var l = $(this).closest(\"label\");\n                    if (self.orgsList[$(this).val()].children.length === 0) {\n                        l.hide();\n                    } else {\n                        l.addClass(\"data-display-only\");\n                    }\n                }\n            }\n        });\n\n        var topList = self.getTopLevelOrgs();\n        topList.forEach(function(orgId) {\n            var allChildrenHidden = true;\n            $(\"#fillOrgs .org-container[data-parent-id='\" + orgId + \"']\").each(function() {\n                var subOrgs = $(this).find(\".org-container\");\n                if (subOrgs.length > 0) {\n                    var allSubOrgsHidden = true;\n                    subOrgs.each(function() {\n                        var isVisible = false;\n                        $(this).find(\"input[name='organization']\").each(function() {\n                            if ($(this).is(\":visible\") || String($(this).css(\"display\")) !== \"none\") {\n                                isVisible = true;\n                                allChildrenHidden = false;\n                            }\n                        });\n                        if (!isVisible) {\n                            $(this).hide();\n                        } else {\n                            allSubOrgsHidden = false;\n                        }\n                    });\n                    if (allSubOrgsHidden) {\n                        $(this).children(\"label\").hide();\n                    }\n                } else {\n                    var ip = $(this).find(\"input[name='organization']\");\n                    if (ip.length > 0) {\n                        ip.each(function() {\n                            if ($(this).is(\":visible\") || String($(this).css(\"display\")) !== \"none\") {\n                                allChildrenHidden = false;\n                            }\n                        });\n                    }\n                }\n            });\n            if (allChildrenHidden) {\n                $(\"#fillOrgs\").find(\"legend[orgid='\" + orgId + \"']\").hide();\n            }\n        });\n    };\n    OrgTool.prototype.findOrg = function(entry, orgId){\n        var org;\n        if (!entry || !orgId) {\n            return false;\n        }\n        entry.forEach(function(item) {\n            if (!org) {\n                if (parseInt(item.id) === parseInt(orgId)) {\n                    org = item;\n                }\n            }\n        });\n        return org;\n    };\n    OrgTool.prototype.getOrgName = function(orgId){\n        var org = this.orgsList[orgId];\n        if (!org) {\n            return \"\";\n        }\n        return org.name;\n    };\n    OrgTool.prototype.populateOrgsList = function(items) {\n        if (Object.keys(this.orgsList).length > 0) {\n            return this.orgsList;\n        }\n        var entry = items, self = this, parentId, orgsList = {};\n        if (!items) { return false; }\n        items.forEach(function(item) {\n            if (item.partOf) {\n                parentId = item.partOf.reference.split(\"/\").pop();\n                if (!orgsList[parentId]) {\n                    var o = self.findOrg(entry, parentId);\n                    orgsList[parentId] = new OrgObj(o.id, o.name);\n                }\n                orgsList[parentId].children.push(new OrgObj(item.id, item.name, parentId));\n                if (orgsList[item.id]) {\n                    orgsList[item.id].parentOrgId = parentId;\n                }\n                else {\n                    orgsList[item.id] = new OrgObj(item.id, item.name, parentId);\n                }\n            } else {\n                if (!orgsList[item.id]) {\n                    orgsList[item.id] = new OrgObj(item.id, item.name);\n                }\n                if (parseInt(item.id) !== 0) {\n                    orgsList[item.id].isTopLevel = true;\n                    self.TOP_LEVEL_ORGS.push(item.id);\n                }\n            }\n            if (item.extension) {\n                orgsList[item.id].extension = item.extension;\n            }\n            if (item.language) {\n                orgsList[item.id].language = item.language;\n            }\n            if (item.identifier) {\n                orgsList[item.id].identifier = item.identifier;\n                (item.identifier).forEach(function(identifier) {\n                    if (identifier.system === SYSTEM_IDENTIFIER_ENUM.shortname) {\n                        orgsList[item.id].shortname = identifier.value;\n                    }\n                });\n            }\n\n        });\n        items.forEach(function(item) {\n            if (item.partOf) {\n                parentId = item.partOf.reference.split(\"/\").pop();\n                if (orgsList[item.id]) {\n                    orgsList[item.id].parentOrgId = parentId;\n                }\n            }\n        });\n        if (items.length > 0) { this.initialized = true; }\n        this.orgsList = orgsList;\n        return orgsList;\n    };\n    OrgTool.prototype.getShortName = function(orgId) {\n        var shortName = \"\";\n        if (!orgId) { return shortName; }\n        var orgsList = this.getOrgsList();\n        var orgItem = orgsList.hasOwnProperty(orgId) ? orgsList[orgId]: {};\n        if (orgItem.shortname) {\n            shortName = orgItem.shortname;\n        }\n        return shortName;\n    };\n    OrgTool.prototype.populateUI = function(){\n        if (sessionStorage.orgsHTML) {\n            $(\"#fillOrgs\").html(sessionStorage.orgsHTML);\n            return true;\n        }\n        var self = this, container = $(\"#fillOrgs\"), orgsList = this.orgsList, parentContent = \"\";\n        var getState = (item) => {\n            if (!item.identifier) {\n                return \"\";\n            }\n            var s = \"\", found = false;\n            (item.identifier).forEach(function(i) {\n                if (!found && (i.system === SYSTEM_IDENTIFIER_ENUM.practice_region && i.value)) {\n                    s = (i.value).split(\":\")[1];\n                    found = true;\n                }\n            });\n            return s;\n        };\n        var keys = Object.keys(orgsList), parentOrgsArray = [];\n        keys = keys.sort();\n        keys.forEach(function(org) { //draw parent orgs first\n            if (orgsList[org].isTopLevel) {\n                parentOrgsArray.push(org);\n            }\n        });\n        parentOrgsArray = parentOrgsArray.sort(function(a, b) { //sort parent orgs by name\n            var orgA = orgsList[a], orgB = orgsList[b];\n            if (orgA.name < orgB.name) { return -1; }\n            if (orgA.name > orgB.name) { return 1; }\n            return 0;\n        });\n        var parentFragment = document.createDocumentFragment(), parentDiv;\n        parentOrgsArray.forEach(function(org) {\n            parentDiv = document.createElement(\"div\");\n            parentDiv.setAttribute(\"id\", org+\"_container\");\n            let parentOrgItem = orgsList[org];\n            let orgShortName = parentOrgItem.shortname || parentOrgItem.name;\n            let parentState = getState(parentOrgItem);\n            let parentOrgName = parentOrgItem.name;\n            if (parentOrgItem.children.length) {\n                if ($(\"#userOrgs legend[orgId='\" + org + \"']\").length === 0) {\n                    parentDiv.classList.add(\"parent-org-container\");\n                    parentContent = `<legend orgId=\"${org}\">${parentOrgName}</legend>\n                        <input class=\"tnth-hide\" type=\"checkbox\" name=\"organization\" parent_org=\"true\" data-org-name=\"${parentOrgName}\" data-short-name=\"${orgShortName}\" id=\"${org}_org\" state=\"${parentState}\" value=\"${org}\" /></div>`;\n                }\n            } else {\n                if ($(\"#userOrgs label[id='org-label-\" + org + \"']\").length === 0) {\n                    parentDiv.classList.add(\"parent-org-container\", \"parent-singleton\");\n                    parentContent = `<label id=\"org-label-${org}\" class=\"org-label\">\n                        <input class=\"clinic\" type=\"checkbox\" name=\"organization\" parent_org=\"true\" id=\"${org}_org\" state=\"${parentState}\" value=\"${org}\"\n                        data-parent-id=\"${org}\"  data-org-name=\"${parentOrgName}\" data-short-name=\"${orgShortName}\" data-parent-name=\"${parentOrgName}\"/><span>${parentOrgName}</span></label></div>`;\n                }\n            }\n            parentDiv.innerHTML = parentContent;\n            parentFragment.appendChild(parentDiv);\n        });\n        container.get(0).appendChild(parentFragment);\n        keys.forEach(function(org) { //draw child orgs\n            if (orgsList[org].children.length > 0) { // Fill in each child clinic\n                var childClinic = \"\";\n                var items = orgsList[org].children.sort(function(a, b) { // sort child clinic in alphabetical order\n                    if (a.name < b.name) { return -1; }\n                    if (a.name > b.name) { return 1; }\n                    return 0;\n                });\n                items.forEach(function(item) {\n                    var _parentOrgId = item.parentOrgId, _parentOrg = orgsList[_parentOrgId];\n                    var _isTopLevel = _parentOrg ? _parentOrg.isTopLevel : false;\n                    var state = getState(orgsList[_parentOrgId]);\n                    var topLevelOrgId = self.getTopLevelParentOrg(item.id);\n\n                    if ($(\"#fillOrgs input[name='organization'][value='\" + item.id + \"']\").length > 0) {\n                        return true;\n                    }\n                    var attrObj = {dataAttributes:(' data-parent-id=\"' + topLevelOrgId + '\"  data-parent-name=\"' + orgsList[topLevelOrgId].name + '\" '), containerClass: \"\", textClass: \"\"};\n                    if (_isTopLevel) {\n                        attrObj.dataAttributes = (' data-parent-id=\"' + _parentOrgId + '\"  data-parent-name=\"' + _parentOrg.name + '\" ');\n                    }\n                    if (orgsList[item.id].children.length > 0) {\n                        if (_isTopLevel) {\n                            attrObj.containerClass = \"sub-org-container\";\n                            attrObj.textClass = \"text-muted\";\n                        } else {\n                            attrObj.textClass = \"text-muter\";\n                        }\n                    } else {\n                        if (_isTopLevel) {\n                            attrObj.textClass = \"text-muted singleton\";\n                        }\n                    }\n                    childClinic = `<div id=\"${item.id}_container\" ${attrObj.dataAttributes} class=\"indent org-container ${attrObj.containerClass}\">\n                        <label id=\"org-label-${item.id}\" class=\"org-label ${attrObj.textClass}\">\n                        <input class=\"clinic\" type=\"checkbox\" name=\"organization\" id=\"${item.id}_org\" data-org-name=\"${item.name}\" data-short-name=\"${item.shortname || item.name}\" state=\"${state ? state : ''}\" value=\"${item.id}\" ${attrObj.dataAttributes} />\n                        <span>${item.name}</span></label></div>`;\n                    var parentOrgContainer = $(\"#\" + _parentOrgId + \"_container\");\n                    if (parentOrgContainer.length > 0) {\n                        parentOrgContainer.append(childClinic);\n                    } else {\n                        container.append(childClinic);\n                    }\n                });\n            }\n        });\n        sessionStorage.setItem(\"orgsHTML\", container.html());\n        if (!container.text()) {\n            container.html(i18next.t(\"No organizations available\"));\n        }\n    };\n    OrgTool.prototype.getSelectedOrgTopLevelParentOrg = function(){\n        return this.getTopLevelParentOrg(this.getSelectedOrg().val());\n    };\n    OrgTool.prototype.getSelectedOrg = function() {\n        return $(\"#userOrgs input[name='organization']:checked\");\n    };\n    OrgTool.prototype.getUserTopLevelParentOrgs = function(uo) {\n        var parentList = [], self = this;\n        if (!uo) {\n            return false;\n        }\n        if (uo.parentList) { return uo.parentList; }\n        uo.forEach(function(o) {\n            var p = self.getTopLevelParentOrg(o);\n            if (p && !self.inArray(p, parentList)) {\n                parentList.push(p);\n            }\n        });\n        uo.parentList = parentList;\n        return parentList;\n    };\n    OrgTool.prototype.getTopLevelParentOrg = function(currentOrg) {\n        var ml = this.getOrgsList(), currentOrgItem = ml[currentOrg], self = this;\n        if (!currentOrgItem) { return false; }\n        if (currentOrgItem.isTopLevel) {\n            return currentOrg;\n        }\n        if (currentOrgItem.parentOrgId) {\n            return self.getTopLevelParentOrg(currentOrgItem.parentOrgId);\n        }\n        return currentOrg;\n    };\n    OrgTool.prototype.getChildOrgs = function(orgs, orgList) {\n        orgList = orgList || [];\n        if (!orgs || !orgs.length) {\n            return orgList;\n        }\n        var mainOrgsList = this.getOrgsList(), childOrgs = [];\n        orgs.forEach(function(org) {\n            var o = mainOrgsList[org.id];\n            if (!o) {\n                return true;\n            }\n            orgList.push(org.id);\n            var c = o.children ? o.children : null;\n            if (c && c.length) {\n                c.forEach(function(i) {\n                    childOrgs.push(i);\n                });\n            }\n        });\n        return this.getChildOrgs(childOrgs, orgList);\n    };\n    OrgTool.prototype.getHereBelowOrgs = function(userOrgs) {\n        var mainOrgsList = this.getOrgsList(), self = this, here_below_orgs = [];\n        if (!userOrgs) {\n            var selectedOrg = this.getSelectedOrg();\n            if (selectedOrg.length > 0) {\n                userOrgs = [];\n                selectedOrg.each(function() {\n                    userOrgs.push($(this).val());\n                });\n            }\n        }\n        userOrgs = userOrgs || [];\n        userOrgs.forEach(function(orgId) {\n            here_below_orgs.push(orgId);\n            var co = mainOrgsList[orgId], cOrgs = self.getChildOrgs((co && co.children ? co.children : []));\n            if (cOrgs.length) {\n                here_below_orgs = here_below_orgs.concat(cOrgs);\n            }\n        });\n        return here_below_orgs;\n    };\n    OrgTool.prototype.morphPatientOrgs = function() {\n        var checkedOrgs = {}, orgs = $(\"#userOrgs input[name='organization']\");\n        orgs.each(function() {\n            $(this).closest(\"label\").addClass(\"radio-label\");\n            if ($(this).prop(\"checked\")) {\n                checkedOrgs[$(this).val()] = true;\n            }\n            $(this).attr(\"type\", \"radio\");\n            if (checkedOrgs[$(this).val()]) {\n                $(this).prop(\"checked\", true);\n            }\n        });\n        $(\"#userOrgs .noOrg-container\").hide();\n    };\n    return OrgTool;\n})();\n","import tnthAjax from \"./TnthAjax.js\";\nimport tnthDates from \"./TnthDate.js\";\nimport Utility from \"./Utility.js\";\nimport SYSTEM_IDENTIFIER_ENUM from \"./SYSTEM_IDENTIFIER_ENUM.js\";\nexport default (function() {\n    /*global $ i18next tnthAjax tnthDates SYSTEM_IDENTIFIER_ENUM */\n    var ProcApp = {\n        subjectId: \"\",\n        currentUserId: \"\",\n        dateFields: [\"procDay\", \"procMonth\", \"procYear\"],\n        entries: [],\n        initCounts: 0,\n        init: function(subjectId) { //entry method for initializing ProcApp object\n            var self = this;\n            this.initUserIds(subjectId, function() {\n                if (!self.subjectId) {\n                    self.setError(i18next.t(\"Subject id is required\")); //display error on UI\n                    return false;\n                }\n                self.getOptions(); //treatment options\n                self.getUserProcedures();\n                self.initFieldExtension();\n                self.initFieldEvents();\n            });\n        },\n        initViaTemplate: function() { //profile and coredata views\n            var self = this;\n            $(document).ready(function() {\n                var profileSubject = $(\"#profileProcSubjectId\");\n                if (!profileSubject.length) {\n                    return;\n                }\n                self.init(profileSubject.val());\n            });\n        },\n        initUserIds: function(subjectId, callback) {\n            callback = callback || function() {};\n            var self = this;\n            this.setSubjectId(subjectId);\n            tnthAjax.getCurrentUser(function(data) {\n                if (!data || data.error) {\n                    self.setError(i18next.t(\"error occurred setting current user id\"));\n                    callback();\n                    return;\n                }\n                self.setCurrentUserId(data.id);\n                if (!self.subjectId) {\n                    self.setSubjectId(data.id);\n                }\n                callback();\n            });\n        },\n        setSubjectId: function(id) {\n            this.subjectId = id;\n        },\n        setCurrentUserId: function(id) {\n            this.currentUserId = id;\n        },\n        setError: function(message) {\n            $(\"#procDateErrorContainer\").html(message||\"\");\n            if (message) {\n                $(\"#procedure_view\").html(\"<p class='text-muted'>\" + i18next.t(\"no data found\") + \"</p>\");\n            }\n        },\n        setTreatmentOptionsSelector: function(entries) {\n            if (!entries) {\n                return;\n            }\n            var optionsList = [];\n            optionsList.push(\"<option value=''>\" + i18next.t(\"Select\") + \"</option>\");\n            entries.forEach(function(item) {\n                optionsList.push(\"<option value='{value}' data-system='{system}'>{text}</option>\"\n                    .replace(\"{value}\", item.code)\n                    .replace(\"{text}\", item.text)\n                    .replace(\"{system}\", item.system));\n            });\n            $(\"#tnthproc\").append(optionsList.join(\"\"));\n            sessionStorage.setItem(\"treatmentOptions\", JSON.stringify(entries));\n        },\n        getOptions: function() {\n            if (!$(\"#tnthproc\").length) {\n                return;\n            }\n            if (sessionStorage.treatmentOptions) {\n                this.setTreatmentOptionsSelector(JSON.parse(sessionStorage.treatmentOptions));\n                return;\n            }\n            var self = this, url =  \"/patients/treatment-options\";\n            if (window.Worker) {\n                Utility.initWorker(url, {cache: true}, function(result) { /*global Utility */\n                    var data = JSON.parse(result);\n                    self.setTreatmentOptionsSelector(data.treatment_options);\n                });\n                return true;\n            }\n            $.ajax({\n                type: \"GET\",\n                url: url,\n                cache: true\n            }).done(function(data) {\n                self.setTreatmentOptionsSelector(data.treatment_options);\n            }).fail(function() {});\n        },\n        getCreatorDisplay: function(creator, defaultDisplay) {\n            if (!creator) {\n                return \"\";\n            }\n            if (String(creator) === this.currentUserId) {\n                return i18next.t(\"you\");\n            } else if (String(creator) === String(this.subjectId)) {\n                return i18next.t(\"this patient\");\n            }\n            return i18next.t(\"staff member\") + \", <span class='creator'>\" + defaultDisplay + \"</span>, \";\n        },\n        getDeleteInvocationDisplay: function() {\n            return $(\"#popoverHolder .popover__link\").html();\n        },\n        setNewEntry: function(newEntry, highestId){\n            if (!newEntry) {\n                return;\n            }\n            // If newEntry, then add icon to what we just added\n            $(\"#eventListtnthproc\").find(\"tr[data-id='\" + highestId + \"'] td.descriptionCell\").append(\"&nbsp; <small class='text-success'><i class='fa fa-check-square-o'></i> <em>\" + i18next.t(\"Added!\") + \"</em></small>\");\n        },\n        setProcedureRowsView: function() {\n            var content = \"\";\n            $(\"#userProcedures tr[data-id]\").each(function() {\n                $(this).find(\"td\").each(function() {\n                    if (!$(this).hasClass(\"list-cell\") && !$(this).hasClass(\"lastCell\")) {\n                        content += \"<div>\" + $(this).text() + \"</div>\"; //display content from database\n                    }\n                });\n            });\n            $(\"#procedure_view\").html(content || (\"<p class='text-muted'>\" + i18next.t(\"no data found\") + \"</p>\"));\n        },\n        setNoDataDisplay: function() {\n            $(\"#userProcedures\").html(\"<p id='noEvents'><em>\" + i18next.t(\"You haven't entered any management option yet.\") + \"</em></p>\").animate({\n                opacity: 1\n            });\n            $(\"#procedure_view\").html(\"<p class='text-muted'>\" + i18next.t(\"no data found\") + \"</p>\");\n            $(\"#pastTreatmentsContainer\").hide();\n            $(\"#eventListLoad\").fadeOut();\n        },\n        getUserProcedures: function(newEntry) {\n            if (!this.subjectId) {\n                return false;\n            }\n            var self = this;\n            $.ajax({\n                type: \"GET\",\n                url: \"/api/patient/\" + this.subjectId + \"/procedure\",\n                cache: false\n            }).done(function(data) {\n                if (data.entry.length === 0) {\n                    self.setNoDataDisplay();\n                    return false;\n                }\n                self.onDidGetProcedures(data.entry, newEntry);\n                $(\"#eventListLoad\").fadeOut();\n            }).fail(function() {\n                self.setError(i18next.t(\"error occurred retrieving user procedures\"));\n                $(\"#eventListLoad\").fadeOut();\n            });\n        },\n        initFieldEvents: function() {\n            var self = this;\n\n            this.convertToNumericField($(\"#procYear, #procDay\"));\n\n            setTimeout(function() {// Trigger eventInput on submit button\n                $(\"#tnthproc-submit\").eventInput();\n            }, 150);\n\n            $(\"#tnthproc\").on(\"change\", function() { // Update submit button when select changes\n                $(\"#tnthproc-submit\").attr({\"data-name\": $(this).val(), \"data-system\": $(this).find(\"option:selected\").attr(\"data-system\")});\n                self.checkSubmit(\"#tnthproc-submit\");\n            });\n\n            self.dateFields.forEach(function(fn) {\n                $(\"#\" + fn).on(\"keyup change\", function() {\n                    self.setDate();\n                });\n            });\n\n            $(\"body\").on(\"click\", \".data-delete\", function() { //new row remove button event at account creation\n                $(this).closest(\"tr\").remove();\n            });\n        },\n        initPopoverEvents: function() {\n            var self = this;\n            $(\"[data-toggle='popover']\").popover({trigger: \"click\", placement: \"top\", html: true, content: $(\"#popoverHolder .popover__content\").html()});\n            $(\"body\").on(\"click\", \".cancel-delete\", function() { //popover cancel button event\n                $(this).parents(\"div.popover\").prev(\"a.confirm-delete\").trigger(\"click\");\n            });\n\n            $(\"body\").on(\"click\", \".btn-delete\", function() { // popover delete button event - need to attach delete functionality to body b/c section gets reloaded\n                var procId = $(this).parents(\"tr\").attr(\"data-id\");\n                $(this).parents(\"tr\").fadeOut(\"slow\", function() {\n                    $(this).remove(); // Remove from list\n                    if ($(\"#eventListtnthproc tr\").length === 0) { //If there's no events left, add status msg back in\n                        self.setNoDataDisplay();\n                    }\n                });\n                tnthAjax.deleteProc(procId, false, false, function() { // Post delete to server\n                    self.getUserProcedures();\n                });\n                return false;\n            });\n        },\n        onDidGetProcedures: function(data, newEntry) {\n            this.populateProcedureRows(data, newEntry);\n            this.setProcedureRowsView();\n            this.setError(!data||data.error?i18next(\"Error occurred retrieving procedures\"): \"\");\n        },\n        populateProcedureRows: function(data, newEntry) {\n            data.sort(function(a, b) { // sort from newest to oldest\n                return new Date(b.resource.performedDateTime) - new Date(a.resource.performedDateTime);\n            });\n            var self = this, contentHTML = [], proceduresHtml = \"\", otherHtml = [];\n            // If we're adding a procedure in-page, then identify the highestId (most recent) so we can put \"added\" icon\n            var highestId = 0;\n            $.each(data, function(i, val) {\n                var code = val.resource.code.coding[0].code;\n                var procID = val.resource.id;\n                if ([SYSTEM_IDENTIFIER_ENUM.CANCER_TREATMENT_CODE, SYSTEM_IDENTIFIER_ENUM.NONE_TREATMENT_CODE].indexOf(code) !== -1) {\n                    //for entries marked as other procedure.  These are rendered as hidden fields and can be referenced when these entries are deleted.\n                    otherHtml.push(\"<input type='hidden' data-id='\" + procID + \"'  data-code='\" + code + \"' name='otherProcedures' >\");\n                    return true;\n                }\n                var creatorRef = (val.resource.meta.by.reference).match(/\\d+/)[0];  // just the user ID, not eg \"api/patient/46\";\n                var creator = self.getCreatorDisplay(creatorRef, val.resource.meta.by.display || creatorRef);\n                var dateEdited = new Date(val.resource.meta.lastUpdated);\n                var creationText = i18next.t(\"(data entered by %actor on %date)\").replace(\"%actor\", creator).replace(\"%date\", dateEdited.toLocaleDateString(\"en-GB\", {\n                    day: \"numeric\",\n                    month: \"short\",\n                    year: \"numeric\"\n                }));\n                var deleteInvocation = \"\";\n                if (String(creatorRef) === String(self.currentUserId)) {\n                    deleteInvocation = self.getDeleteInvocationDisplay();\n                }\n                contentHTML.push([\"<tr data-id='\" + procID + \"' data-code='\" + code + \"'>\",\n                    \"<td width='1%' valign='top' class='list-cell'>&#9679;</td>\",\n                    \"<td class='col-md-10 col-xs-10 descriptionCell' valign='top'>\" +\n                    (tnthDates.formatDateString(val.resource.performedDateTime)) + \"&nbsp;--&nbsp;\" + val.resource.code.coding[0].display +\n                    \"&nbsp;<em>\" + creationText +\n                    \"</em></td>\",\n                    \"<td class='col-md-2 col-xs-2 lastCell text-left' valign='top'>\" +\n                    deleteInvocation + \"</td>\",\n                    \"</tr>\"].join(\"\"));\n                highestId = Math.max(highestId, procID);\n            });\n            if (contentHTML) {\n                proceduresHtml = \"<table  class=\\\"table-responsive\\\" width=\\\"100%\\\" id=\\\"eventListtnthproc\\\" cellspacing=\\\"4\\\" cellpadding=\\\"6\\\">\";\n                proceduresHtml += contentHTML.join(\"\");\n                proceduresHtml += \"</table>\";\n                $(\"#userProcedures\").html(proceduresHtml);\n            }\n            this.setNewEntry(newEntry, highestId);\n            this.initPopoverEvents();\n\n            if ($(\"#eventListtnthproc tr\").length) {\n                $(\"#pastTreatmentsContainer\").fadeIn();\n            } else {\n                $(\"#pastTreatmentsContainer\").fadeOut();\n            }\n\n            $(\"#userProcedures\").append(otherHtml.join(\"\")); //other procedures\n        },\n        handleOtherProcedures: function() {\n            var otherProcElements = $(\"#userProcedures input[name='otherProcedures']\");\n            if (!otherProcElements.length) {\n                return false;\n            }\n            otherProcElements.each(function() {\n                var code = $(this).attr(\"data-code\"), procId = $(this).attr(\"data-id\");\n                if ([SYSTEM_IDENTIFIER_ENUM.CANCER_TREATMENT_CODE, SYSTEM_IDENTIFIER_ENUM.NONE_TREATMENT_CODE].indexOf(code) !== -1) { //remove any procedure on prostate or none treatment\n                    tnthAjax.deleteProc(procId);\n                }\n            });\n        },\n        setAccountCreationRowDisplay: function(procArray) {\n            procArray = procArray || {};\n            if ($(\"#pastTreatmentsContainer tr[data-code='\" + procArray[\"code\"] + \"'][data-performedDateTime='\" + procArray[\"performedDateTime\"] + \"']\").length === 0) {\n                var content = [];\n                content.push(\"<tr \");\n                var arrProcAttrs = [];\n                for (var item in procArray) { /*eslint guard-for-in: off, security/detect-object-injection: off */\n                    arrProcAttrs.push(\"data-\" + item + \"='\" + procArray[item] + \"'\");\n                }\n                content.push(arrProcAttrs.join(\" \"));\n                content.push(\">\");\n                content.push(\"<td>&#9679;</td><td>\" + procArray[\"display\"] + \"</td><td>\" + procArray[\"performedDateTime\"] + \"</td><td><a class='btn btn-default btn-xs data-delete'>\" + i18next.t(\"REMOVE\") + \"</a></td>\");\n                content.push(\"</tr>\");\n                $(\"#pastTreatmentsContainer\").append(content.join(\"\"));\n                setTimeout(function() {\n                    $(\"#pastTreatmentsContainer\").show();\n                }, 100);\n            }\n        },\n        initFieldExtension: function() {\n            var self = this;\n            $.fn.extend({\n                // Special type of select question - passes two values - the answer from - the select plus an associated date from a separate input\n                eventInput: function() {\n                    $(this).on(\"click\", function(e) {\n                        e.stopImmediatePropagation();\n                        $(this).attr(\"disabled\", true); // First disable button to prevent double-clicks\n                        var isAccountCreation = $(this).attr(\"data-account-create\");\n                        var subjectId = self.subjectId, selectVal = $(this).attr(\"data-name\"), selectDate = $(this).attr(\"data-date\"), selectSystem = $(this).attr(\"data-system\");\n                        if (!selectVal || !selectDate) {\n                            return false;\n                        }\n                        var selectFriendly = $(\"#tnthproc option:selected\").text();\n                        var procArray = {resourceType: \"Procedure\", performedDateTime: selectDate, system: selectSystem};\n                        /* eslint detect-object-injection: off*/\n                        if (isAccountCreation) {\n                            procArray[\"display\"] = selectFriendly;\n                            procArray[\"code\"] = selectVal;\n                            self.setAccountCreationRowDisplay(procArray);\n                        } else {\n                            self.handleOtherProcedures();\n                            var procID = [{\"code\": selectVal, \"display\": selectFriendly, system: selectSystem}];\n                            procArray[\"subject\"] = {\"reference\": \"Patient/\" + subjectId};\n                            procArray[\"code\"] = { \"coding\": procID};\n                            tnthAjax.postProc(subjectId, procArray);\n                            $(\"#eventListLoad\").show();\n                            setTimeout(function() { // Set a delay before getting updated list. Mostly to give user sense of progress/make it more obvious when the updated list loads\n                                self.getUserProcedures(true);\n                            }, 1800);\n                            $(\"#pastTreatmentsContainer\").hide();\n                        }\n                        self.reset();\n                        return false;\n                    });\n                }\n            }); // $.fn.extend({\n        },\n        reset: function() {\n            $(\"#tnthproc\").val(\"\"); //treatment select element\n            $(\"#procDay, #procMonth, #procYear\").val(\"\"); //date fields\n            $(\"#tnthproc-submit\").addClass(\"disabled\").attr({\"data-name\": \"\", \"data-date\": \"\", \"data-date-read\": \"\", \"data-system\": \"\"}); // Clear submit button\n        },\n        checkSubmit: function(btnId) { // Add/remove disabled from submit button\n            if (String($(btnId).attr(\"data-name\")) !== \"\" && String($(btnId).attr(\"data-date-read\")) !== \"\") {\n                $(btnId).removeClass(\"disabled\").removeAttr(\"disabled\");\n            } else {\n                $(btnId).addClass(\"disabled\").attr(\"disabled\", true);\n            }\n        },\n        convertToNumericField: function(field) {\n            if (\"ontouchstart\" in window || (typeof window.DocumentTouch !== \"undefined\" && document instanceof window.DocumentTouch)) {\n                $(field).each(function() {\n                    $(this).prop(\"type\", \"tel\");\n                });\n            }\n        },\n        isTouchScreen: function() {\n            return (\"ontouchstart\" in window || window.DocumentTouch && document instanceof window.DocumentTouch);\n        },\n        checkDate: function() {\n            var df = $(\"#procDay\"), mf =  $(\"#procMonth\"), yf = $(\"#procYear\");\n            var d = df.val(), y = yf.val();\n            var deField = $(\"#procDateErrorContainer\"), errorClass=\"error-message\";\n            if (!d || !/(19|20)\\d{2}/.test(y)) {\n                return false;\n            }\n            if (!tnthDates.validateDateInputFields(mf, df, yf, \"procDateErrorContainer\")) {\n                deField.text(i18next.t(\"The procedure date must be valid and in required format.\")).addClass(errorClass);\n                return false;\n            }\n            deField.text(\"\").removeClass(errorClass);\n            return true;\n        },\n        setDate: function() {\n            var isValid = this.checkDate();\n            if (isValid) {\n                var passedDate = this.dateFields.map(function(fn) {\n                    return $(\"#\" + fn).val();\n                }).join(\"/\");\n                $(\"#tnthproc-submit\").attr(\"data-date-read\", passedDate);\n                $(\"#tnthproc-submit\").attr(\"data-date\", tnthDates.swap_mm_dd(passedDate));\n            } else {\n                $(\"#tnthproc-submit\").attr({\"data-date-read\": \"\", \"data-date\": \"\"});\n            }\n            this.checkSubmit(\"#tnthproc-submit\");\n        }\n    };\n    return ProcApp;\n})(); /*eslint wrap-iife: off */\n","import tnthAjax from \"./modules/TnthAjax.js\";\nimport tnthDates from \"./modules/TnthDate.js\";\nimport OrgTool from \"./modules/OrgTool.js\";\nimport SYSTEM_IDENTIFIER_ENUM from \"./modules/SYSTEM_IDENTIFIER_ENUM.js\";\nimport ProcApp from \"./modules/Procedures.js\";\nimport Utility from \"./modules/Utility.js\";\n\n/*\n * helper Object for initializing profile sections  TODO streamline this more\n */\n(function() {\n    var ProfileObj = window.ProfileObj = new Vue({ /*global Vue i18next $ */\n        el: \"#mainDiv\",\n        components: {\n            \"section-view\": {\n                props: [\"data\", \"nodatatext\"],\n                template: \"<div v-if='data'>{{data}}</div><div class='text-muted' v-else>{{nodatatext}}</div>\"\n            },\n            \"section-view-extension\": {\n                props: [\"data\", \"nodatatext\"],\n                template: \"<div v-if='data'><p v-for='item in data'>{{item.display}}</p></div><div class='text-muted' v-else>{{nodatatext}}</div>\"\n            },\n            \"email-ready-message\": {\n                props: ['message'],\n                template: \"<div class='text-warning email-ready-message' v-show='message'><span class='glyphicon glyphicon-alert warning' aria-hidden='true'></span>{{message}}</div>\"\n            }\n        },\n        errorCaptured: function(Error, Component, info) {\n            console.error(\"Error: \", Error, \" Component: \", Component, \" Message: \", info);\n            return false;\n        },\n        errorHandler: function (err, vm) {\n            this.dataError = true;\n            var errorElement = document.getElementById(\"profileErrorMessage\");\n            if (errorElement) {\n                errorElement.innerHTML = \"Error occurred initializing Profile  Vue instance.\";\n            }\n            console.warn(\"Profile Vue instance threw an error: \", vm, this);\n            console.error(\"Error thrown: \", err);\n        },\n        created: function() {\n            var self = this;\n            Utility.VueErrorHandling(); /*global Utility VueErrorHandling */\n            this.registerDependencies();\n            this.getOrgTool();\n            this.setUserSettings();\n            this.onBeforeSectionsLoad();\n            this.setCurrentUserOrgs();\n            this.initStartTime = new Date();\n            this.initChecks.push({done: false});\n            this.setDemoData({beforeSend: self.setSectionLoaders}, function() { //this will initialize section loaders, only if ajax request is sent\n                self.onInitChecksDone();\n            });\n            if (this.currentUserId) { //get user roles - note using the current user Id - so we can determine: if user is an admin, if he/she can edit the consent, etc.\n                this.initChecks.push({done: false});\n                this.modules.tnthAjax.getRoles(this.currentUserId, function(data) {\n                    if (data && data.roles) {\n                        data.roles.forEach(function(role) {self.currentUserRoles.push(role.name.toLowerCase());});\n                    }\n                    self.onInitChecksDone();\n                }, {useWorker: true});\n            }\n            this.initChecks.push({ done: false});\n            this.setConfiguration({useWorker:true}, function(data) { //get config settings\n                self.onInitChecksDone();\n                var CONSENT_WITH_TOP_LEVEL_ORG = \"CONSENT_WITH_TOP_LEVEL_ORG\";\n                if (data.error || !data.hasOwnProperty(CONSENT_WITH_TOP_LEVEL_ORG)) {\n                    return false;\n                }\n            });\n        },\n       mounted: function() {\n            var self = this;\n            Vue.nextTick(function () {\n                // DOM updated\n                self.initIntervalId = setInterval(function() { //wait for ajax calls to finish\n                    self.initEndTime = new Date();\n                    var elapsedTime = self.initEndTime - self.initStartTime;\n                    elapsedTime /= 1000;\n                    var checkFinished = self.initChecks.length === 0;\n                    if (checkFinished || (elapsedTime >= 5)) {\n                        clearInterval(self.initIntervalId);\n                        self.initSections(function() {\n                            self.onSectionsDidLoad();\n                            self.handleOptionalCoreData();});\n                    }\n                }, 30);\n            });\n        },\n        data: {\n            subjectId: \"\",\n            currentUserId: \"\",\n            settings: {},\n            orgTool: null,\n            orgsList: {},\n            orgsData: [],\n            initChecks: [],\n            initIntervalId: 0,\n            currentUserRoles: [],\n            userOrgs: [],\n            userRoles: [],\n            userEmailReady: true,\n            messages: {\n                userEmailReadyMessage: \"\",\n                userInviteEmailInfoMessage: \"\",\n                userInviteEmailErrorMessage: \"\",\n            },\n            mode: \"profile\",\n            demo: { //skeleton\n                data: { resourceType:\"Patient\", email: \"\", name: {given: \"\",family: \"\"}, birthDay: \"\",birthMonth: \"\",birthYear: \"\"}\n            },\n            stateDict: {AL: i18next.t(\"Alabama\"),AK: i18next.t(\"Alaska\"), AS: i18next.t(\"American Samoa\"),AZ: i18next.t(\"Arizona\"),AR:i18next.t(\"Arkansas\"),CA: i18next.t(\"California\"),CO:i18next.t(\"Colorado\"),CT:i18next.t(\"Connecticut\"),DE:i18next.t(\"Delaware\"),DC:i18next.t(\"District Of Columbia\"),FM: i18next.t(\"Federated States Of Micronesia\"),FL:i18next.t(\"Florida\"),GA:i18next.t(\"Georgia\"),GU:i18next.t(\"Guam\"),HI:i18next.t(\"Hawaii\"),ID:i18next.t(\"Idaho\"),IL:i18next.t(\"Illinois\"),IN:i18next.t(\"Indiana\"),IA:i18next.t(\"Iowa\"),KS:i18next.t(\"Kansas\"),KY:i18next.t(\"Kentucky\"),LA:i18next.t(\"Louisiana\"),ME:i18next.t(\"Maine\"),MH:i18next.t(\"Marshall Islands\"),MD:i18next.t(\"Maryland\"),MA:i18next.t(\"Massachusetts\"),MI:i18next.t(\"Michigan\"),MN:i18next.t(\"Minnesota\"),MS:i18next.t(\"Mississippi\"),MO:i18next.t(\"Missouri\"),MT:i18next.t(\"Montana\"),NE: i18next.t(\"Nebraska\"),NV:i18next.t(\"Nevada\"),NH:i18next.t(\"New Hampshire\"),NJ:i18next.t(\"New Jersey\"),NM:i18next.t(\"New Mexico\"),NY:i18next.t(\"New York\"),NC:i18next.t(\"North Carolina\"),ND:i18next.t(\"North Dakota\"),MP:i18next.t(\"Northern Mariana Islands\"),OH:i18next.t(\"Ohio\"),OK:i18next.t(\"Oklahoma\"),OR:i18next.t(\"Oregon\"),PW:i18next.t(\"Palau\"),PA:i18next.t(\"Pennsylvania\"),PR:i18next.t(\"Puerto Rico\"),RI:i18next.t(\"Rhode Island\"),SC:i18next.t(\"South Carolina\"),SD:i18next.t(\"South Dakota\"),TN:i18next.t(\"Tennessee\"),TX:i18next.t(\"Texas\"),UT:i18next.t(\"Utah\"),VT:i18next.t(\"Vermont\"),VI:i18next.t(\"Virgin Islands\"),VA:i18next.t(\"Virginia\"),WA:i18next.t(\"Washington\"),WV:i18next.t(\"West Virginia\"),WI:i18next.t(\"Wisconsin\"),WY:i18next.t(\"Wyoming\")},\n            roles: {data: []},\n            CONSENT_ENUM: {\n                \"consented\": {\n                    \"staff_editable\": true,\n                    \"include_in_reports\": true,\n                    \"send_reminders\": true\n                },\n                \"suspended\": {\n                    \"staff_editable\": true,\n                    \"include_in_reports\": true,\n                    \"send_reminders\": false\n                },\n                \"purged\": {\n                    \"staff_editable\": false,\n                    \"include_in_reports\": false,\n                    \"send_reminders\": false\n                }\n            },\n            consent: {\n                consentHeaderArray: [ //html for consent header cell in array\n                    i18next.t(\"Organization\"),\n                    `<span class=\"eproms-consent-status-header\">${i18next.t(\"Consent Status\")}</span><span class=\"truenth-consent-status-header\">${i18next.t(\"Consent Status\")}</span>`,\n                    `<span class=\"agreement\">${i18next.t(\"Agreement\")}</span>`,\n                    `<span class=\"eproms-consent-date-header\">${i18next.t(\"Date\")}</span><span class=\"truenth-consent-date-header\">${i18next.t(\"Registration Date\")}</span> <span class=\"gmt\">(${i18next.t(\"GMT\")})</span>`\n                ],\n                consentHistoryHeaderArray: [\n                    i18next.t(\"Organization\"),\n                    `<span class=\"eproms-consent-status-header\">${i18next.t(\"Consent Status\")}</span><span class=\"truenth-consent-status-header\">${i18next.t(\"Consent Status\")}</span>`,\n                    i18next.t(\"Consent Date\"),\n                    `${i18next.t(\"Last Updated\")}<br/><span class='smaller-text'>${i18next.t(\"( GMT, Y-M-D )\")}</span>`,\n                    i18next.t(\"User\")\n                ],\n                consentLabels: {\n                    \"default\": i18next.t(\"Consented\"),\n                    \"consented\": i18next.t(\"Consented / Enrolled\"),\n                    \"withdrawn\": `<span data-eproms='true'>${i18next.t(\"Withdrawn - Suspend Data Collection and Report Historic Data\")}</span><span data-truenth='true'>${i18next.t(\"Suspend Data Collection and Report Historic Data\")}</span>`,\n                    \"purged\": i18next.t(\"Purged / Removed\"),\n                    \"deleted\": i18next.t(\"Replaced\")\n                },\n                consentItems: [],\n                currentItems: [],\n                historyItems: [],\n                touObj: [],\n                consentDisplayRows: [],\n                consentListErrorMessage: \"\",\n                consentLoading: false,\n                saveLoading: false,\n                showInitialConsentTerms: false\n            },\n            assessment: {\n                assessmentListItems: [], assessmentListError: \"\"\n            },\n            emailLog: {data: []},\n            patientReport: {\n                data: [], hasP3PReport: false\n            },\n            manualEntry: {\n                loading: false,\n                initloading: false,\n                method: \"\",\n                consentDate: \"\",\n                completionDate: \"\",\n                todayObj: { displayDay: \"\", displayMonth: \"\", displayYear: \"\"},\n                errorMessage: \"\"\n            },\n            patientEmailForm: {\n                loading: false\n            },\n            disableFields: [],\n            topLevelOrgs: [],\n            fillViews: {},\n            modules: {},\n            bootstrapTableConfig: {\n                search: true,\n                smartDisplay: true,\n                showToggle: true,\n                showColumns: true,\n                undefinedText: \"--\",\n                pagination: true,\n                pageSize: 5,\n                pageList: [5, 10, 25, 50, 100],\n                formatShowingRows: function(pageFrom, pageTo, totalRows) {\n                    var rowInfo;\n                    rowInfo = i18next.t(\"Showing {pageFrom} to {pageTo} of {totalRows} records\").\n                        replace(\"{pageFrom}\", pageFrom).\n                        replace(\"{pageTo}\", pageTo).\n                        replace(\"{totalRows}\", totalRows);\n                    return rowInfo;\n                },\n                formatAllRows: function() {\n                    return i18next.t(\"All rows\");\n                },\n                formatSearch: function() {\n                    return i18next.t(\"Search\");\n                },\n                formatNoMatches: function() {\n                    return i18next.t(\"No matching records found\");\n                },\n                formatRecordsPerPage: function(pageNumber) {\n                    return i18next.t(\"{pageNumber} records per page\").replace(\"{pageNumber}\", pageNumber);\n                },\n                rowStyle: function(row, index) {\n                    return {\n                        css: {\"background-color\": (index % 2 !== 0 ? \"#F9F9F9\" : \"#FFF\")}\n                    };\n                }\n            }\n        },\n        methods: {\n            registerDependencies: function() {\n                var self = this;\n                if (!window.portalModules) {\n                    window.portalModules = {};\n                }\n                window.portalModules.SYSTEM_IDENTIFIER_ENUM = SYSTEM_IDENTIFIER_ENUM;\n                window.portalModules.tnthAjax = tnthAjax;\n                window.portalModules.tnthDates = tnthDates;\n                window.portalModules.orgTool = OrgTool;\n                if (typeof i18next !== \"undefined\") {\n                    window.portalModules.i18next = i18next;\n                }\n                for (var key in window.portalModules) {\n                    if ({}.hasOwnProperty.call(window.portalModules, key)) {\n                        self.modules[key] = window.portalModules[key];\n                    }\n                }\n            },\n            notProvidedText: function() {\n                return i18next.t(\"not provided\");\n            },\n            setConfiguration: function(params, callback) {\n                var self = this;\n                callback = callback || function() {};\n                this.modules.tnthAjax.getConfiguration(this.currentUserId || this.subjectId, params, function(data) { //get config settings\n                    if (!data || data.error) {\n                        callback({error: self.modules.i18next.t(\"Unable to set user settings.\")});\n                        return false;\n                    }\n                    self.settings = data;\n                    callback(data);\n                });\n            },\n            setBootstrapTableConfig: function(config) {\n                if (!config) {\n                    return this.bootstrapTableConfig;\n                } else {\n                    return $.extend({}, this.bootstrapTableConfig, config);\n                }\n            },\n            onInitChecksDone: function() {\n                if (this.initChecks.length === 0) {\n                    return false;\n                }\n                this.initChecks.pop();\n            },\n            setCurrentUserOrgs: function(params, callback){\n                callback = callback || function() {};\n                if (!this.currentUserId) {\n                    callback({\"error\": \"Current user id is required.\"});\n                    return;\n                }\n                var self = this;\n                this.modules.tnthAjax.getDemo(this.currentUserId, params, function(data) { //setting current user's (not subject's)\n                    if (!data || data.error) {\n                        callback({\"error\": self.modules.i18next.t(\"Unable to set current user orgs\")});\n                        return false;\n                    }\n                    if (!data.careProvider) {\n                        return false;\n                    }\n                    var orgTool = self.getOrgTool();\n                    self.userOrgs = data.careProvider.map(function(item) {\n                        return item.reference.split(\"/\").pop();\n                    });\n                    var topLevelOrgs = orgTool.getUserTopLevelParentOrgs(self.userOrgs);\n                    self.topLevelOrgs = topLevelOrgs.map(function(item) {\n                        return orgTool.getOrgName(item);\n                    });\n                    callback(data);\n                });\n            },\n            isUserEmailReady: function() {\n                return this.userEmailReady;\n            },\n            setUserEmailReady: function(params) {\n                if (this.mode !== \"profile\") { //setting email ready status only applies to profile page\n                    return false;\n                }\n                var self = this;\n                this.modules.tnthAjax.getEmailReady(this.subjectId, params, function(data) {\n                    if (data.error) {\n                        return false;\n                    }\n                    self.userEmailReady = data.ready;\n                    self.messages.userEmailReadyMessage = data.reason || \"\";\n                });\n            },\n            isDisableField: function(fieldId=\"\") {\n                return this.disableFields.indexOf(fieldId) !== -1;\n            },\n            handleMedidataRaveFields: function(params) {\n                if (!this.settings.MEDIDATA_RAVE_FIELDS || !this.settings.MEDIDATA_RAVE_ORG) { //expected config example: MEDIDATA_RAVE_FIELDS = ['deceased', 'studyid', 'consent_status', 'dob', 'org'] and MEDIDATA_RAVE_ORG = 'IRONMAN'\n                    return false;\n                }\n                var self = this;\n                this.setCurrentUserOrgs(params, function() {\n                    if (self.topLevelOrgs.indexOf(self.settings.MEDIDATA_RAVE_ORG) === -1) {\n                        return false;\n                    }\n                    $.merge(self.disableFields, self.settings.MEDIDATA_RAVE_FIELDS);\n                    self.setDisableAccountCreation(); //disable account creation\n                });\n            },\n            setDisableEditButtons: function() {\n                if (this.disableFields.length === 0) {\n                    return false;\n                }\n                var self = this;\n                $(\"#profileMainContent .profile-item-container\").each(function() { //disable field/section that is listed in disable field array\n                    var dataSection = this.getAttribute(\"data-sections\");\n                    if (!dataSection) {\n                        return true;\n                    }\n                    if (self.isDisableField(dataSection)){ //hide edit button for the section\n                        $(this).children(\".profile-item-edit-btn\").css(\"display\", \"none\");\n                    }\n                });\n            },\n            setDisableAccountCreation: function() {\n                if ($(\"#accountCreationContentContainer[data-account='patient']\").length > 0) { //creating an overlay that prevents user from editing fields\n                    $(\"#createProfileForm .create-account-container\").append(\"<div class='overlay'></div>\");\n                }\n            },\n            setDisableFields: function(params) {\n                if (!this.currentUserId || this.isAdmin() || !this.isSubjectPatient()) {\n                    return false;\n                }\n                var self = this;\n                this.setConfiguration(params, function() { //make sure settings are there\n                    self.handleMedidataRaveFields();\n                    self.setDisableEditButtons();\n                });\n            },\n            setDemoData: function(params, callback) {\n                var self = this;\n                callback = callback || function() {};\n                if (!this.subjectId) {\n                    callback();\n                    return false;\n                }\n                this.modules.tnthAjax.clearDemoSessionData(this.subjectId);\n                this.modules.tnthAjax.getDemo(this.subjectId, params, function(data) { //get demo returned cached data if there, but we need fresh data\n                    if (data) {\n                        self.demo.data = data;\n                        setTimeout(function() {\n                            self.setUserEmailReady();\n                        }, 50);\n                        if (data.telecom) {\n                            data.telecom.forEach(function(item) {\n                                if (item.system === \"email\") {\n                                    self.demo.data.email = item.value;\n                                }\n                                if (item.system === \"phone\") {\n                                    if (item.use === \"mobile\") {\n                                        self.demo.data.cellPhone = item.value;\n                                    }\n                                    if (item.use === \"home\") {\n                                        self.demo.data.homePhone = item.value;\n                                    }\n                                }\n                            });\n                        }\n                        if (data.name) {\n                            if (data.name.family && data.name.given) {\n                                self.demo.data.fullName = $.trim(data.name.given + \" \" + data.name.family);\n                            } else if (data.name.family) {\n                                self.demo.data.fullName = data.name.family;\n                            } else if (data.name.given) {\n                                self.demo.data.fullName = data.name.given;\n                            }\n                        } else {\n                            self.demo.data.name = {family: \"\",given: \"\"};\n                        }\n                        var datesArray = data.birthDate ? data.birthDate.split(\"-\") : [\"\", \"\", \"\"];\n                        self.demo.data.displayBirthDate = self.modules.tnthDates.displayDateString(datesArray[1], datesArray[2], datesArray[0]);\n                        self.demo.data.birthDay = datesArray[2];\n                        self.demo.data.birthMonth = datesArray[1];\n                        self.demo.data.birthYear = datesArray[0];\n\n                        var m = \"\", d = \"\", y = \"\", displayDeceasedDate = \"\";\n                        if (data.deceasedDateTime) {\n                            var deceasedDateObj = new Date(data.deceasedDateTime);\n                            m = self.pad(deceasedDateObj.getUTCMonth()+1);\n                            d = deceasedDateObj.getUTCDate();\n                            y = deceasedDateObj.getUTCFullYear();\n                            deceasedDateObj = new Date(deceasedDateObj.toUTCString().slice(0, -4));\n                            displayDeceasedDate = deceasedDateObj.toLocaleDateString(\"en-GB\", { //use native date function\n                                day: \"numeric\",\n                                month: \"short\",\n                                year: \"numeric\"\n                            });\n                        }\n                        self.demo.data.displayDeceasedDate = displayDeceasedDate;\n                        self.demo.data.deceasedDay = d;\n                        self.demo.data.deceasedMonth = m;\n                        self.demo.data.deceasedYear = y;\n\n                        if (data.identifier) {\n                            (data.identifier).forEach(function(item) {\n                                if (item.system === self.modules.SYSTEM_IDENTIFIER_ENUM.external_site_id) {\n                                    data.siteId = item.value;\n                                }\n                                if (item.system === self.modules.SYSTEM_IDENTIFIER_ENUM.external_study_id) {\n                                    data.studyId = item.value;\n                                }\n                            });\n                        }\n                        self.demo.data.language = \"\";\n                        if (data.communication) {\n                            data.communication.forEach(function(o) {\n                                if (o.language && o.language.coding) {\n                                    o.language.coding.forEach(function(item) {\n                                        self.demo.data.language = item;\n                                        self.demo.data.languageCode = item.code;\n                                        self.demo.data.languageDisplay = item.display;\n                                    });\n                                }\n                            });\n                        }\n                        if (data.extension) {\n                            (data.extension).forEach(function(item) {\n                                if (item.url === self.modules.SYSTEM_IDENTIFIER_ENUM.ethnicity) {\n                                    item.valueCodeableConcept.coding.forEach(function(ethnicity) {\n                                        self.demo.data.ethnicity = self.demo.data.ethnicity || [];\n                                        self.demo.data.ethnicity.push(ethnicity);\n                                        self.demo.data.ethnicityCodes = ethnicity.code;\n                                    });\n                                }\n                                if (item.url === self.modules.SYSTEM_IDENTIFIER_ENUM.race) {\n                                    item.valueCodeableConcept.coding.forEach(function(race) {\n                                        self.demo.data.race = self.demo.data.race || [];\n                                        self.demo.data.race.push(race);\n                                    });\n                                    if (self.demo.data.race) {\n                                        self.demo.data.raceCodes = self.demo.data.race.map(function(item) {\n                                            return item.code; });\n                                    }\n                                }\n                                if (!self.demo.data.timezone && item.url === self.modules.SYSTEM_IDENTIFIER_ENUM.timezone) {\n                                    self.demo.data.timezone = item.timezone ? item.timezone : \"\";\n                                }\n                            });\n                        }\n                        self.demo.data.raceCodes = self.demo.data.raceCodes || [];\n                    }\n                    callback(data);\n                });\n            },\n            setUserSettings: function() {\n                if ($(\"#profileForm\").length > 0) {\n                    this.subjectId = document.querySelector(\"#profileUserId\").value;\n                    this.currentUserId = document.querySelector(\"#profileCurrentUserId\").value;\n                    this.mode = \"profile\";\n                }\n                if ($(\"#aboutForm\").length > 0) {\n                    this.subjectId = document.querySelector(\"#iq_userId\").value;\n                    this.currentUserId = document.querySelector(\"#iq_userId\").value;\n                    this.mode = \"initialQueries\";\n                }\n                var acoContainer = document.querySelector(\"#accountCreationContentContainer\");\n                if (acoContainer) {\n                    this.currentUserId = document.querySelector(\"#currentStaffUserId\").value;\n                    this.mode = acoContainer.getAttribute(\"data-account\") === \"patient\" ? \"createPatientAccount\": \"createUserAccount\";\n                }\n            },\n            getOrgTool: function(callback) {\n                callback = callback || function() {};\n                if (!this.orgTool) {\n                    var self = this;\n                    this.orgTool = new (this.modules.orgTool) ();\n                    this.orgTool.init(function(data) {\n                        if (data && !data.error) {\n                            self.orgsData = data;\n                        }\n                        callback(data);\n                    });\n                    this.orgsList = this.orgTool.getOrgsList();\n                }\n                return this.orgTool;\n            },\n            isConsentEditable: function() {\n                var isStaff = this.currentUserRoles.indexOf(\"staff\") !== -1;\n                var isCurrentUserPatient = this.currentUserRoles.indexOf(\"patient\") !== -1;\n                var isEditableByStaff = this.settings.hasOwnProperty(\"CONSENT_EDIT_PERMISSIBLE_ROLES\") && this.settings.CONSENT_EDIT_PERMISSIBLE_ROLES.indexOf(\"staff\") !== -1;\n                var isEditableByPatient = this.settings.hasOwnProperty(\"CONSENT_EDIT_PERMISSIBLE_ROLES\") && this.settings.CONSENT_EDIT_PERMISSIBLE_ROLES.indexOf(\"patient\") !== -1;\n                return !this.isDisableField(\"consent_status\") && ((isStaff && isEditableByStaff) || (isCurrentUserPatient && isEditableByPatient));\n            },\n            isTestEnvironment: function() {\n                return String(this.settings.SYSTEM_TYPE).toLowerCase() !== \"production\";\n            },\n            isAdmin: function() {\n                return this.currentUserRoles.indexOf(\"admin\") !== -1;\n            },\n            isSubjectPatient: function() {\n                if (this.mode === \"createPatientAccount\" || $(\"#profileMainContent\").hasClass(\"patient-view\")) {\n                    return true;\n                }\n                if (this.userRoles.length === 0) { //this is a blocking call if not cached, so avoid it if possible\n                    this.initUserRoles({sync:true});\n                }\n                return this.userRoles.indexOf(\"patient\") !== -1;\n            },\n            isStaff: function() {\n                return this.currentUserRoles.indexOf(\"staff\") !== -1 ||  this.currentUserRoles.indexOf(\"staff_admin\") !== -1;\n            },\n            isProxy: function() {\n                return (this.currenUserId !== \"\") && (this.subjectId !== \"\") && (this.currentUserId !== this.subjectId);\n            },\n            isConsentWithTopLevelOrg: function() {\n                return this.settings.CONSENT_WITH_TOP_LEVEL_ORG;\n            },\n            getShowInMacro: function() {\n                return this.settings.SHOW_PROFILE_MACROS || [];\n            },\n            setSectionLoaders: function() {\n                $(\"#profileForm .section-loader\").removeClass(\"tnth-hide\");\n            },\n            clearSectionLoaders: function() {\n                $(\"#profileForm .section-loader\").addClass(\"tnth-hide\");\n                $(\"#profileForm .profile-item-edit-btn\").addClass(\"active\");\n            },\n            onBeforeSectionsLoad: function() {\n                if (this.mode === \"profile\") {\n                    document.querySelector(\"#mainDiv\").classList.add(\"profile\");\n                }\n            },\n            onSectionsDidLoad: function() {\n                this.setDisableFields();\n                if (this.mode === \"profile\") { //Note, this attach loader indicator to element with the class data-loader-container, in order for this to work, the element needs to have an id attribute\n                    var self = this;\n                    setTimeout(function() {\n                        self.initFieldsEvent();\n                        self.initLoginAsButtons();\n                        self.fillViews = self.setView();\n                        self.initEditButtons();\n                    }, 50);\n                    $(document).ajaxStop(function() {\n                        self.clearSectionLoaders(); //clear section loaders after ajax calls completed, note this will account for failed/cancelled requests as well\n                    });\n                }\n            },\n            initLoginAsButtons: function() {\n                var self = this;\n                $(\"#loginAsButton, #btnLoginAs\").on(\"click\", function(e) {\n                    e.preventDefault();\n                    e.stopPropagation();\n                    sessionStorage.clear();\n                    self.handleLoginAs(e);\n                });\n            },\n            initEditButtons: function() {\n                var self = this;\n                $(\"#profileForm .profile-item-edit-btn\").each(function() {\n                    $(this).on(\"click\", function(e) {\n                        e.preventDefault();\n                        var container = $(this).closest(\".profile-item-container\");\n                        container.toggleClass(\"edit\");\n                        $(this).val(container.hasClass(\"edit\") ? i18next.t(\"DONE\") : i18next.t(\"EDIT\"));\n                        if (!container.hasClass(\"edit\")) {\n                            self.fillSectionView(container.attr(\"data-sections\"));\n                            self.handleOptionalCoreData();\n                        }\n                    });\n                });\n            },\n            initFieldsEvent: function() {\n                var self = this;\n                $(\"#profileMainContent [data-loader-container]\").each(function() {\n                    var attachId = $(this).attr(\"id\");\n                    var targetFields = $(this).find(\"input, select\");\n                    if (targetFields.length === 0) {\n                        return true;\n                    }\n                    targetFields.each(function() {\n                        if ($(this).attr(\"type\") === \"hidden\") {\n                            return false;\n                        }\n                        $(this).attr(\"data-save-container-id\", attachId);\n                        var triggerEvent = $(this).attr(\"data-trigger-event\") || \"change\";\n                        if ($(this).attr(\"data-update-on-validated\")) {\n                            triggerEvent = \"blur\";\n                        }\n                        triggerEvent = triggerEvent + \" change\";\n                        if ($(this).attr(\"type\") === \"text\") {\n                            $(this).on(\"keypress\", function(e) {\n                                e.stopPropagation();\n                                if (e.keyCode === 13) { //account for hitting enter key when updating text field\n                                    $(this).trigger(triggerEvent);\n                                    return false;\n                                }\n                            });\n                        }\n                        $(this).on(triggerEvent, function(e) {\n                            e.stopPropagation();\n                            self.modules.tnthAjax.clearDemoSessionData(self.subjectId); //seems there is a race condition here, make sure not to use cache data here as data is being updated\n                            var valid = this.validity ? this.validity.valid : true;\n                            if (!$(this).attr(\"data-update-on-validated\") && valid) {\n                                var o = $(this);\n                                var parentContainer = $(this).closest(\".profile-item-container\");\n                                var setDemoInterval = setInterval(function() {\n                                    var customErrorField = $(\"#\" + o.attr(\"data-error-field\"));\n                                    var hasError = customErrorField.length > 0 && customErrorField.text() !== \"\";\n                                    if (!hasError) { //need to check default help block for error as well\n                                        var errorBlock = parentContainer.find(\".help-block\");\n                                        hasError = errorBlock.length > 0 && errorBlock.text() !== \"\";\n                                    }\n                                    if (hasError) {\n                                        clearInterval(setDemoInterval);\n                                        return false;\n                                    }\n                                    clearInterval(setDemoInterval);\n                                    o.trigger(\"updateDemoData\");\n                                }, 10);\n                            }\n                        });\n                    });\n                });\n            },\n            initSections: function(callback) {\n                var self = this, sectionsInitialized = {}, initCount = 0;\n                $(\"#mainDiv [data-profile-section-id]\").each(function() {\n                    var sectionId = $(this).attr(\"data-profile-section-id\");\n                    if (!sectionsInitialized[sectionId]) {\n                        setTimeout(function() {\n                            self.initSection(sectionId);\n                        }, initCount += 20);\n                        sectionsInitialized[sectionId] = true;\n                    }\n                });\n                if (callback) {\n                    setTimeout(function() {callback();}, initCount+20);\n                }\n            },\n            handleOptionalCoreData: function() {\n                var targetSection = $(\"#profileDetailContainer\"), self = this;\n                if (targetSection.length > 0) {\n                    var loadingElement = targetSection.find(\".profile-item-loader\");\n                    loadingElement.show();\n                    this.modules.tnthAjax.getOptionalCoreData(self.subjectId, {useWorker: true, cache: true}, function(data) { //cache this request as change is rare if ever for optional data\n                        if (data.optional) {\n                            var sections = $(\"#profileForm .optional\");\n                            sections.each(function() {\n                                var sectionElement = $(this);\n                                var section = sectionElement.attr(\"data-section-id\");\n                                var parent = sectionElement.closest(\".profile-item-container\");\n                                var visibleRows = parent.find(\".view-container tr:visible\").length;\n                                var noDataContainer = parent.find(\".no-data-container\");\n                                var btn = parent.find(\".profile-item-edit-btn\");\n                                if (section) {\n                                    if ((data.optional).indexOf(section) !== -1) {\n                                        sectionElement.show();\n                                        noDataContainer.html(\"\");\n                                        btn.show();\n                                    } else {\n                                        sectionElement.hide();\n                                        if (visibleRows === 0) {\n                                            noDataContainer.html(\"<p class='text-muted'>\" + i18next.t(\"No information available\") + \"</p>\");\n                                            btn.hide();\n                                        }\n                                    }\n                                }\n                            });\n                        }\n                        loadingElement.hide();\n                    });\n                }\n            },\n            fillSectionView: function(sectionID) {\n                if (sectionID && this.fillViews[sectionID]) {\n                    this.fillViews[sectionID]();\n                }\n            },\n            setView: function() {\n                var self = this;\n                return {\n                    \"setContent\": function(field, content) {\n                        if ($.trim(content)) {\n                            field.html(i18next.t(content));\n                        } else {\n                            field.html(\"<p class='text-muted'>\" + i18next.t(\"not provided\") + \"</p>\");\n                        }\n                    },\n                    \"clinical\": function() {\n                        this.setContent($(\"#pca_diag_view\"), $(\"#patDiag input[name='pca_diag']:checked\").closest(\"label\").text());\n                        this.setContent($(\"#pca_localized_view\"), $(\"#patMeta input[name='pca_localized']:checked\").closest(\"label\").text());\n                        if ($(\"#biopsyDateContainer\").hasClass(\"has-error\") || $(\"#biopsyDateError\").text()) {\n                            return false;\n                        }\n                        var tnthDates = self.modules.tnthDates;\n                        var f = $(\"#patBiopsy input[name='biopsy']:checked\");\n                        var a = f.val(), m = $(\"#biopsy_month option:selected\").val(), y = $(\"#biopsy_year\").val(), d = $(\"#biopsy_day\").val();\n                        var content = f.closest(\"label\").text();\n                        if (String(a) === \"true\" && $.trim(m+y+d)) {\n                            content += \"&nbsp;&nbsp;\" + tnthDates.displayDateString(m, d, y);\n                            $(\"#biopsyDateContainer\").show();\n                        }\n                        this.setContent($(\"#biopsy_view\"), content);\n                    }\n                };\n            },\n            initSection: function(type) {\n                switch (String(type).toLowerCase()) {\n                case \"name\":\n                    this.initNameSection();\n                    break;\n                case \"birthday\":\n                    this.initBirthdaySection();\n                    break;\n                case \"email\":\n                    this.initEmailSection();\n                    break;\n                case \"phone\":\n                    this.initPhoneSection();\n                    break;\n                case \"altphone\":\n                    this.initAltPhoneSection();\n                    break;\n                case \"orgsstateselector\":\n                    this.initOrgsStateSelectorSection();\n                    this.initConsentSection();\n                    break;\n                case \"orgs\":\n                    this.initDefaultOrgsSection();\n                    this.initConsentSection();\n                    break;\n                case \"consent\":\n                    this.initConsentSection();\n                    break;\n                case \"communication\":\n                    this.initResetPasswordSection();\n                    this.initCommunicationSection();\n                    break;\n                case \"patientemailform\":\n                    this.initPatientEmailFormSection();\n                    break;\n                case \"staffemailform\":\n                    this.initStaffRegistrationEmailSection();\n                    break;\n                case \"resetpassword\":\n                    this.initResetPasswordSection();\n                    break;\n                case \"deceased\":\n                    this.initDeceasedSection();\n                    break;\n                case \"patientreport\":\n                    this.initPatientReportSection();\n                    break;\n                case \"assessmentlist\":\n                    this.initAssessmentListSection();\n                    break;\n                case \"clinicalquestions\":\n                    this.initClinicalQuestionsSection();\n                    break;\n                case \"custompatientdetail\":\n                    this.initCustomPatientDetailSection();\n                    break;\n                case \"procedure\":\n                    this.initProcedureSection();\n                    break;\n                case \"roleslist\":\n                    this.initRolesListSection();\n                    break;\n                case \"auditlog\":\n                    this.initAuditLogSection();\n                    break;\n                }\n            },\n            handleLoginAs: function(e) {\n                if (e) {\n                    e.preventDefault();\n                    e.stopPropagation();\n                }\n                try { //sessionStorage does not work in private mode\n                    sessionStorage.setItem(\"loginAsPatient\", \"true\");\n                } catch (ex) { //alert user if this is not set properly\n                    alert(i18next.t(\"Unable to properly set session storage variable for login-as. \") + ex.message);\n                }\n                location.replace(\"/login-as/\" + this.subjectId);\n            },\n            postDemoData: function(field, data, callback) {\n                callback = callback || function() {};\n                if (!this.subjectId) {\n                    callback({\"error\": i18next.t(\"Subject id is required\")});\n                    return false;\n                }\n                var self = this;\n                Vue.nextTick(function () {\n                    // DOM updated\n                    field = field || $(field);\n                    data = data || {};\n                    var valid = field.get(0).validity ? field.get(0).validity.valid : true;\n                    if (!valid) {\n                        callback({\"error\": i18next.t(\"Invalid field value.\")});\n                        return false;\n                    }\n                    var o = field;\n                    var parentContainer = field.closest(\".profile-item-container\");\n                    var editButton = parentContainer.find(\".profile-item-edit-btn\");\n                    var customErrorField = $(\"#\" + o.attr(\"data-error-field\"));\n                    var hasError = customErrorField.length > 0 && customErrorField.text() !== \"\";\n                    if (hasError) {\n                        editButton.attr(\"disabled\", false);\n                        callback({\"error\": i18next.t(\"Validation error.\")});\n                        return;\n                    }\n                    editButton.attr(\"disabled\", true);\n                    data.resourceType = data.resourceType || \"Patient\";\n                    self.modules.tnthAjax.putDemo(self.subjectId, data, field, false, function(data) {\n                        callback(data);\n                        setTimeout(function() {\n                            self.setDemoData({cache: false}, function() {\n                                var formGroup = parentContainer.find(\".form-group\").not(\".data-update-on-validated\");\n                                formGroup.removeClass(\"has-error\");\n                                formGroup.find(\".help-block.with-errors\").html(\"\");\n                                editButton.attr(\"disabled\", false);\n                            });\n                        }, 350);\n\n                    });\n                });\n            },\n            getTelecomData: function() {\n                var telecom = [];\n                var emailVal = $(\"#email\").val();\n                if ($.trim(emailVal)) {\n                    telecom.push({ \"system\": \"email\", \"value\": $.trim(emailVal)});\n                } else {\n                    telecom.push({\"system\": \"email\", \"value\": \"__no_email__\"});\n                }\n                var phone = $.trim($(\"#phone\").val());\n                if (phone) {\n                    telecom.push({\"system\": \"phone\", \"use\": \"mobile\", \"value\": phone});\n                }\n                var altphone = $.trim($(\"#altPhone\").val());\n                if (altphone) {\n                    telecom.push({\"system\": \"phone\", \"use\": \"home\", \"value\": altphone});\n                }\n                return {\"telecom\": telecom};\n            },\n            getIdentifierData: function() {\n                var self = this, studyIdField = $(\"#profileStudyId\"), siteIdField = $(\"#profileSiteId\");\n                var studyId = studyIdField.val(), siteId = siteIdField.val(), identifiers = [];\n                if (this.demo.data.identifier) {\n                    this.demo.data.identifier.forEach(function(identifier) {\n                        identifiers.push(identifier);\n                    });\n                } else {\n                    if (self.subjectId) {\n                        $.ajax({ //get current identifier(s)\n                            type: \"GET\",\n                            url: \"/api/demographics/\" + self.subjectId,\n                            async: false\n                        }).done(function(data) {\n                            if (data && data.identifier) {\n                                (data.identifier).forEach(function(identifier) {\n                                    identifiers.push(identifier);\n                                });\n                            }\n                        }).fail(function(xhr) {\n                            self.modules.tnthAjax.reportError(self.subjectId, \"api/demographics\" + self.subjectId, xhr.responseText);\n                        });\n                    }\n                }\n                identifiers = $.grep(identifiers, function(identifier) { //this will save study Id or site Id only if each has a value otherwise if each is empty, it will be purged from the identifiers that had older value of each\n                    return identifier.system !== self.modules.SYSTEM_IDENTIFIER_ENUM.external_study_id &&\n                        identifier.system !== self.modules.SYSTEM_IDENTIFIER_ENUM.external_site_id;\n                });\n                studyId = $.trim(studyId);\n                if (studyId) {\n                    var studyIdObj = {system: self.modules.SYSTEM_IDENTIFIER_ENUM.external_study_id, use: \"secondary\",value: studyId};\n                    identifiers.push(studyIdObj);\n                }\n                siteId = $.trim(siteId);\n                if (siteId) {\n                    var siteIdObj = { system: self.modules.SYSTEM_IDENTIFIER_ENUM.external_site_id, use: \"secondary\", value: siteId};\n                    identifiers.push(siteIdObj);\n                }\n                return {\"identifier\": identifiers};\n\n            },\n            getExtensionData: function() {\n                var self = this, e = $(\"#userEthnicity\"), r = $(\"#userRace\"), tz = $(\"#profileTimeZone\"), ethnicityIDs, raceIDs, tzID;\n                var extension = [];\n                if (e.length > 0) {\n                    ethnicityIDs = $(\"#userEthnicity input:checked\").map(function() {\n                        return {code: $(this).val(), system: self.modules.SYSTEM_IDENTIFIER_ENUM.ethnicity_system};\n                    }).get();\n                    if (ethnicityIDs) {\n                        extension.push({\"url\": self.modules.SYSTEM_IDENTIFIER_ENUM.ethnicity, \"valueCodeableConcept\": {\"coding\": ethnicityIDs}});\n                    }\n                }\n                if (r.length > 0) {\n                    raceIDs = $(\"#userRace input:checkbox:checked\").map(function() {\n                        return {code: $(this).val(),system: self.modules.SYSTEM_IDENTIFIER_ENUM.race_system};\n                    }).get();\n                    if (raceIDs) {\n                        extension.push({\"url\": self.modules.SYSTEM_IDENTIFIER_ENUM.race, \"valueCodeableConcept\": {\"coding\": raceIDs}});\n                    }\n                }\n                if (tz.length > 0) {\n                    tzID = $(\"#profileTimeZone option:selected\").val();\n                    if (tzID) {\n                        extension.push({timezone: tzID, url: self.modules.SYSTEM_IDENTIFIER_ENUM.timezone});\n                    }\n                }\n                return {\"extension\": extension};\n            },\n            initNameSection: function() {\n                var self = this;\n                $(\"#firstname\").on(\"updateDemoData\", function() {\n                    self.postDemoData($(this), {\"name\": {\"given\": $.trim($(this).val())}});\n                });\n                $(\"#lastname\").on(\"updateDemoData\", function() {\n                    self.postDemoData($(this), {\"name\": {\"family\": $.trim($(this).val())}});\n                });\n            },\n            initBirthdaySection: function() {\n                var self = this;\n                [\"year\", \"month\", \"date\"].forEach(function(fn) {\n                    var field = $(\"#\" + fn), y = $(\"#year\"), m = $(\"#month\"),d = $(\"#date\");\n                    field.on(\"keyup focusout\", function() {\n                        var isValid = self.modules.tnthDates.validateDateInputFields(m, d, y, \"errorbirthday\");\n                        if (isValid) {\n                            $(\"#birthday\").val(y.val() + \"-\" + m.val() + \"-\" + d.val());\n                            $(\"#errorbirthday\").html(\"\");\n                        } else {\n                            $(\"#birthday\").val(\"\");\n                        }\n                    });\n                    field.on(\"updateDemoData\", function() {\n                        if (y.val() && m.val() && d.val()) {\n                            self.postDemoData($(this), {birthDate: y.val() + \"-\" + m.val() + \"-\" + d.val()});\n                        }\n                    });\n                });\n                this.__convertToNumericField($(\"#date, #year\"));\n            },\n            initEmailSection: function() {\n                var self = this;\n                $(\"#email\").attr(\"data-update-on-validated\", \"true\").attr(\"data-user-id\", self.subjectId);\n                $(\".btn-send-email\").blur();\n                $(\"#email\").on(\"keyup\", function(e) {\n                    e.stopPropagation();\n                    $(\"#erroremail\").html(\"\");\n                });\n                $(\"#email\").on(\"change\", function() {\n                    setTimeout(function() {\n                        self.updateEmailVis();\n                    }, 350);\n                });\n                $(\"#email\").on(\"postEventUpdate\", function() {\n                    if (self.updateEmailVis()) { //should only update email if there is no validation error\n                        self.postDemoData($(this), self.getTelecomData());\n                    }\n                });\n            },\n            updateEmailVis: function() {\n                var hasError = $(\"#emailGroup\").hasClass(\"has-error\");\n                var emailValue = $(\"#email\").val();\n                if (!hasError) {\n                    this.demo.data.email = emailValue;\n                    $(\"#erroremail\").html(\"\");\n                    $(\"#email_view\").html(\"<p>\" + (emailValue||i18next.t(\"not provided\")) + \"</p>\"); //update email display /*global i18next */\n                }\n                return !hasError; //return appropriate indication that value/display has been updated if no error\n            },\n            updateTelecomData: function(event) {\n                this.postDemoData($(event.target), this.getTelecomData());\n            },\n            initPhoneSection: function() {\n                this.__convertToNumericField($(\"#phone\"));\n            },\n            initAltPhoneSection: function() {\n                this.__convertToNumericField($(\"#altPhone\"));\n            },\n            updateExtensionData: function(event) {\n                this.postDemoData($(event.target), this.getExtensionData());\n            },\n            updateGenderData: function(event) {\n                this.postDemoData($(event.target), {gender: event.target.value});\n            },\n            updateLocaleData: function(event) {\n                var targetElement = $(event.target);\n                var selectedLocale = targetElement.find(\"option:selected\");\n                var data = {communication: [{\n                    \"language\": {\n                        \"coding\": [{\"code\": selectedLocale.val(), \"display\": selectedLocale.text(), \"system\": \"urn:ietf:bcp:47\"}]\n                    }\n                }]};\n                this.postDemoData(targetElement, data);\n                this.modules.tnthDates.clearSessionLocale();\n                setTimeout(function() {window.location.reload(true);}, 1000);\n            },\n            updateIdentifierData: function(event) {\n                this.postDemoData($(event.target), this.getIdentifierData());\n            },\n            getAccessUrl: function() {\n                var url = \"\";\n                this.modules.tnthAjax.accessUrl(this.subjectId, true, function(data) {\n                    if (!data.error) {\n                        url = data.url;\n                    }\n                });\n                return url;\n            },\n            \"reloadSendPatientEmailForm\": function(userId) {\n                if ($(\"#sendPatientEmailTabContent\").length === 0) { return false; }\n                var self = this;\n                $(\"#sendPatientEmailTabContent\").animate({opacity: 0}, function() {\n                    $(this).css(\"opacity\", 1);\n                    setTimeout(function() {\n                        var checkedOrgInput = $(\"#userOrgs input[name='organization']:checked\");\n                        if (checkedOrgInput.attr(\"id\") === \"noOrgs\") {\n                            return false;\n                        }\n                        if (self.settings.hasOwnProperty(\"ACCEPT_TERMS_ON_NEXT_ORG\") &&\n                            checkedOrgInput.attr(\"data-parent-name\") === self.settings.ACCEPT_TERMS_ON_NEXT_ORG) {\n                            $(\"#profileassessmentSendEmailContainer\").addClass(\"active\");  ////update registration and assessment status email tiles in communications section, needed when org changes\n                            self.assessmentStatus(userId);\n                        } else {\n                            $(\"#profileassessmentSendEmailContainer\").removeClass(\"active\");\n                        }\n                    }, 500);\n                });\n            },\n            \"assessmentStatus\": function(userId) {\n                var self = this;\n                this.modules.tnthAjax.patientReport(userId, {useWorker: true}, function(data) {\n                    if (data.error || !data.user_documents) {\n                        return false;\n                    }\n                    self.patientReport.data = data.user_documents;\n                    var pcpReports = $.grep(data.user_documents, function(document) {\n                        return /P3P/gi.test(document.filename);\n                    });\n                    self.patientReport.hasP3PReport = pcpReports && pcpReports.length > 0;\n                    if (self.patientReport.hasP3PReport) {\n                        $(\"#btnProfileSendassessmentEmail\").hide();\n                        $(\"#assessmentStatusContainer .email-selector-container\").hide();\n                    }\n                });\n            },\n            getEmailContent: function(userId, messageId, callback) {\n                callback = callback || function() {};\n                $(\"#messageLoader_\"+messageId).show();\n                $(\"#messageLink_\"+messageId).css(\"visibility\", \"hidden\");\n                this.modules.tnthAjax.emailLog(userId, false, function(data) {\n                    setTimeout(function() {\n                        $(\"#messageLoader_\"+messageId).hide();\n                        $(\"#messageLink_\"+messageId).css(\"visibility\", \"visible\");\n                    }, 550);\n                    if (!data.messages) {\n                        callback(data);\n                        return false;\n                    }\n                    var targetMessages = $.grep(data.messages, function(item) {\n                        return parseInt(item.id) === parseInt(messageId);\n                    });\n                    targetMessages.forEach(function(item) {\n                        $(\"#emailBodyModal .body-content\").html(item.body);\n                        $(\"#emailBodyModal .body-content a\").each(function() { // email content contains clickable link/button - need to prevent click event of those from being triggered\n                            $(this).on(\"click\", function(e) {\n                                e.preventDefault();\n                                return false;\n                            });\n                        });\n                        $(\"#emailBodyModal .body-content style\").remove(); //need to remove inline style specifications - as they can be applied globally and override the classes specified in stylesheet\n                        $(\"#emailBodyModal .body-content a.btn\").addClass(\"btn-tnth-primary\");\n                        $(\"#emailBodyModal .body-content td.btn, #emailBodyModal .body-content td.btn a\").addClass(\"btn-tnth-primary\").removeAttr(\"width\").removeAttr(\"style\");\n                        $(\"#emailBodyModal\").modal(\"show\"); //remove inline style in email body, style here is already applied via css\n                    });\n                    callback(data);\n                });\n            },\n            getEmailLog: function(userId, data) {\n                if (!data.error) {\n                    var self = this;\n                    if (data.messages && data.messages.length > 0) {\n                        (data.messages).forEach(function(item) {\n                            item.sent_at = self.modules.tnthDates.formatDateString(item.sent_at, \"iso\");\n                            item.subject = `<i id=\"messageLoader_${item.id}\" class=\"message-loader fa fa-spinner fa-spin tnth-hide\"></i>\n                                           <a id=\"messageLink_${item.id}\" class=\"item-link\" data-user-id=\"${userId}\" data-item-id=\"${item.id}\"><u>${item.subject}</u></a>`;\n                        });\n                        $(\"#emailLogContent\").html(\"<table id='profileEmailLogTable'></table>\");\n                        $(\"#profileEmailLogTable\").bootstrapTable(this.setBootstrapTableConfig({\n                            data: data.messages,\n                            classes: \"table table-responsive profile-email-log\",\n                            sortName: \"sent_at\",\n                            sortOrder: \"desc\",\n                            toolbar: \"#emailLogTableToolBar\",\n                            columns: [{\n                                field: \"sent_at\",\n                                title: i18next.t(\"Date (GMT), Y-M-D\"),\n                                searchable: true,\n                                sortable: true\n                            }, {\n                                field: \"subject\",\n                                title: i18next.t(\"Subject\"),\n                                class: \"message-subject\",\n                                searchable: true,\n                                sortable: true\n                            }, {\n                                field: \"recipients\",\n                                title: i18next.t(\"Email\"),\n                                sortable: true,\n                                searchable: true,\n                                width: \"20%\"\n                            }]\n                        }));\n                        setTimeout(function() {\n                            $(\"#lbEmailLog\").addClass(\"active\");\n                            $(\"#profileEmailLogTable a.item-link\").on(\"click\", function() {\n                                self.getEmailContent($(this).attr(\"data-user-id\"), $(this).attr(\"data-item-id\"));\n                            });\n                        }, 150);\n                    } else {\n                        $(\"#emailLogContent\").html(\"<span class='text-muted'>\" + i18next.t(\"No email log entry found.\") + \"</span>\");\n                    }\n                } else {\n                    $(\"#emailLogMessage\").text(data.error);\n                }\n            },\n            initPatientEmailFormSection: function() {\n                var self = this;\n                if ($(\"#profileassessmentSendEmailContainer.active\").length > 0) {\n                    self.assessmentStatus(self.subjectId);\n                }\n                $(\".email-selector\").off(\"change\").on(\"change\", function() {\n                    self.messages.userInviteEmailErrorMessage = \"\";\n                    self.messages.userInviteEmailInfoMessage = \"\";\n                    var emailType = $(this).closest(\".profile-email-container\").attr(\"data-email-type\");\n                    $(\".profilePatientEmail__btn-msg-wrapper\").addClass(\"tnth-hide\");\n                    if ($(this).val() === \"\") {\n                        $(\"#profile\"+emailType+\"EmailBtnMsgWrapper\").addClass(\"tnth-hide\");\n                    } else {\n                        $(\"#profile\"+emailType+\"EmailBtnMsgWrapper\").removeClass(\"tnth-hide\");\n                    }\n                    var btnEmail = $(\"#btnProfileSend\" + emailType + \"Email\");\n                    if (String(this.value) !== \"\" && $(\"#email\").val() !== \"\" && $(\"#erroremail\").text() === \"\") {\n                        var message = i18next.t(\"{emailType} email will be sent to {email}\");\n                        message = message.replace(\"{emailType}\", $(this).children(\"option:selected\").text())\n                            .replace(\"{email}\", $(\"#email\").val());\n                        self.messages.userInviteEmailInfoMessage = message;\n                        btnEmail.attr(\"disabled\", false).removeClass(\"disabled\");\n                    } else {\n                        self.messages.userInviteEmailInfoMessage = \"\";\n                        btnEmail.attr(\"disabled\", true).addClass(\"disabled\");\n                    }\n                });\n                $(\"#email\").on(\"change\", function() {\n                    self.messages.userInviteEmailInfoMessage = \"\";\n                    self.messages.userInviteEmailErrorMessage = \"\";\n                });\n                $(\".btn-send-email\").off(\"click\").on(\"click\", function(event) {\n                    event.preventDefault();\n                    event.stopPropagation();\n                    var emailType = $(this).closest(\".profile-email-container\").attr(\"data-email-type\");\n                    var emailTypeElem = $(\"#profile\" + emailType + \"EmailSelect\"), selectedOption = emailTypeElem.children(\"option:selected\");\n                    var btnSelf = $(this);\n                    if (selectedOption.val() === \"\") {\n                        return false;\n                    }\n                    var emailUrl = selectedOption.attr(\"data-url\"), email = $(\"#email\").val(), subject = \"\", body = \"\", returnUrl = \"\";\n                    var accessUrlError = \"\";\n                    if (!emailUrl) {\n                        self.messages.userInviteEmailErrorMessage = i18next.t(\"Url for email content is unavailable.\");\n                        return false;\n                    }\n                    var resetBtn = function(disabled, showLoading) {\n                        disabled = disabled || false;\n                        btnSelf.attr(\"disabled\", disabled).show();\n                        self.patientEmailForm.loading = showLoading;\n                        if (!disabled) {\n                            btnSelf.removeClass(\"disabled\");\n                        } else {\n                            btnSelf.addClass(\"disabled\");\n                        }\n                    };\n                    resetBtn(true, true);\n                    btnSelf.hide();\n                    $.ajax({ //get email content via API\n                        type: \"GET\",\n                        url: emailUrl,\n                        cache: false,\n                        async: true\n                    }).done(function(data) {\n                        if (!data || !data.subject || !data.body) {\n                            self.messages.userInviteEmailErrorMessage = \"<div>\" + i18next.t(\"Unable to send email. Missing content.\") + \"</div>\";;\n                            resetBtn();\n                            return false;\n                        }\n                        subject = data.subject;\n                        body = data.body;\n                        if (selectedOption.val() === \"invite\" && emailType === \"registration\") {\n                            returnUrl = self.getAccessUrl();\n                            if (returnUrl) {\n                                body = body.replace(/url_placeholder/g, decodeURIComponent(returnUrl));\n                            } else {\n                                accessUrlError = i18next.t(\"failed request to get email invite url\");\n                            }\n                        }\n\n                        self.messages.userInviteEmailErrorMessage = \"\";\n                        if (accessUrlError) {\n                            self.messages.userInviteEmailErrorMessage = accessUrlError;\n                            resetBtn();\n                            return false;\n                        }\n                        self.modules.tnthAjax.invite(self.subjectId, {\n                            \"subject\": subject,\n                            \"recipients\": email,\n                            \"body\": body\n                        }, function(data) {\n                            if (data.error) {\n                                self.messages.userInviteEmailErrorMessage = i18next.t(\"Error occurred while sending invite email.\");\n                                resetBtn();\n                                return false;\n                            }\n                            self.messages.userInviteEmailInfoMessage = \"<strong class='text-success'>\" + i18next.t(\"{emailType} email sent to {emailAddress}\").replace(\"{emailType}\", selectedOption.text()).replace(\"{emailAddress}\", email) + \"</strong>\";\n                            emailTypeElem.val(\"\");\n                            self.modules.tnthAjax.emailLog(self.subjectId, {useWorker: true}, function(data) { //reload email audit log\n                                setTimeout(function() {\n                                    self.getEmailLog(self.subjectId, data);\n                                }, 100);\n                            });\n                            resetBtn(true);\n                        });\n                    }).fail(function(xhr) { //report error\n                        self.messages.userInviteEmailErrorMessage = i18next.t(\"Error occurred retreving email content via API.\");\n                        resetBtn();\n                        self.modules.tnthAjax.reportError(self.subjectId, emailUrl, xhr.responseText);\n                    });\n                });\n            },\n            initStaffRegistrationEmailSection: function() {\n                var self = this;\n                $(\"#btnProfileSendEmail\").on(\"click\", function(event) {\n                    event.preventDefault();\n                    var email = $(\"#email\").val(), subject = \"\", body = \"\", return_url = \"\";\n                    var clinicName = (function() {\n                        var orgs = $(\"#userOrgs input[name='organization']:checked\"), parentName = \"\";\n                        if (orgs.length > 0) {\n                            orgs.each(function() {\n                                if (!parentName) {\n                                    parentName = $(this).attr(\"data-parent-name\") || $(this).closest(\".org-container[data-parent-id]\").attr(\"data-parent-name\") ;\n                                }\n                            });\n                        }\n                        return parentName ? parentName : i18next.t(\"your clinic\");\n                    })();\n                    $(this).addClass(\"disabled\").attr(\"disabled\", true);\n                    $(\"#sendRegistrationEmailForm .loading-indicator\").show();\n                    $(\"#profileEmailErrorMessage\").html(\"\");\n                    var btnRef = $(this);\n                    $.ajax({\n                        type: \"GET\",\n                        url: $(\"#staffRegistrationEmailUrl\").val(),\n                        cache: false,\n                        async: false\n                    }).done(function(data) {\n                        if (data) {\n                            subject = data.subject;\n                            body = data.body;\n                        }\n                    }).fail(function() {});\n\n                    if (!body) { ////provide default body content if no body content was returned from ajax call\n                        body = \"<p>\" + i18next.t(\"Hello, this is an invitation to complete your registration.\") + \"</p>\";\n                        return_url = self.getAccessUrl();\n                        if (return_url) {\n                            body += \"<a href='\" + decodeURIComponent(return_url) + \"'>\" + i18next.t(\"Verify your account to complete registration\") + \"</a>\";\n                        }\n                    }\n                    if (!subject) {\n                        subject = i18next.t(\"Registration invite from {clinicName}\").replace(\"{clinicName}\", clinicName);\n                    }\n\n                    self.modules.tnthAjax.invite(self.subjectId, {\n                        \"subject\": subject,\"recipients\": email,\"body\": body}, function(data) {\n                        if (!data.error) {\n                            $(\"#profileEmailMessage\").text(i18next.t(\"invite email sent to {email}\").replace(\"{email}\", email));\n                            $(\"#btnProfileSendEmail\").attr(\"disabled\", true);\n                        } else {\n                            if (data.error) {\n                                $(\"#profileEmailErrorMessage\").text(i18next.t(\"Error occurred while sending invite email.\"));\n                            }\n                        }\n                        $(\"#sendRegistrationEmailForm .loading-indicator\").hide();\n                        btnRef.removeClass(\"disabled\").attr(\"disabled\", false);\n                    });\n                });\n            },\n            initCommunicationSection: function() {\n                $(\"#communicationsContainer .tab-label\").on(\"click\", function() {\n                    $(\"#communicationsContainer .tab-label\").removeClass(\"active\");\n                    $(this).addClass(\"active\");\n                });\n                $(\"#emailBodyModal\").modal({\"show\": false});\n                var subjectId = this.subjectId, self = this;\n                this.modules.tnthAjax.emailLog(subjectId, {useWorker: true}, function(data) {\n                    setTimeout(function() { self.getEmailLog(subjectId, data); }, 100);\n                });\n            },\n            initResetPasswordSection: function() {\n                var self = this;\n                $(\"#btnPasswordResetEmail\").on(\"click\", function(event) {\n                    event.preventDefault();\n                    event.stopImmediatePropagation(); //stop bubbling of events\n                    var email = $(\"#email\").val();\n                    self.modules.tnthAjax.passwordReset(self.subjectId, function(data) {\n                        if (!data.error) {\n                            $(\"#passwordResetMessage\").text(i18next.t(\"Password reset email sent to {email}\").replace(\"{email}\", email));\n                        } else {\n                            $(\"#passwordResetMessage\").text(i18next.t(\"Unable to send email.\"));\n                        }\n                    });\n                });\n            },\n            updateDeceasedSection: function(targetField) {\n                var data = {}, isChecked = $(\"#boolDeath\").is(\":checked\");\n                var hasSuspendedConsent = $(\"#consentListTable .withdrawn-label\").length;\n                var confirmationRequired = isChecked && !hasSuspendedConsent && this.settings.LOCALIZED_AFFILIATE_ORG && this.topLevelOrgs.indexOf(this.settings.LOCALIZED_AFFILIATE_ORG) !== -1;\n                $(\"#deceasedInfo\").html(\"\");\n                if ($(\"#deathDate\").val()) {\n                    data.deceasedDateTime = $(\"#deathDate\").val();\n                }\n                data.deceasedBoolean = isChecked;\n                if (!confirmationRequired) {\n                    this.postDemoData(targetField, data);\n                    return;\n                }\n                var self = this, subjectId = this.subjectId;\n                var setDisabledFields = function(disabledFlag) {\n                    $(\"#boolDeath, #deathDate, #deathDay, #deathYear, #deathMonth\").attr(\"disabled\", disabledFlag);\n                };\n                var hidePopover = function() {\n                    $(\"#deceasedConsentPopover\").popover(\"hide\");\n                };\n                var showPopover = function() {\n                    if (!$(\"#deceasedConsentPopover\").attr(\"aria-describedby\")) {\n                        $(\"#deceasedConsentPopover\").popover(\"show\");\n                    }\n                };\n                var clearFields = function() {\n                    if (!self.demo.data.deceasedDateTime) {\n                        $(\"#deathDate, #deathDay, #deathYear, #deathMonth\").val(\"\");\n                    }\n                    if (!(String(self.demo.data.deceasedBoolean).toLowerCase() === \"true\")) {\n                        $(\"#boolDeath\").prop(\"checked\", false);\n                    }\n                    hidePopover();\n                };\n                showPopover();\n                $(\"#btnDeceasedConsentYes\").off(\"click\").on(\"click\", function(e) { //selecting yes in the confirmation popover\n                    e.stopPropagation();\n                    setDisabledFields(true);\n                    self.postDemoData(targetField, data, function(data) {\n                        if (!data || data.error) {\n                            setDisabledFields(false);\n                            return false;\n                        }\n                        var orgTool = self.getOrgTool(), selectedOrgElement = orgTool.getSelectedOrg();\n                        if (!selectedOrgElement.length) { //no need to continue if no affiliated org\n                            setDisabledFields(false);\n                            return;\n                        }\n                        self.modules.tnthAjax.withdrawConsent(subjectId, selectedOrgElement.val(), \"\", function(data) {\n                            setDisabledFields(false);\n                            if (data.error) {\n                                $(\"#deceasedInfo\").html(i18next.t(\"Error occurred suspending consent for subject.\"));\n                                return;\n                            }\n                            hidePopover();\n                            self.reloadConsentList(subjectId);\n                        });\n                    });\n                });\n                $(\"#btnDeceasedConsentNo\").off(\"click\").on(\"click\", function(e) { //selecting no in the confirmation popover\n                    e.stopPropagation();\n                    clearFields();\n                });\n                $(\"#profileDeceasedSection .profile-item-edit-btn\").on(\"click\", function(e) {\n                    e.stopPropagation();\n                    clearFields();\n                });\n            },\n            initDeceasedSection: function() {\n                var self = this;\n                $(\"#deathYear\").val(\"\");\n                $(\"#deathMonth\").val(\"\");\n                $(\"#deathDay\").val(\"\");\n                $(\"#deathDate\").val(\"\");\n                $(\"#boolDeath\").prop(\"checked\", false);\n                if (this.demo.data.deceasedDateTime) {\n                    $(\"#deathYear\").val(this.demo.data.deceasedYear);\n                    $(\"#deathMonth\").val(this.demo.data.deceasedMonth);\n                    $(\"#deathDay\").val(this.demo.data.deceasedDay);\n                    $(\"#deathDate\").val(this.demo.data.deceasedMonth + \"-\" + this.demo.data.deceasedDay + \"-\" + this.demo.data.deceasedYear);\n                    $(\"#boolDeath\").prop(\"checked\", true);\n                }\n                if (String(this.demo.data.deceasedBoolean).toLowerCase() === \"true\") {\n                    $(\"#boolDeath\").prop(\"checked\", true);\n                }\n                this.__convertToNumericField($(\"#deathDay, #deathYear\"));\n                $(\"#boolDeath\").on(\"click\", function() {\n                    if (!($(this).is(\":checked\"))) {\n                        $(\"#deathYear\").val(\"\");\n                        $(\"#deathDay\").val(\"\");\n                        $(\"#deathMonth\").val(\"\");\n                        $(\"#deathDate\").val(\"\");\n                    }\n                    self.updateDeceasedSection($(\"#boolDeathGroup\"));\n                });\n                [\"deathDay\", \"deathMonth\", \"deathYear\"].forEach(function(fn) {\n                    var fd = $(\"#\" + fn);\n                    var triggerEvent = fd.attr(\"type\") === \"text\" ? \"blur\" : \"change\";\n                    fd.on(triggerEvent, function() {\n                        var d = $(\"#deathDay\"), m = $(\"#deathMonth\"), y = $(\"#deathYear\");\n                        if (d.val() && m.val() && y.val() && d.get(0).validity.valid && m.get(0).validity.valid && y.get(0).validity.valid) {\n                            var errorMsg = self.modules.tnthDates.dateValidator(d.val(), m.val(), y.val(), true);\n                            if (errorMsg === \"\") {\n                                $(\"#deathDate\").val(y.val() + \"-\" + m.val() + \"-\" + d.val());\n                                $(\"#boolDeath\").prop(\"checked\", true);\n                                $(\"#errorDeathDate\").text(\"\");\n                                self.updateDeceasedSection($(\"#deceasedDateContainer\"));\n                            } else {\n                                $(\"#errorDeathDate\").text(errorMsg);\n                            }\n                        }\n                    });\n                });\n            },\n            initPatientReportSection: function() {\n                var self = this;\n                this.modules.tnthAjax.patientReport(self.subjectId, {useWorker: true}, function(data) {\n                    if (!data.error) {\n                        if (data.user_documents && data.user_documents.length > 0) {\n                            var fData = [];\n                            (data.user_documents).forEach(function(item) {\n                                item.filename = self.escapeHtml(item.filename);\n                                item.document_type = self.escapeHtml(item.document_type);\n                                item.uploaded_at = self.modules.tnthDates.formatDateString(item.uploaded_at, \"iso\");\n                                item.actions = `<a title=\"${i18next.t(\"Download\")}\" href=\"${'/api/user/' + String(item.user_id) + '/user_documents/' + String(item.id)}\"><i class=\"fa fa-download\"></i></a>`;\n                                fData.push(item);\n                            });\n                            self.patientReport.data = fData;\n                            $(\"#profilePatientReportTable\").bootstrapTable(self.setBootstrapTableConfig({\n                                data: fData,\n                                classes: \"table table-responsive profile-patient-reports\",\n                                sortName: \"uploaded_at\",\n                                sortOrder: \"desc\",\n                                toolbar: \"#prTableToolBar\",\n                                columns: [{field: \"contributor\", title: i18next.t(\"Type\"), searchable: true, sortable: true},\n                                    {field: \"filename\", title: i18next.t(\"Report Name\"), searchable: true, sortable: true},\n                                    {field: \"uploaded_at\", title: i18next.t(\"Generated (GMT)\"), sortable: true, searchable: true, width: \"20%\"},\n                                    {field: \"document_type\", title: i18next.t(\"Document Type\"), sortable: true, visible: false},\n                                    {field: \"actions\", title: i18next.t(\"Download\"), sortable: false, searchable: false, visible: true, class: \"text-center\"}]\n                            }));\n                        } else {\n                            $(\"#patientReportErrorMessage\").text(i18next.t(\"No reports available.\")).removeClass(\"error-message\");\n                        }\n\n                    } else {\n                        $(\"#profilePatientReportTable\").closest(\"div.profile-item-container\").hide();\n                        $(\"#patientReportErrorMessage\").text(i18next.t(\"Problem retrieving reports from server.\")).addClass(\"error-message\");\n                    }\n                });\n            },\n            initAssessmentListSection: function() {\n                var self = this;\n                $(\"#assessmentListMessage\").text(i18next.t(\"No questionnaire data found.\"));\n                self.modules.tnthAjax.assessmentList(self.subjectId, {useWorker: true}, function(data) {\n                    if (data.error) {\n                        self.assessment.assessmentListError = i18next.t(\"Problem retrieving session data from server.\");\n                        return false;\n                    }\n                    self.assessment.assessmentListError = \"\";\n                    var sessionUserId = $(\"#_session_user_id\").val();\n                    var entries = data.entry ? data.entry : null;\n                    if (!entries || entries.length === 0) {\n                        return false;\n                    }\n                    entries.forEach(function(entry, index) {\n                        var reference = entry.questionnaire.reference;\n                        var arrRefs = String(reference).split(\"/\");\n                        var instrumentId = arrRefs.length > 0 ? arrRefs[arrRefs.length - 1] : \"\";\n                        if (!instrumentId) {\n                            return false;\n                        }\n                        var authoredDate = String(entry.authored);\n                        var reportLink = \"/patients/session-report/\" + sessionUserId + \"/\" + instrumentId + \"/\" + authoredDate;\n                        self.assessment.assessmentListItems.push({\n                            title: i18next.t(\"Click to view report\"),\n                            link: reportLink,\n                            display: i18next.t(entry.questionnaire.display),\n                            status: i18next.t(entry.status),\n                            class: (index % 2 !== 0 ? \"class='odd'\" : \"class='even'\"),\n                            date: self.modules.tnthDates.formatDateString(entry.authored, \"iso\")\n                        });\n                    });\n                });\n            },\n            handleSelectedState: function(event) {\n                var newValue = event.target.value;\n                this.orgsSelector.selectedState = newValue;\n            },\n            isAcceptOnNextOrg: function(orgName) {\n                if (!this.settings) {\n                    return false;\n                }\n                return orgName === this.settings.ACCEPT_TERMS_ON_NEXT_ORG;\n            },\n            initOrgsStateSelectorSection: function() {\n\n                var self = this, orgTool = this.getOrgTool(), subjectId = this.subjectId;\n                var stateDict={AL: i18next.t(\"Alabama\"),AK: i18next.t(\"Alaska\"), AS: i18next.t(\"American Samoa\"),AZ: i18next.t(\"Arizona\"),AR:i18next.t(\"Arkansas\"),CA: i18next.t(\"California\"),CO:i18next.t(\"Colorado\"),CT:i18next.t(\"Connecticut\"),DE:i18next.t(\"Delaware\"),DC:i18next.t(\"District Of Columbia\"),FM: i18next.t(\"Federated States Of Micronesia\"),FL:i18next.t(\"Florida\"),GA:i18next.t(\"Georgia\"),GU:i18next.t(\"Guam\"),HI:i18next.t(\"Hawaii\"),ID:i18next.t(\"Idaho\"),IL:i18next.t(\"Illinois\"),IN:i18next.t(\"Indiana\"),IA:i18next.t(\"Iowa\"),KS:i18next.t(\"Kansas\"),KY:i18next.t(\"Kentucky\"),LA:i18next.t(\"Louisiana\"),ME:i18next.t(\"Maine\"),MH:i18next.t(\"Marshall Islands\"),MD:i18next.t(\"Maryland\"),MA:i18next.t(\"Massachusetts\"),MI:i18next.t(\"Michigan\"),MN:i18next.t(\"Minnesota\"),MS:i18next.t(\"Mississippi\"),MO:i18next.t(\"Missouri\"),MT:i18next.t(\"Montana\"),NE: i18next.t(\"Nebraska\"),NV:i18next.t(\"Nevada\"),NH:i18next.t(\"New Hampshire\"),NJ:i18next.t(\"New Jersey\"),NM:i18next.t(\"New Mexico\"),NY:i18next.t(\"New York\"),NC:i18next.t(\"North Carolina\"),ND:i18next.t(\"North Dakota\"),MP:i18next.t(\"Northern Mariana Islands\"),OH:i18next.t(\"Ohio\"),OK:i18next.t(\"Oklahoma\"),OR:i18next.t(\"Oregon\"),PW:i18next.t(\"Palau\"),PA:i18next.t(\"Pennsylvania\"),PR:i18next.t(\"Puerto Rico\"),RI:i18next.t(\"Rhode Island\"),SC:i18next.t(\"South Carolina\"),SD:i18next.t(\"South Dakota\"),TN:i18next.t(\"Tennessee\"),TX:i18next.t(\"Texas\"),UT:i18next.t(\"Utah\"),VT:i18next.t(\"Vermont\"),VI:i18next.t(\"Virgin Islands\"),VA:i18next.t(\"Virginia\"),WA:i18next.t(\"Washington\"),WV:i18next.t(\"West Virginia\"),WI:i18next.t(\"Wisconsin\"),WY:i18next.t(\"Wyoming\")};\n                var getParentState = (o, states) => {\n                    if (!o) {\n                        return \"\";\n                    }\n                    var s = \"\", found = false;\n                    for (var state in states) {\n                        if (!found) {\n                            (states[state]).forEach(function(i) {\n                                if (String(i) === String(o)) {\n                                    s = state;\n                                    found = true;\n                                }\n                            });\n                        }\n                    }\n                    return s;\n                };\n                $(\"#stateSelector\").on(\"change\", function() {\n                    let selectedState = $(this).find(\"option:selected\"),\n                        container = $(\"#\" + selectedState.val() + \"_container\");\n                    let defaultPrompt = i18next.t(\"What is your main clinic for prostate cancer care\");\n                    $(\"#userOrgsInfo\").hide();\n                    if (selectedState.val() !== \"\") {\n                        if (selectedState.val() === \"none\") {\n                            $(\".state-container, .noOrg-container\").hide();\n                            $(\".clinic-prompt\").text(\"\").hide();\n                            $(\"#noOrgs\").prop(\"checked\", true).trigger(\"click\");\n                            //send of ajax to update org to 0 here\n                        } else {\n                            if (container.length > 0) {\n                                $(\".state-container\").hide();\n                                $(\".clinic-prompt\").text(defaultPrompt + \" in \" + selectedState.text() + \"?\").show();\n                                $(\".noOrg-container\").show();\n                                $(\"#noOrgs\").prop(\"checked\", false);\n                            } else {\n                                $(\".state-container, .clinic-prompt, .noOrg-container\").hide();\n                                $(\"#userOrgsInfo\").show();\n                            }\n                        }\n                    } else {\n                        $(\".state-container, .noOrg-container\").hide();\n                        $(\".clinic-prompt\").text(\"\").hide();\n                    }\n                });\n\n                var orgsList = this.orgsList, states = {}, contentHTML = \"\";\n                /**** draw state select element first to gather all states - assign orgs to each state in array ***/\n                (self.orgsData).forEach(function(item) {\n                    let __state = \"\";\n                    if (!item.identifier) { return false; }\n                    (item.identifier).forEach(function(region) {\n                        if (String(region.system) === String(self.modules.SYSTEM_IDENTIFIER_ENUM.practice_region) && region.value) {\n                            __state = (region.value).split(\":\")[1];\n                            __state = (region.value).split(\":\")[1];\n                            if (!states.hasOwnProperty(__state)) {\n                                states[__state] = [item.id];\n                                $(\"#userOrgs .main-state-container\").prepend(\"<div id='\" + __state + \"_container' state='\" + __state + \"' class='state-container'></div>\");\n                            } else {\n                                (states[__state]).push(item.id);\n                            }\n                            if ($(\"#stateSelector option[value='\" + __state + \"']\").length === 0) {\n                                $(\"#stateSelector\").append(\"<option value='\" + __state + \"'>\" + stateDict[__state] + \"</option>\");\n                            }\n                            orgsList[item.id].state = __state; //assign state for each item\n                        }\n                    });\n                });\n\n                /*\n                 * If an organization is a top level org and has child orgs, we render legend for it.  This will prevent the organization from being selected by the user.\n                 * Note: a hidden input field is rendered for the organization so it can still be referenced by the child orgs if necessary.\n                 */\n                var parentOrgs = $.grep(this.orgsData, function(item) {\n                    return parseInt(item.id) !== 0 && !item.partOf;\n                });\n\n                parentOrgs = parentOrgs.sort(function(a, b) { //sort parent orgs so ones with children displayed first\n                    var oo_1 = orgsList[a.id];\n                    var oo_2 = orgsList[b.id];\n                    if (oo_1 && oo_2) {\n                        if (oo_1.children.length > 0 && oo_2.children.length > 0) {\n                            if (a.name < b.name) {\n                                return -1;\n                            }\n                            if (a.name > b.name) {\n                                return 1;\n                            }\n                            return 0;\n                        } else if (oo_1.children.length > 0 && oo_2.children.length === 0) {\n                            return -1;\n                        } else if (oo_2.children.length > 0 && oo_1.children.length === 0) {\n                            return 1;\n                        } else {\n                            if (a.name < b.name) {\n                                return -1;\n                            }\n                            if (a.name > b.name) {\n                                return 1;\n                            }\n                            return 0;\n                        }\n                    } else {\n                        return 0;\n                    }\n                });\n                parentOrgs.forEach(function(item) {\n                    var state = orgsList[item.id].state;\n                    if ($(\"#\" + state + \"_container\").length > 0) {\n                        var oo = orgsList[item.id];\n                        if (!self.isAcceptOnNextOrg(item.name) && oo.children.length > 0) {\n                            contentHTML = `<legend orgId=\"${item.id}\">${i18next.t(item.name)}</legend><input class=\"tnth-hide\" type=\"checkbox\" name=\"organization\" parent_org=\"true\" data-org-name=\"${item.name}\"  id=\"${item.id}_org\" value=\"${item.id}\" />`;\n                        } else { //also need to check for top level orgs that do not have children and render those\n                            contentHTML = `<div class=\"radio parent-singleton\"><label><input class=\"clinic\" type=\"radio\" id=\"${item.id}_org\" value=\"${item.id}\" state=\"${state}\" name=\"organization\" data-parent-name=\"${item.name}\" data-parent-id=\"${item.id}\">${i18next.t(item.name)}</label></div>`;\n                        }\n                        $(\"#\" + state + \"_container\").append(contentHTML);\n                    }\n                });\n\n                var childOrgs = $.grep(this.orgsData, function(item) { //draw input element(s) that belongs to each state based on parent organization id\n                    return parseInt(item.id) !== 0 && item.partOf;\n                });\n\n                childOrgs = childOrgs.sort(function(a, b) { //// sort child clinics in alphabetical order\n                    if (a.name < b.name) {\n                        return 1;\n                    }\n                    if (a.name > b.name) {\n                        return -1;\n                    }\n                    return 0;\n                });\n\n                childOrgs.forEach(function(item) {\n                    var parentId = (item.partOf.reference).split(\"/\")[2];\n                    if (parentId) {\n                        if (self.isAcceptOnNextOrg(orgTool.getOrgName(parentId))) {\n                            return true;\n                        }\n                        var parentState = getParentState(parentId, states);\n                        contentHTML = `<div class=\"radio\"><label class=\"indent\"><input class=\"clinic\" type=\"radio\" id=\"${item.id}_org\" value=\"${item.id}\" state=\"${parentState}\" name=\"organization\" data-parent-name=\"${item.name}\" data-parent-id=\"${parentId}\">${i18next.t(item.name)}</label></div>`;\n                        if ($(\"#\" + parentState + \"_container legend[orgId='\" + parentId + \"']\").length > 0) {\n                            $(\"#\" + parentState + \"_container legend[orgId='\" + parentId + \"']\").after(contentHTML);\n                        } else {\n                            $(\"#\" + parentState + \"_container\").append(contentHTML);\n                        }\n                    }\n                });\n\n                //var selectOptions = $(\"#stateSelector\").sortOptions();\n                var selectOptions = $(\"#stateSelector option\");\n                if (selectOptions.length > 0) {\n                    var selectSortedOptions = $(\"#stateSelector\").sortOptions();\n                    if (selectSortedOptions && selectSortedOptions.length > 0) {\n                        $(\"#stateSelector\").empty().append(selectOptions)\n                        .append(`<option value=\"none\">${i18next.t(\"Other\")}</option>`)\n                        .prepend(`<option value=\"\" selected>${i18next.t(\"Select\")}</option>`)\n                        .val(\"\");\n                    }\n                    $(\".state-container, .clinic-prompt\").hide();\n                    setTimeout(function() { //case of pre-selected clinic, need to check if any clinic has prechecked\n                        var o = $(\"#userOrgs input[name='organization']:checked\");\n                        if (o.length > 0 && parseInt(o.val()) !== 0) {\n                            o.closest(\".state-container\").show();\n                            $(\".clinic-prompt\").show();\n                        }\n                    }, 150);\n                    $(\"#userOrgs input[name='organization']\").each(function() {\n                        if (parseInt($(this).val()) !== 0) {\n                            self.getDefaultModal(this);\n                        }\n                    });\n                    orgTool.onLoaded(subjectId, false);\n                    self.handleOrgsEvent();\n                    self.setOrgsVis();\n                } else { // if no states found, then need to draw the orgs UI\n                    $(\"#userOrgs .selector-show\").hide();\n                    orgTool.onLoaded(subjectId, true);\n                    self.handleOrgsEvent();\n                    self.setOrgsVis(function() {\n                        orgTool.filterOrgs(orgTool.getHereBelowOrgs());\n                        orgTool.morphPatientOrgs();\n                        $(\".noOrg-container, .noOrg-container *\").show();\n                    });\n                }\n                if ($(\"#mainDiv.profile\").length > 0) {\n                    self.modules.tnthAjax.getConsent(subjectId, {useWorker: true}, function(data) {\n                        self.getConsentList(data);\n                    });\n                }\n                $(\"#clinics\").attr(\"loaded\", true);\n\n            },\n            initDefaultOrgsSection: function() {\n                var subjectId = this.subjectId, orgTool = this.getOrgTool(), self = this;\n                orgTool.onLoaded(subjectId, true);\n                this.setOrgsVis(\n                    function() {\n                        if ((typeof leafOrgs !== \"undefined\") && leafOrgs) { /*global leafOrgs*/\n                            orgTool.filterOrgs(leafOrgs);\n                        }\n                        if ($(\"#requireMorph\").val()) {\n                            orgTool.morphPatientOrgs();\n                        }\n                        self.handleOrgsEvent();\n                        self.modules.tnthAjax.getConsent(subjectId, {useWorker: true}, function(data) {\n                            self.getConsentList(data);\n                        });\n                        $(\"#clinics\").attr(\"loaded\", true);\n                    });\n            },\n            setOrgsVis: function(callback) {\n                callback = callback || function() {};\n                var data = this.demo.data ? this.demo.data : null;\n                if (!data || ! data.careProvider) { callback(); return false;}\n                for (var i = 0; i < data.careProvider.length; i++) {\n                    var val = data.careProvider[i];\n                    var orgID = val.reference.split(\"/\").pop();\n                    if (parseInt(orgID) === 0) {\n                        $(\"#userOrgs #noOrgs\").prop(\"checked\", true);\n                        if ($(\"#stateSelector\").length > 0) {\n                            $(\"#stateSelector\").find(\"option[value='none']\").prop(\"selected\", true).val(\"none\");\n                        }\n                    } else {\n                        var ckOrg = $(\"#userOrgs input.clinic[value=\" + orgID + \"]\");\n                        if ($(\".state-container\").length > 0) {\n                            if (ckOrg.length > 0) {\n                                ckOrg.prop(\"checked\", true);\n                                var state = ckOrg.attr(\"state\");\n                                if (state) {\n                                    $(\"#stateSelector\").find(\"option[value='\" + state + \"']\").prop(\"selected\", true).val(i18next.t(state));\n                                }\n                                $(\"#clinics .state-selector-container\").show();\n                                $(\"#stateSelector\").trigger(\"change\");\n                            }\n                            $(\".noOrg-container\").show();\n                        } else {\n                            if (ckOrg.length > 0) {\n                                ckOrg.prop(\"checked\", true);\n                            } else {\n                                var topLevelOrg = $(\"#fillOrgs\").find(\"legend[orgid='\" + orgID + \"']\");\n                                if (topLevelOrg.length > 0) {\n                                    topLevelOrg.attr(\"data-checked\", \"true\");\n                                }\n                            }\n                        }\n                    }\n                }\n                callback(data);\n            },\n            handleOrgsEvent: function() {\n                var self = this, orgTool = this.getOrgTool();\n                $(\"#userOrgs input[name='organization']\").each(function() {\n                    $(this).attr(\"data-save-container-id\", \"userOrgs\");\n                    $(this).on(\"click\", function() {\n                        var userId = self.subjectId, parentOrg = orgTool.getElementParentOrg(this);\n                        var orgsElements = $(\"#userOrgs input[name='organization']\").not(\"[id='noOrgs']\");\n                        if ($(this).prop(\"checked\")) {\n                            if ($(this).attr(\"id\") !== \"noOrgs\") {\n                                $(\"#noOrgs\").prop(\"checked\", false);\n                            } else {\n                                orgsElements.prop(\"checked\", false);\n                            }\n                        }\n                        if (sessionStorage.getItem(\"noOrgModalViewed\")) {\n                            sessionStorage.removeItem(\"noOrgModalViewed\");\n                        }\n                        $(\"#userOrgs .help-block\").removeClass(\"error-message\").text(\"\");\n\n                        if ($(this).attr(\"id\") !== \"noOrgs\" && $(\"#fillOrgs\").attr(\"patient_view\")) {\n                            if (self.modules.tnthAjax.hasConsent(userId, parentOrg)) {\n                                self.updateOrgs($(\"#clinics\"), true);\n                            } else {\n                                var __modal = self.getConsentModal(parentOrg);\n                                if (__modal && __modal.length > 0) {\n                                    setTimeout(function() { __modal.modal(\"show\"); }, 50);\n                                } else {\n                                    self.updateOrgs($(\"#clinics\"), true);\n                                    setTimeout(function() { self.setDefaultConsent(userId, parentOrg);}, 500);\n                                }\n                            }\n                        } else {\n                            self.updateOrgs($(\"#clinics\"),true);\n                            var thisElement = $(this);\n                            setTimeout(function() {\n                                self.handleConsent(thisElement);\n                            }, 500);\n                            self.reloadConsentList(userId);\n                        }\n                        self.handlePcaLocalized();\n                        if ($(\"#locale\").length > 0) {\n                            self.modules.tnthAjax.getLocale(userId);\n                        }\n                        if ($(\"#profileassessmentSendEmailContainer\").length > 0) {\n                            setTimeout(function() {\n                                self.reloadSendPatientEmailForm(self.subjectId);\n                            }, 150);\n                        }\n                    });\n                });\n            },\n            getNoOrgDisplay: function() {\n                return \"<p class='text-muted'>\"+this.modules.i18next.t(\"No affiliated clinic\")+\"</p>\";\n            },\n            getOrgsDisplay: function() {\n                if (!this.demo.data.careProvider || this.demo.data.careProvider.length === 0) {\n                    return this.getNoOrgDisplay();\n                }\n                /* example return from api demographics: [{ display: Duke, reference: \"api/organization/1301\"}, {\"display\":\"Arvin George\",\"reference\":\"api/practitioner/1851648521?system=http://hl7.org/fhir/sid/us-npi\"}]\n                 * NOTE: need to exclude displays other than organization */\n                var self = this;\n                var arrDisplay = this.demo.data.careProvider.map(function(item) {\n                    if (String(item.reference) === \"api/organization/0\") { //organization id = 0\n                        return self.getNoOrgDisplay();\n                    }\n                    return (item.reference.match(/^api\\/organization/gi) ? \"<p>\"+item.display+\"</p>\": \"\");\n                });\n\n                return arrDisplay.join(\"\");\n            },\n            updateOrgs: function(targetField, sync) {\n                var demoArray = {\"resourceType\": \"Patient\"}, preselectClinic = $(\"#preselectClinic\").val(), userId=this.subjectId;\n                var self = this;\n                if (preselectClinic) {\n                    var parentOrg = $(\"#userOrgs input[name='organization'][value='\" + preselectClinic + \"']\").attr(\"data-parent-id\") || preselectClinic;\n                    if (self.modules.tnthAjax.hasConsent(userId, parentOrg)) {\n                        demoArray.careProvider = [{reference: \"api/organization/\" + preselectClinic}];\n                    }\n                } else {\n                    var orgIDs = $(\"#userOrgs input[name='organization']:checked\").map(function() {\n                        return {reference: \"api/organization/\" + $(this).val()};\n                    }).get();\n                    if (orgIDs && orgIDs.length > 0) {\n                        demoArray.careProvider = orgIDs;\n                    }\n                    /**** dealing with the scenario where user can be affiliated with top level org e.g. TrueNTH Global Registry, IRONMAN, via direct database addition **/\n                    $(\"#fillOrgs legend[data-checked]\").each(function() {\n                        var tOrg = $(this).attr(\"orgid\");\n                        if (tOrg) {\n                            demoArray.careProvider = demoArray.careProvider || [];\n                            demoArray.careProvider.push({reference: \"api/organization/\" + tOrg});\n                        }\n                    });\n                }\n                if ($(\"#aboutForm\").length === 0 && (!demoArray.careProvider)) { //don't update org to none if there are top level org affiliation above\n                    demoArray.careProvider = [{reference: \"api/organization/\" + 0}];\n                }\n                this.modules.tnthAjax.putDemo(userId, demoArray, targetField, sync, this.setDemoData);\n            },\n            getConsentModal: function(parentOrg) {\n                var orgTool = this.getOrgTool();\n                parentOrg = parentOrg || orgTool.getElementParentOrg(orgTool.getSelectedOrg());\n                if (!parentOrg) { return false; }\n                var __modal = $(\"#\" + parentOrg + \"_consentModal\");\n                if (__modal.length > 0) {\n                    return __modal;\n                } else {\n                    var __defaultModal = this.getDefaultModal(orgTool.getSelectedOrg());\n                    if (__defaultModal && __defaultModal.length > 0) {\n                        return __defaultModal;\n                    }\n                }\n                return false;\n            },\n            \"getDefaultAgreementUrl\": function(orgId) {\n                var stockConsentUrl = $(\"#stock_consent_url\").val(), agreementUrl = \"\", orgElement = $(\"#\" + orgId + \"_org\");\n                if (stockConsentUrl && orgElement.length > 0) {\n                    var orgName = orgElement.attr(\"data-parent-name\") || orgElement.attr(\"data-org-name\");\n                    agreementUrl = stockConsentUrl.replace(\"placeholder\", encodeURIComponent(orgName));\n                }\n                return agreementUrl;\n            },\n            \"setDefaultConsent\": function(userId, orgId) {\n                if (!userId) { return false;}\n                var agreementUrl = this.getDefaultAgreementUrl(orgId), self = this;\n                if (!agreementUrl) {\n                    $($(\"#consentContainer .error-message\").get(0)).text(i18next.t(\"Unable to set default consent agreement\"));\n                    return false;\n                }\n                var params = self.modules.tnthAjax.consentParams;\n                params.org = orgId;\n                params.agreementUrl = agreementUrl;\n                self.modules.tnthAjax.setConsent(userId, params, \"default\");\n                setTimeout(function() { //need to remove all other consents associated w un-selected org(s)\n                    self.removeObsoleteConsent();\n                }, 100);\n                self.reloadConsentList(userId);\n                $($(\"#consentContainer .error-message\").get(0)).text(\"\");\n            },\n            removeObsoleteConsent: function() {\n                var userId = this.subjectId, co = [], OT = this.getOrgTool();\n                $(\"#userOrgs input[name='organization']\").each(function() {\n                    if ($(this).is(\":checked\")) {\n                        co.push($(this).val());\n                        var po = OT.getElementParentOrg(this);\n                        if (po) { co.push(po);}\n                    }\n                });\n                this.modules.tnthAjax.deleteConsent(userId, {org: \"all\", exclude: co.join(\",\")}); //exclude currently selected orgs\n            },\n            \"handleConsent\": function(obj) {\n                var self = this, OT = this.getOrgTool(), userId = this.subjectId, cto = this.isConsentWithTopLevelOrg(), tnthAjax = self.modules.tnthAjax;\n                $(obj).each(function() {\n                    var parentOrg = OT.getElementParentOrg(this), orgId = $(this).val();\n                    if ($(this).prop(\"checked\")) {\n                        if ($(this).attr(\"id\") !== \"noOrgs\") {\n                            var agreementUrl = $(\"#\" + parentOrg + \"_agreement_url\").val();\n                            if (String(agreementUrl) !== \"\") {\n                                var params = self.CONSENT_ENUM.consented;\n                                params.org = cto ? parentOrg : orgId;\n                                params.agreementUrl = agreementUrl;\n                                setTimeout(function() {\n                                    tnthAjax.setConsent(userId, params, \"all\", true, function() {\n                                        self.removeObsoleteConsent();\n                                    });\n                                }, 350);\n                            } else {\n                                self.setDefaultConsent(userId, parentOrg);\n                            }\n                        } else { //remove all valid consent if no org is selected\n                            setTimeout(function() { tnthAjax.deleteConsent(userId, {\"org\": \"all\"});}, 350);\n                        }\n                    } else {\n                        if (cto) {\n                            var childOrgs = $(\"#userOrgs input[data-parent-id='\" + parentOrg + \"']\");\n                            if ($(\"#fillOrgs\").attr(\"patient_view\")) {\n                                childOrgs = $(\"#userOrgs div.org-container[data-parent-id='\" + parentOrg + \"']\").find(\"input[name='organization']\");\n                            }\n                            var allUnchecked = !childOrgs.is(\":checked\");\n                            if (allUnchecked) {\n                                setTimeout(function() { tnthAjax.deleteConsent(userId, {\"org\": parentOrg});}, 350);\n                            }\n                        } else {\n                            setTimeout(function() { tnthAjax.deleteConsent(userId, {\"org\": orgId});}, 350);\n                        }\n                    }\n                });\n            },\n            getDefaultModal: function(o) {\n                if (!o) { return false;}\n                var orgTool = this.getOrgTool();\n                var orgId = orgTool.getElementParentOrg(o), orgModalId = orgId + \"_defaultConsentModal\", orgElement = $(\"#\"+orgModalId);\n                if (orgElement.length > 0) { return orgElement; }\n                var orgsList = orgTool.getOrgsList(), orgItem = orgsList.hasOwnProperty(orgId) ? orgsList[orgId]: null,\n                    orgName = (orgItem && orgItem.shortname) ? orgItem.shortname : ($(o).attr(\"data-parent-name\") || $(o).closest(\"label\").text());\n                var title = i18next.t(\"Consent to share information\");\n                var consentText = i18next.t(\"I consent to sharing information with <span class='consent-clinic-name'>{orgName}</span>.\".replace(\"{orgName}\", orgName));\n                var orgModalElement = $(\"#defaultConsentModal\").clone(true);\n                var tempHTML = orgModalElement.html();\n                tempHTML = tempHTML.replace(/\\{orgId\\}/g, orgId)\n                    .replace(/\\{close\\}/g, i18next.t(\"Close\"))\n                    .replace(/\\{yes\\}/g, i18next.t(\"Yes\"))\n                    .replace(/\\{no\\}/g, i18next.t(\"No\"))\n                    .replace(/\\{title\\}/g, title)\n                    .replace(/\\{consentText\\}/g, consentText);\n                orgModalElement.html(tempHTML);\n                orgModalElement.attr(\"id\", orgModalId);\n                $(\"#defaultConsentContainer\").append(orgModalElement);\n                return orgElement;\n            },\n            initConsentSection: function() {\n                var __self = this, orgTool = this.getOrgTool(), modalElements = $(\"#consentContainer .modal, #defaultConsentContainer .modal\");\n                var closeButtons = modalElements.find(\"button.btn-consent-close, button[data-dismiss]\");\n                $(\"#consentHistoryModal\").modal({\"show\": false});\n                modalElements.each(function() {\n                    var agreemntUrl = $(this).find(\".agreement-url\").val();\n                    if (/stock\\-org\\-consent/.test(agreemntUrl)) {\n                        $(this).find(\".terms-wrapper\").hide();\n                    }\n                });\n                modalElements.find(\"input[name='toConsent']\").off(\"click\").on(\"click\", function(e) {\n                    e.stopPropagation();\n                    closeButtons.attr(\"disabled\", true);\n                    var orgId = $(this).attr(\"data-org\"), userId = __self.subjectId;\n                    var postUpdate = function(orgId, errorMessage) {\n                        if (errorMessage) {\n                            $(\"#\"+orgId+\"_consentAgreementMessage\").html(errorMessage);\n                        } else {\n                            $(\"#\"+orgId+\"_consentAgreementMessage\").html(\"\");\n                            setTimeout(function() { modalElements.modal(\"hide\"); __self.removeObsoleteConsent(); }, 250);\n                            setTimeout(function() { __self.reloadConsentList(userId);}, 500);\n                        }\n                        $(\"#\" + orgId + \"_loader.loading-message-indicator\").hide();\n                        closeButtons.attr(\"disabled\", false);\n                    };\n                    $(\"#\" + orgId + \"_loader.loading-message-indicator\").show();\n                    if ($(this).val() === \"yes\") {\n                        var params = __self.CONSENT_ENUM.consented;\n                        params.org = orgId;\n                        params.agreementUrl = $(\"#\" + orgId + \"_agreement_url\").val() || __self.getDefaultAgreementUrl(orgId);\n                        setTimeout(function() {__self.modules.tnthAjax.setConsent(userId, params,\"\",false, function(data) {\n                            postUpdate(orgId, data.error);\n                        });}, 50);\n                    } else {\n                        __self.modules.tnthAjax.deleteConsent(userId, {\"org\": orgId});\n                        postUpdate(orgId);\n                    }\n                });\n\n                closeButtons.off(\"click\").on(\"click\", function(e) {\n                    e.preventDefault();\n                    e.stopPropagation();\n                    setTimeout(function() { location.reload(); }, 10);\n                });\n\n                modalElements.each(function() {\n                    $(this).on(\"hidden.bs.modal\", function() {\n                        if ($(this).find(\"input[name='toConsent']:checked\").length > 0) {\n                            $(\"#userOrgs input[name='organization']\").each(function() {\n                                $(this).removeAttr(\"data-require-validate\");\n                            });\n                            __self.updateOrgs($(\"#clinics\"), true);\n                        }\n                    });\n                    $(this).on(\"show.bs.modal\", function() {\n                        var checkedOrg = $(\"#userOrgs input[name='organization']:checked\");\n                        var shortName = checkedOrg.attr(\"data-short-name\") || checkedOrg.attr(\"data-org-name\");\n                        if (!shortName) {\n                            shortName = orgTool.getShortName(checkedOrg.val());\n                        }\n                        if (shortName) {\n                            $(this).find(\".consent-clinic-name\").text(i18next.t(shortName));\n                        }\n                        $(\"#consentContainer input[name='toConsent']\").each(function() {\n                            $(this).prop(\"checked\", false);\n                        });\n                        var o = $(this);\n                        $(this).find(\"button.btn-consent-close, button[data-dismiss]\").attr(\"disabled\", false).show();\n                        $(this).find(\".content-loading-message-indicator\").fadeOut(50, function() {\n                            o.find(\".main-content\").removeClass(\"tnth-hide\");\n                        });\n                    });\n                });\n            },\n            handlePcaLocalized: function() {\n                if (!this.subjectId || !this.isSubjectPatient()) {\n                    return false;\n                }\n                var parentOrg = this.orgTool.getSelectedOrgTopLevelParentOrg();\n                if (!this.settings.LOCALIZED_AFFILIATE_ORG) {\n                    return false; //don't set at all if config is not present, i.e. Truenth does not have this config\n                }\n                this.modules.tnthAjax.postClinical(this.subjectId,\"pca_localized\", this.isLocalizedAffiliatedOrg());\n\n            },\n            isLocalizedAffiliatedOrg: function() {\n                var parentOrg = this.orgTool.getSelectedOrgTopLevelParentOrg();\n                if (!parentOrg) {\n                    return false;\n                }\n                return this.orgTool.getOrgName(parentOrg) === this.settings.LOCALIZED_AFFILIATE_ORG;\n            },\n            updateClinicalSection: function(data) {\n                if (!data) { return false; }\n                var self = this;\n                var sortedArray = data.sort(function(a, b) {\n                    return b.resource.id - a.resource.id;\n                });\n                for (var i = 0; i < sortedArray.length; i++) {\n                    var val = sortedArray[i];\n                    var clinicalItem = String(val.resource.code.coding[0].display);\n                    var clinicalValue = val.resource.valueQuantity.value;\n                    var clinicalUnit = val.resource.valueQuantity.units;\n                    var truesyValue = parseInt(clinicalValue) === 1 && !clinicalUnit;\n                    var falsyValue = parseInt(clinicalValue) === 0 && !clinicalUnit;\n                    var status = val.resource.status;\n                    if (clinicalItem === \"PCa diagnosis\") {\n                        clinicalItem = \"pca_diag\";\n                    } else if (clinicalItem === \"PCa localized diagnosis\") {\n                        clinicalItem = \"pca_localized\";\n                    }\n                    var ci = $('div[data-topic=\"' + clinicalItem + '\"]');\n                    if (ci.length > 0) {\n                        ci.fadeIn();\n                    }\n                    var $radios = $('input:radio[name=\"' + clinicalItem + '\"]');\n                    if ($radios.length > 0) {\n                        if (!$radios.is(\":checked\")) {\n                            if (String(status) === \"unknown\") {\n                                $radios.filter('[data-status=\"unknown\"]').prop(\"checked\", true);\n                            } else {\n                                $radios.filter(\"[value=\" + clinicalValue + \"]\").not(\"[data-status='unknown']\").prop(\"checked\", true);\n                            }\n                            if (truesyValue) {\n                                $radios.filter(\"[value=true]\").prop(\"checked\", true);\n                            } else if (falsyValue) {\n                                $radios.filter(\"[value=false]\").prop(\"checked\", true);\n                            }\n                            if (clinicalItem === \"biopsy\") {\n                                if (String(clinicalValue) === \"true\" || truesyValue) {\n                                    if (val.resource.issued) {\n                                        var dString = self.modules.tnthDates.formatDateString(val.resource.issued, \"iso-short\");\n                                        var dArray = dString.split(\"-\");\n                                        $(\"#biopsyDate\").val(dString);\n                                        $(\"#biopsy_year\").val(dArray[0]);\n                                        $(\"#biopsy_month\").val(dArray[1]);\n                                        $(\"#biopsy_day\").val(dArray[2]);\n                                        $(\"#biopsyDateContainer\").show();\n                                    }\n                                } else {\n                                    $(\"#biopsyDate\").val(\"\");\n                                    $(\"#biopsyDateContainer\").hide();\n                                }\n                            }\n                            if (String(clinicalValue) === \"true\" || truesyValue) {\n                                $radios.parents(\".pat-q\").next().fadeIn(150);\n                            }\n                        }\n                    }\n                }\n            },\n            updateTreatment: function(data) {\n                var treatmentCode = this.modules.tnthAjax.hasTreatment(data);\n                if (treatmentCode) {\n                    var hasCancerTreatment = String(treatmentCode) === String(this.modules.SYSTEM_IDENTIFIER_ENUM.CANCER_TREATMENT_CODE);\n                    $(\"#tx_yes\").prop(\"checked\", hasCancerTreatment);\n                    $(\"#tx_no\").prop(\"checked\", !hasCancerTreatment);\n                }\n            },\n            onBeforeInitClinicalQuestionsSection: function() {\n                if (this.mode !== \"profile\") { return false; }\n                if (!this.isProxy()) {\n                    $(\"#clinicalQuestionsContainer .profile-item-edit-btn\").removeClass(\"tnth-hide\");\n                }\n                $(\"#patientQ\").show();\n                $(\"#patTx\").remove(); //don't show treatment\n                $(\"#patientQ hr\").hide();\n                $(\".pat-q input:radio\").off(\"click\").on(\"click\", function() {\n                    var thisItem = $(this), toCall = thisItem.attr(\"name\"), toSend = thisItem.val(); // Get value from div - either true or false\n                    if (String(toSend) === \"true\" || String(toCall) === \"pca_localized\") {\n                        thisItem.parents(\".pat-q\").nextAll().fadeIn();\n                    } else {\n                        thisItem.parents(\".pat-q\").nextAll().fadeOut();\n                    }\n                });\n                var diag = $(\"#pca_diag_yes\");\n                if (diag.is(\":checked\")) {\n                    diag.parents(\".pat-q\").nextAll().fadeIn();\n                } else {\n                    diag.parents(\".pat-q\").nextAll().fadeOut();\n                }\n                this.fillSectionView(\"clinical\");\n            },\n            initClinicalQuestionsSection: function() {\n                if (!this.subjectId) { return false; }\n                var self = this;\n                self.modules.tnthAjax.getTreatment(self.subjectId, {useWorker:true}, function(data) {\n                    self.updateTreatment(data);\n                    self.modules.tnthAjax.getClinical(self.subjectId,{useWorker:true, data:{patch_dstu2: true}}, function(data) {\n                        self.updateClinicalSection(data.entry);\n                        $(\"#patientQ\").attr(\"loaded\", \"true\");\n                        self.onBeforeInitClinicalQuestionsSection();\n                        $(\"#patientQ [name='biopsy']\").on(\"click\", function() {\n                            var toSend = String($(this).val()), biopsyDate = $(\"#biopsyDate\").val(), thisItem = $(this), userId = self.subjectId;\n                            var toCall = thisItem.attr(\"name\") || thisItem.attr(\"data-name\"), targetField = $(\"#patientQ\");\n                            var arrQ = [\"pca_diag\", \"pca_localized\", \"tx\"];\n                            if (toSend === \"true\") {\n                                $(\"#biopsyDateContainer\").show();\n                                $(\"#biopsyDate\").attr(\"skipped\", \"false\");\n                                arrQ.forEach(function(fieldName) {\n                                    $(\"#patientQ input[name='\" + fieldName + \"']\").attr(\"skipped\", \"false\");\n                                });\n                                if (biopsyDate) {\n                                    setTimeout(function() {\n                                        self.modules.tnthAjax.postClinical(userId, toCall, toSend, \"\", targetField, {\"issuedDate\": biopsyDate});\n                                    }, 50);\n                                } else {\n                                    $(\"#biopsy_day\").focus();\n                                }\n                            } else {\n                                $(\"#biopsyDate\").attr(\"skipped\", \"true\");\n                                $(\"#biopsyDate, #biopsy_day, #biopsy_month, #biopsy_year\").val(\"\");\n                                $(\"#biopsyDateError\").text(\"\");\n                                $(\"#biopsyDateContainer\").hide();\n                                arrQ.forEach(function(fieldName) {\n                                    var field = $(\"#patientQ input[name='\" + fieldName + \"']\");\n                                    field.prop(\"checked\", false);\n                                    field.attr(\"skipped\", \"true\");\n                                });\n                                setTimeout(function() {\n                                    self.modules.tnthAjax.postClinical(userId, toCall, \"false\", thisItem.attr(\"data-status\"), targetField);\n                                    self.modules.tnthAjax.postClinical(userId, \"pca_diag\", \"false\", \"\", targetField);\n                                    self.modules.tnthAjax.postClinical(userId, \"pca_localized\", \"false\", \"\", targetField);\n                                    self.modules.tnthAjax.deleteTreatment(userId);\n                                }, 50);\n\n                            }\n                        });\n                        self.__convertToNumericField($(\"#biopsy_day, #biopsy_year\"));\n                        $(\"#biopsy_day, #biopsy_month, #biopsy_year\").on(\"change\", function() {\n                            var d = $(\"#biopsy_day\"), m = $(\"#biopsy_month\"), y = $(\"#biopsy_year\");\n                            var isValid = self.modules.tnthDates.validateDateInputFields(m, d, y, \"biopsyDateError\");\n                            if (isValid) {\n                                $(\"#biopsyDate\").val(y.val()+\"-\"+m.val()+\"-\"+d.val());\n                                $(\"#biopsyDateError\").text(\"\").hide();\n                                $(\"#biopsy_yes\").trigger(\"click\");\n                            } else {\n                                $(\"#biopsyDate\").val(\"\");\n                            }\n                        });\n\n                        $(\"#patientQ input[name='tx']\").on(\"click\", function() {\n                            self.modules.tnthAjax.postTreatment(self.subjectId, (String($(this).val()) === \"true\"), \"\", $(\"#patientQ\"));\n                        });\n\n                        $(\"#patientQ input[name='pca_localized']\").on(\"click\", function() {\n                            var o = $(this);\n                            setTimeout(function() {\n                                self.modules.tnthAjax.postClinical(self.subjectId, o.attr(\"name\"), o.val(), o.attr(\"data-status\"), $(\"#patientQ\"));\n                            }, 50);\n                        });\n\n                        $(\"#patientQ input[name='pca_diag']\").on(\"click\", function() {\n                            var toSend = String($(this).val()), userId = self.subjectId, o = $(this), targetField = $(\"#patientQ\");\n                            setTimeout(function() {\n                                self.modules.tnthAjax.postClinical(userId, o.attr(\"name\"), toSend, o.attr(\"data-status\"), targetField);\n                            }, 50);\n                            if (toSend !== \"true\") {\n                                [\"pca_localized\", \"tx\"].forEach(function(fieldName) {\n                                    var field = $(\"#patientQ input[name='\" + fieldName + \"']\");\n                                    field.prop(\"checked\", false);\n                                    field.attr(\"skipped\", \"true\");\n                                });\n                                setTimeout(function() {\n                                    self.modules.tnthAjax.postClinical(userId, \"pca_localized\", \"false\", \"\", targetField);\n                                    self.modules.tnthAjax.deleteTreatment(userId);\n                                }, 50);\n                            }\n                        });\n                    });\n                });\n            },\n            initProcedureSection: function() {\n                ProcApp.initViaTemplate();\n            },\n            manualEntryModalVis: function(hide) {\n                if (hide) {\n                    this.manualEntry.loading = true;\n                } else {\n                    this.manualEntry.loading = false;\n                }\n            },\n            continueToAssessment: function(method, completionDate, assessment_url) {\n                if (!assessment_url) {\n                    this.manualEntry.errorMessage = i18next.t(\"The user does not have a valid assessment link.\");\n                    return false;\n                }\n                var self = this, still_needed = false, subjectId = this.subjectId;\n                this.modules.tnthAjax.getStillNeededCoreData(subjectId, true, function(data) {\n                    still_needed = data && data.still_needed && data.still_needed.length;\n                }, method);\n                if (/\\?/.test(assessment_url)) { //passing additional query params\n                    assessment_url += \"&entry_method=\" + method;\n                } else {\n                    assessment_url += \"?entry_method=\" + method;\n                }\n                if (method === \"paper\") {\n                    assessment_url += \"&authored=\" + completionDate;\n                }\n                var winLocation = assessment_url;\n                if (still_needed) {\n                    winLocation = \"/website-consent-script/\" + $(\"#manualEntrySubjectId\").val() + \"?entry_method=\" + method + \"&subject_id=\" + $(\"#manualEntrySubjectId\").val() +\n                    \"&redirect_url=\" + encodeURIComponent(assessment_url);\n                }\n                this.manualEntryModalVis(true);\n                window.location = winLocation;\n                setTimeout(function(callback) {\n                    callback = callback || function() {};\n                    if (callback) { callback(); }\n                }, 1000, self.manualEntryModalVis);\n            },\n            initCustomPatientDetailSection: function() {\n                var subjectId = this.subjectId, self = this;\n                $(window).on(\"beforeunload\", function() { //fix for safari\n                    if (navigator.userAgent.indexOf(\"Safari\") !== -1 && navigator.userAgent.indexOf(\"Chrome\") === -1) {\n                        self.manualEntry.loading = false;\n                        $(\"#manualEntryModal\").modal(\"hide\");\n                    }\n                });\n                $(\"#manualEntryModal\").on(\"show.bs.modal\", function() {\n                    self.manualEntry.initloading = true;\n                });\n                $(\"#manualEntryModal\").on(\"shown.bs.modal\", function() {\n                    self.manualEntry.errorMessage = \"\";\n                    self.manualEntry.method = \"\";\n                    self.manualEntry.todayObj = self.modules.tnthDates.getTodayDateObj(); //get GMT date/time for today\n                    self.manualEntry.completionDate = self.manualEntry.todayObj.gmtDate;\n                    self.modules.tnthAjax.getConsent(subjectId, {sync: true}, function(data) { //get consent date\n                        var dataArray = [];\n                        if (!data || !data.consent_agreements || data.consent_agreements.length === 0) {\n                            return false;\n                        }\n                        dataArray = data.consent_agreements.sort(function(a, b) {\n                            return new Date(b.acceptance_date) - new Date(a.acceptance_date);\n                        });\n                        var items = $.grep(dataArray, function(item) { //filtered out non-deleted items from all consents\n                            return !item.deleted && String(item.status) === \"consented\";\n                        });\n                        if (items.length > 0) { //consent date in GMT\n                            self.manualEntry.consentDate = items[0].acceptance_date;\n                        }\n                    });\n                    setTimeout(function() { self.manualEntry.initloading = false;}, 10);\n                });\n\n                $(\"input[name='entryMethod']\").on(\"click\", function() {\n                    self.manualEntry.errorMessage = \"\";\n                    self.manualEntry.method = $(this).val();\n                    if ($(this).val() === \"interview_assisted\") {\n                        self.manualEntry.todayObj = self.modules.tnthDates.getTodayDateObj(); //if method is interview assisted, reset completion date to GMT date/time for today\n                        self.manualEntry.completionDate = self.manualEntry.todayObj.gmtDate;\n                    }\n                });\n\n                self.__convertToNumericField($(\"#qCompletionDay, #qCompletionYear\"));\n\n                [\"qCompletionDay\", \"qCompletionMonth\", \"qCompletionYear\"].forEach(function(fn) {\n                    var fd = $(\"#\" + fn),\n                        tnthDates = self.modules.tnthDates;\n                    fd.on(\"change\", function() {\n                        var d = $(\"#qCompletionDay\");\n                        var m = $(\"#qCompletionMonth\");\n                        var y = $(\"#qCompletionYear\");\n                        var todayObj = tnthDates.getTodayDateObj();\n                        var td = todayObj.displayDay, tm = todayObj.displayMonth, ty = todayObj.displayYear;\n                        var isValid = d.val() !== \"\" && m.val() !== \"\" && y.val() !== \"\" && d.get(0).validity.valid && m.get(0).validity.valid && y.get(0).validity.valid;\n                        if (!isValid) {\n                            $(\"#meSubmit\").attr(\"disabled\", true);\n                        }\n                        if (isValid) {\n                            var errorMsg = tnthDates.dateValidator(d.val(), m.val(), y.val());\n                            var consentDate = $(\"#manualEntryConsentDate\").val();\n                            if (errorMsg || !consentDate) {\n                                self.manualEntry.errorMessage = i18next.t(\"All date fields are required\");\n                                return false;\n                            }\n                            var gmtDateObj = tnthDates.getDateObj(y.val(), m.val(), d.val(), 12, 0, 0); //noon UTC date\n                            self.manualEntry.completionDate = self.modules.tnthDates.getDateWithTimeZone(gmtDateObj); //time zone based on user's\n                            //all date/time should be in GMT date/time\n                            var completionDate = new Date(self.manualEntry.completionDate);\n                            var cConsentDate = new Date(self.manualEntry.consentDate);\n                            var cToday = new Date(self.manualEntry.todayObj.gmtDate);\n                            var nCompletionDate = completionDate.setHours(0, 0, 0, 0);\n                            var nConsentDate = cConsentDate.setHours(0, 0, 0, 0);\n                            var nToday = cToday.setHours(0, 0, 0, 0);\n                            if (nCompletionDate < nConsentDate) {\n                                errorMsg = i18next.t(\"Completion date cannot be before consent date.\");\n                            }\n                            if (nConsentDate >= nToday) {\n                                if (nCompletionDate > nConsentDate) {\n                                    errorMsg = i18next.t(\"Completion date cannot be in the future.\");\n                                }\n                            } else {\n                                if (nCompletionDate > nToday) {\n                                    errorMsg = i18next.t(\"Completion date cannot be in the future.\");\n                                }\n                            }\n                            self.manualEntry.errorMessage = errorMsg;\n                        }\n                    });\n                });\n                $(document).delegate(\"#meSubmit\", \"click\", function() {\n                    var method = String(self.manualEntry.method), completionDate = self.modules.tnthDates.formatDateString(self.manualEntry.completionDate, \"system\"); //note completion date has both date and time info\n                    var linkUrl = \"/api/present-needed?subject_id=\" + $(\"#manualEntrySubjectId\").val();\n                    if (method === \"\") { return false; }\n                    if (method !== \"paper\") {\n                        self.continueToAssessment(method, completionDate, linkUrl);\n                        return false;\n                    }\n                    self.manualEntryModalVis(true);\n                    self.modules.tnthAjax.getCurrentQB(subjectId, completionDate, null, function(data) {\n                        if (data.error) {\n                            self.manualEntry.errorMessage = i18next.t(\"Server error occurred checking questionnaire window\");\n                            self.manualEntryModalVis();\n                            return false;\n                        }\n                        //check questionnaire time windows\n                        if (!(data.questionnaire_bank && Object.keys(data.questionnaire_bank).length > 0)) {\n                            self.manualEntry.errorMessage = i18next.t(\"Invalid completion date. Date of completion is outside the days allowed.\");\n                            self.manualEntryModalVis();\n                        } else {\n                            self.manualEntry.errorMessage = \"\";\n                            self.continueToAssessment(method, completionDate, linkUrl);\n                        }\n                    });\n                });\n\n                self.modules.tnthAjax.assessmentStatus(subjectId, function(data) {\n                    if (!data.error && (data.assessment_status).toUpperCase() === \"COMPLETED\" &&\n                        parseInt(data.outstanding_indefinite_work) === 0) {\n                        $(\"#assessmentLink\").attr(\"disabled\", true);\n                        $(\"#enterManualInfoContainer\").text(i18next.t(\"All available questionnaires have been completed.\"));\n                    }\n                });\n            },\n            updateRolesData: function(event) {\n                var roles = $(\"#rolesGroup input:checkbox:checked\").map(function() {\n                    return {name: $(this).val()};\n                }).get();\n                this.modules.tnthAjax.putRoles(this.subjectId, {\"roles\": roles}, $(event.target));\n            },\n            initUserRoles: function(params) {\n                if (!this.subjectId) { return false; }\n                var self = this;\n                this.modules.tnthAjax.getRoles(this.subjectId, function(data) {\n                    if (data.roles) {\n                        self.userRoles = data.roles.map(function(role) {\n                            return role.name;\n                        });\n                    }\n                }, params);\n            },\n            initRolesListSection: function() {\n                var self = this;\n                this.modules.tnthAjax.getRoleList({useWorker:true}, function(data) {\n                    if (!data.roles) { return false; }\n                    self.roles.data = data.roles;\n                });\n                self.initUserRoles();\n            },\n            initAuditLogSection: function() {\n                var self = this;\n                this.modules.tnthAjax.auditLog(this.subjectId, {useWorker:true}, function(data) {\n                    if (data.error) {\n                        $(\"#profileAuditLogErrorMessage\").text(i18next.t(\"Problem retrieving audit log from server.\"));\n                        return false;\n                    }\n                    if (!data.audits || data.audits.length === 0) {\n                        $(\"#profileAuditLogErrorMessage\").text(i18next.t(\"No audit log item found.\"));\n                        return false;\n                    }\n                    var ww = $(window).width(), fData = [], len = ((ww < 650) ? 20 : (ww < 800 ? 40 : 80));\n                    (data.audits).forEach(function(item) {\n                        item.by = item.by.reference || \"-\";\n                        var r = /\\d+/g;\n                        var m = r.exec(String(item.by));\n                        if (m) {\n                            item.by = m[0];\n                        }\n                        item.lastUpdated = self.modules.tnthDates.formatDateString(item.lastUpdated, \"iso\");\n                        item.comment = item.comment ? self.escapeHtml(item.comment) : \"\";\n                        var c = String(item.comment);\n                        item.comment = c.length > len ? (c.substring(0, len + 1) + \"<span class='second hide'>\" + c.substr(len + 1) + \"</span><br/><sub onclick='{showText}' class='pointer text-muted'>\" + i18next.t(\"More...\") + \"</sub>\") : item.comment;\n                        item.comment = (item.comment).replace(\"{showText}\", \"(function (obj) {\" +\n                            \"if (obj) {\" +\n                            'var f = $(obj).parent().find(\".second\"); ' +\n                            'f.toggleClass(\"hide\"); ' +\n                            '$(obj).text($(obj).text() === i18next.t(\"More...\") ? i18next.t(\"Less...\"): i18next.t(\"More...\")); ' +\n                            \"}  \" +\n                            \"})(this) \"\n                        );\n                        fData.push(item);\n                    });\n                    $(\"#profileAuditLogTable\").bootstrapTable(self.setBootstrapTableConfig({\n                        data: fData,\n                        classes: \"table table-responsive profile-audit-log\",\n                        sortName: \"lastUpdated\",\n                        sortOrder: \"desc\",\n                        toolbar: \"#auditTableToolBar\",\n                        columns: [{field: \"by\", title: i18next.t(\"User\"), width: \"5%\", sortable: true, searchable: true},\n                            {field: \"comment\", title: i18next.t(\"Comment\"), searchable: true, sortable: true},\n                            {field: \"lastUpdated\", title: i18next.t(\"Date/Time <span class='gmt'>{gmt}</span>\").replace(\"{gmt}\", \"(GMT), Y-M-D\"), sortable: true, searchable: true, width: \"20%\"},\n                            {field: \"version\", title: i18next.t(\"Version\"), sortable: true, visible: false}]\n                    }));\n                });\n            },\n            getConsentHeaderRow: function(header) {\n                var content = \"\", h = header || this.consent.consentHeaderArray;\n                h.forEach(function(title) {\n                    if (String(title) !== \"n/a\") {\n                        content += \"<TH class='consentlist-header'>\" + title + \"</TH>\";\n                    }\n                });\n                return content;\n            },\n            getConsentEditDisplayIconHTML: function(item=\"\", targetElementId=\"\") {\n                return `&nbsp;&nbsp;<a data-toggle=\"modal\" data-target=\"#${targetElementId}\" data-orgId=\"${item.organization_id}\" data-agreementUrl=\"${item.agreement_url}\" data-userId=\"${this.subjectId}\" data-status=\"${this.getConsentStatusHTMLObj(item).statusText}\" data-signed-date=\"${this.modules.tnthDates.formatDateString(item.acceptance_date, \"system\")}\"><span class=\"glyphicon glyphicon-pencil edit-icon\" aria-hidden=\"true\"></span></a>`;\n            },\n            getLREditIconHTML: function(item) {\n                var LROrgId = (this.getOrgTool()).getTopLevelParentOrg(item.organization_id);\n                var editorUrlEl = $(\"#\" + LROrgId + \"_editor_url\");\n                if (!editorUrlEl.val()) {\n                    return \"\";\n                }\n                var dataShow = String(editorUrlEl.attr(\"data-show\")) === \"true\";\n                return `<div class=\"button--LR\" data-show=\"${dataShow}\"><a href=\"${editorUrlEl.val()}\" target=\"_blank\">${i18next.t(\"Edit in Liferay\")}</a></div>`\n            },\n            isConsentStatusEditable: function(item) {\n               return this.isConsentEditable() && String(this.getConsentStatus(item)) === \"active\";\n            },\n            isConsentDateEditable: function(item) {\n                //consent date is editable only if the field is not disabled (e.g. as related to MedidataRave), consent is editable (e.g., Eproms), current user is a staff and subject is a patient\n                return (this.isTestEnvironment() && !this.isSubjectPatient()) || (this.isConsentStatusEditable(item) && this.isSubjectPatient() && this.isStaff());\n            },\n            getConsentRow: function(item) {\n                if (!item) {return false;}\n                var self = this, sDisplay = self.getConsentStatusHTMLObj(item).statusHTML;\n                var contentArray = [{\n                    content: self.getConsentOrgDisplayName(item)\n                }, {\n                    content: sDisplay + (self.isConsentStatusEditable(item) ? self.getConsentEditDisplayIconHTML(item, \"profileConsentListModal\") : \"\"),\n                    \"_class\": \"indent\"\n                }, {\n                    content: (function(item) {\n                        var viewLinkHTML = `<span class=\"agreement\">&nbsp;&nbsp;<a href=\"${decodeURIComponent(item.agreement_url)}\" target=\"_blank\"><em>${i18next.t(\"View\")}</em></a></span>`;\n                        var s = viewLinkHTML + self.getLREditIconHTML(item);\n                        if (self.isDefaultConsent(item)) {\n                            s = i18next.t(\"Sharing information with clinics\") + viewLinkHTML;\n                        }\n                        return s;\n                    })(item)\n                }, {\n                    content: self.modules.tnthDates.formatDateString(item.acceptance_date) + (self.isConsentDateEditable(item) ? self.getConsentEditDisplayIconHTML(item, \"consentDateModal\") : \"\")\n                }];\n                this.consent.consentDisplayRows.push(contentArray);\n            },\n            getConsentHistoryRow: function(item) {\n                var self = this, sDisplay = self.getConsentStatusHTMLObj(item).statusHTML;\n                var content = `<tr ${(item.deleted?\"class='history'\":\"\")}>`;\n                var contentArray = [{\n                    content: `${self.getConsentOrgDisplayName(item)}<div class=\"smaller-text text-muted\">${this.orgTool.getOrgName(item.organization_id)}</div>`\n                }, {\n                    content: sDisplay\n                }, {\n                    content: self.modules.tnthDates.formatDateString(item.acceptance_date)\n\n                },\n                {\n                    content: `<span class=\"text-danger\">${self.getRecordedDisplayDate(item)||'<span class=\"text-muted\">--</span>'}</span>`\n                }, {\n                    content: (item.recorded && item.recorded.by && item.recorded.by.display ? item.recorded.by.display : \"<span class='text-muted'>--</span>\")\n                }];\n\n                contentArray.forEach(function(cell) {\n                    content += `<td class=\"consentlist-cell\">${cell.content}</td>`;\n                });\n                content += \"</tr>\";\n                return content;\n            },\n            getConsentOrgDisplayName: function(item) {\n                if (!item) {return \"\";}\n                var orgId = item.organization_id, OT = this.getOrgTool(), currentOrg = OT.orgsList[orgId], orgName = currentOrg ? currentOrg.name : item.organization_id;\n                if (!this.isConsentWithTopLevelOrg()) {\n                    var topOrgID = OT.getTopLevelParentOrg(orgId), topOrg = OT.orgsList[topOrgID];\n                    if (topOrg && topOrg.name) {\n                        orgName = topOrg.name;\n                    }\n                }\n                return orgName;\n            },\n            getConsentStatus: function(item) {\n                item = item || {};\n                if (item.deleted || String(item.status) === \"deleted\") { return \"deleted\"; }\n                if (item.expired && this.modules.tnthDates.getDateDiff(String(item.expires)) > 0) {\n                    return \"expired\";\n                }\n                return \"active\";\n            },\n            getRecordedDisplayDate: function(item) {\n                if (!item) {return \"\";}\n                var recordedDate = item.recorded? item.recorded.lastUpdated : \"\";\n                return this.modules.tnthDates.formatDateString(recordedDate, \"yyyy-mm-dd hh:mm:ss\");\n            },\n            isDefaultConsent: function(item) {\n                return item && /stock\\-org\\-consent/.test(item.agreement_url);\n            },\n            getConsentStatusHTMLObj: function(item) {\n                var consentStatus = this.getConsentStatus(item), sDisplay = \"\", cflag = \"\";\n                var se = item.staff_editable, sr = item.send_reminders, ir = item.include_in_reports;\n                var consentLabels = this.consent.consentLabels;\n                var oDisplayText = {\n                    \"default\": `<span class='text-success small-text'>${consentLabels.default}</span>`,\n                    \"consented\": `<span class='text-success small-text'>${consentLabels.consented}</span>`,\n                    \"withdrawn\": `<span class='text-warning small-text withdrawn-label'>${consentLabels.withdrawn}</span>`,\n                    \"deleted\": `<span class='text-danger small-text'>${consentLabels.deleted}</span>`,\n                    \"purged\": `<span class='text-danger small-text'>${consentLabels.purged}</span>`,\n                    \"expired\": `<span class='text-warning'>&#10007; <br><span>(${i18next.t(\"expired\")}</span>`,\n                };\n                switch (consentStatus) {\n                case \"deleted\":\n                    if (se && sr && ir) {\n                        sDisplay = oDisplayText.consented;\n                    } else if (se && ir && !sr || (!se && ir && !sr)) {\n                        sDisplay = oDisplayText.withdrawn;\n                    } else if (!se && !ir && !sr) {\n                        sDisplay = oDisplayText.purged;\n                    } else {\n                        sDisplay = oDisplayText.consented;\n                    }\n                    if (String(item.status) === \"deleted\") {\n                        sDisplay += `<span class=\"text-danger\"> (</span>${oDisplayText.deleted}<span class=\"text-danger\">)</span>`;\n                    }\n                    break;\n                case \"expired\":\n                    sDisplay = oDisplayText.expired;\n                    break;\n                case \"active\":\n                    switch (item.status) {\n                    case \"consented\":\n                        if (this.isDefaultConsent(item)) {\n                            sDisplay = oDisplayText.default;\n                        } else {\n                            sDisplay = oDisplayText.consented;\n                        }\n                        cflag = \"consented\";\n                        break;\n                    case \"suspended\":\n                        sDisplay = oDisplayText.withdrawn;\n                        cflag = \"suspended\";\n                        break;\n                    case \"deleted\":\n                        sDisplay = oDisplayText.purged;\n                        cflag = \"purged\";\n                        break;\n                    default:\n                        sDisplay = oDisplayText.consented;\n                        cflag = \"consented\";\n                    }\n                    break;\n                }\n                return {\"statusText\": cflag || consentStatus, \"statusHTML\": sDisplay};\n            },\n            getTerms: function() {\n                if (this.consent.touObj.length > 0) {\n                    return this.consent.touObj;\n                } else {\n                    var self = this;\n                    var orgTool = this.getOrgTool();\n                    var orgsList = orgTool.getOrgsList();\n                    var i18next = self.modules.i18next;\n                    var capitalize = function(str) {\n                        return str.replace(/\\w\\S*/g, function(txt) {\n                            return txt.charAt(0).toUpperCase() + txt.substr(1).toLowerCase();\n                        });\n                    };\n                    self.modules.tnthAjax.getTerms(this.subjectId, \"\", true, function(data) {\n                        if (data && data.tous) {\n                            (data.tous).forEach(function(item) {\n                                var fType = $.trim(item.type).toLowerCase();\n                                var org = orgsList[item.organization_id];\n                                if ([\"subject website consent\", \"website terms of use\"].indexOf(String(fType)) !== -1) {\n                                    item.name = (org && org.name ? i18next.t(org.name) : \"--\");\n                                    item.truenth_name = i18next.t(\"TrueNTH USA\");\n                                    item.accepted = self.modules.tnthDates.formatDateString(item.accepted); //format to accepted format D m y\n                                    item.display_type = capitalize($.trim((item.type).toLowerCase().replace(\"subject\", \"\"))); //for displaying consent type, note: this will remove text 'subject' from being displayed\n                                    item.eproms_agreement_text = String(i18next.t(\"Agreed to {documentType}\")).replace(\"{documentType}\", capitalize(item.display_type));\n                                    item.truenth_agreement_text = i18next.t(\"Agreed to terms\");\n                                    item.eproms_url_text = i18next.t(item.display_type);\n                                    item.truenth_url_text = (String(i18next.t(\"{projectName} Terms of Use\")).replace(\"{projectName}\", \"TrueNTH USA\"));\n                                    item.view = i18next.t(\"View\");\n                                    item.type = fType;\n                                    self.consent.touObj.push(item);\n                                }\n                            });\n                        }\n                    });\n                }\n                self.consent.showInitialConsentTerms = (self.consent.touObj.length > 0); //NEED TO CHECK THAT USER HAS ACTUALLY CONSENTED TO TERMS of USE\n            },\n            initConsentItemEvent: function() {\n                var __self = this;\n                $(\"#profileConsentListModal\").on(\"show.bs.modal\", function(e) {\n                    var relatedTarget = $(e.relatedTarget), orgId = $(e.relatedTarget).attr(\"data-orgId\"), agreementUrl = relatedTarget.attr(\"data-agreementUrl\");\n                    var userId = relatedTarget.attr(\"data-userId\"), status = relatedTarget.attr(\"data-status\");\n                    $(this).find(\"input[class='radio_consent_input']\").each(function() {\n                        $(this).attr({ \"data-agreementUrl\": agreementUrl, \"data-userId\": userId, \"data-orgId\": orgId});\n                        if (String($(this).val()) === String(status)) {\n                            $(this).prop(\"checked\", true);\n                        }\n                    });\n                    if (__self.isAdmin()) {\n                        $(this).find(\".admin-radio\").show();\n                    }\n                });\n                $(\"#profileConsentListModal input[class='radio_consent_input']\").each(function() {\n                    $(this).off(\"click\").on(\"click\", function() { //remove pre-existing events as when consent list is re-drawn\n                        var o = __self.CONSENT_ENUM[$(this).val()];\n                        __self.consent.saveLoading = true;\n                        if (o) {\n                            o.org = $(this).attr(\"data-orgId\");\n                            o.agreementUrl = $(this).attr(\"data-agreementUrl\");\n                        }\n                        if (String($(this).val()) === \"purged\") {\n                            __self.modules.tnthAjax.deleteConsent($(this).attr(\"data-userId\"), {\n                                org: $(this).attr(\"data-orgId\")\n                            });\n                            __self.consent.saveLoading = false;\n                            __self.reloadConsentList($(this).attr(\"data-userId\"));\n                        } else if (String($(this).val()) === \"suspended\") {\n                            var modalElement = $(\"#profileConsentListModal\"), self = $(this);\n                            __self.modules.tnthAjax.withdrawConsent($(this).attr(\"data-userId\"), $(this).attr(\"data-orgId\"), null, function(data) {\n                                modalElement.removeClass(\"fade\").modal(\"hide\");\n                                __self.consent.saveLoading = false;\n                                __self.reloadConsentList(self.attr(\"data-userId\"));\n                            });\n                        } else {\n                            var self = $(this);\n                            __self.modules.tnthAjax.setConsent($(this).attr(\"data-userId\"), o, $(this).val(), false, function(data) {\n                                $(\"#profileConsentListModal\").removeClass(\"fade\").modal(\"hide\");\n                                __self.consent.saveLoading = false;\n                                __self.reloadConsentList(self.attr(\"data-userId\"));\n                            });\n\n                        }\n                    });\n                });\n            },\n            initConsentDateEvents: function() {\n                var today = new Date(), __self = this;\n                $(\"#consentDateModal\").on(\"shown.bs.modal\", function(e) {\n                    $(this).find(\".consent-date\").focus();\n                    $(this).addClass(\"active\");\n                    var relatedTarget = $(e.relatedTarget), orgId = relatedTarget.attr(\"data-orgId\");\n                    var agreementUrl = relatedTarget.attr(\"data-agreementUrl\"), userId = relatedTarget.attr(\"data-userId\"), status = relatedTarget.attr(\"data-status\");\n                    $(this).find(\".data-current-consent-date\").text(__self.modules.tnthDates.formatDateString(relatedTarget.attr(\"data-signed-date\"), \"d M y hh:mm:ss\")); //display user friendly date\n                    $(this).find(\"input.form-control\").each(function() {\n                        $(this).attr({\n                            \"data-agreementUrl\": agreementUrl,\n                            \"data-userId\": userId,\n                            \"data-orgId\": orgId,\n                            \"data-status\": status\n                        });\n                        if ($(this).attr(\"data-default-value\")) {\n                            $(this).val($(this).attr(\"data-default-value\"));\n                        } else {\n                            $(this).val(\"\");\n                        }\n                    });\n                    $(\"#consentDateModal [data-dismiss]\").on(\"click\", function() {\n                        $(this).modal(\"hide\");\n                    });\n                    $(\"#consentDateContainer\").show();\n                    $(\"#consentDateLoader\").hide();\n                    $(\"#consentDateModalError\").html(\"\");\n                });\n                $(\"#consentDateModal\").on(\"hidden.bs.modal\", function() {\n                    $(this).removeClass(\"active\");\n                });\n                $(\"#consentDateModal .consent-date\").datepicker({\"format\": \"d M yyyy\",\"forceParse\": false,\"endDate\": today,\"autoclose\": true});\n                $(\"#consentDateModal .consent-hour, #consentDateModal .consent-minute, #consentDateModal .consent-second\").each(function() {\n                    __self.__convertToNumericField($(this));\n                });\n                $(\"#consentDateModal .consent-date, #consentDateModal .consent-hour, #consentDateModal .consent-minute, #consentDateModal .consent-second\").each(function() {\n                    $(this).on(\"change\", function() {\n                        var d = $(\"#consentDateModal_date\"), h = $(\"#consentDateModal_hour\").val(), m = $(\"#consentDateModal_minute\").val(), s = $(\"#consentDateModal_second\").val();\n                        var errorMessage = \"\";\n                        var isValid = __self.modules.tnthDates.isValidDefaultDateFormat(d.val());\n                        if (d.val() && !isValid) {\n                            errorMessage += (errorMessage ? \"<br/>\" : \"\") + i18next.t(\"Date must in the valid format.\");\n                            d.datepicker(\"hide\");\n                        }\n                        if (h && !(/^([1-9]|0[0-9]|1\\d|2[0-3])$/.test(h))) { //validate hour [0]0\n                            errorMessage += (errorMessage ? \"<br/>\" : \"\") + i18next.t(\"Hour must be in valid format, range 0 to 23.\");\n                        }\n                        if (m && !(/^(0[0-9]|[1-9]|[1-5]\\d)$/.test(m))) {\n                            errorMessage += (errorMessage ? \"<br/>\" : \"\") + i18next.t(\"Minute must be in valid format, range 0 to 59.\");\n                        }\n                        if (s && !(/^(0[0-9]|[1-9]|[1-5]\\d)$/.test(s))) {\n                            errorMessage += (errorMessage ? \"<br/>\" : \"\") + i18next.t(\"Second must be in valid format, range 0 to 59.\");\n                        }\n                        $(\"#consentDateModalError\").html(errorMessage);\n                    });\n                });\n\n                $(\"#consentDateModal .btn-submit\").on(\"click\", function() {\n                    var ct = $(\"#consentDateModal_date\"), o = __self.CONSENT_ENUM[ct.attr(\"data-status\")];\n                    if (!ct.val()) {\n                        $(\"#consentDateModalError\").text(i18next.t(\"You must enter a date/time\"));\n                        return false;\n                    }\n                    var h = $(\"#consentDateModal_hour\").val()||\"00\",m = $(\"#consentDateModal_minute\").val()||\"00\",s = $(\"#consentDateModal_second\").val()||\"00\";\n                    var dt = new Date(ct.val()); //2017-07-06T22:04:50 format\n                    var cDate = dt.getFullYear()+\"-\"+(dt.getMonth() + 1)+\"-\"+dt.getDate()+\"T\"+__self.pad(h)+\":\"+__self.pad(m)+\":\"+__self.pad(s);\n                    o.org = ct.attr(\"data-orgId\");\n                    o.agreementUrl = ct.attr(\"data-agreementUrl\");\n                    o.acceptance_date = cDate;\n                    o.testPatient = true;\n                    setTimeout((function() { $(\"#consentDateContainer\").hide();})(), 200);\n                    setTimeout((function() {$(\"#consentDateLoader\").show();})(), 450);\n                    $(\"#consentDateModal button[data-dismiss]\").attr(\"disabled\", true); //disable close buttons while processing reques\n                    setTimeout(__self.modules.tnthAjax.setConsent(ct.attr(\"data-userId\"), o, ct.attr(\"data-status\"), true, function(data) {\n                        if (!data || data.error) {\n                            $(\"#consentDateModalError\").text(i18next.t(\"Error processing data.  Make sure the date is in the correct format.\"));\n                            setTimeout(function() {\n                                $(\"#consentDateContainer\").show();\n                                $(\"#consentDateModal button[data-dismiss]\").attr(\"disabled\", false);\n                                $(\"#consentDateLoader\").hide();\n                            }, 450);\n                            return false;\n                        }\n                        $(\"#consentDateModal button[data-dismiss]\").attr(\"disabled\", false);\n                        $(\"#consentDateModal\").removeClass(\"fade\").modal(\"hide\");\n                        __self.reloadConsentList(ct.attr(\"data-userId\"));\n                    }), 100);\n                });\n            },\n            showConsentHistory: function() {\n               return !this.consent.consentLoading && this.isConsentEditable() && this.hasConsentHistory();\n            },\n            hasConsentHistory: function() {\n                return this.consent.historyItems.length > 0;\n            },\n            hasCurrentConsent: function() {\n                return this.consent.currentItems.length > 0;\n            },\n            getConsentHistory: function(options) {\n                if (!options) {options = {};}\n                var self = this, content = \"\";\n                content = \"<div id='consentHistoryWrapper'><table id='consentHistoryTable' class='table-bordered table-condensed table-responsive' style='width: 100%; max-width:100%'>\";\n                content += this.getConsentHeaderRow(this.consent.consentHistoryHeaderArray);\n                var items = this.consent.historyItems.sort(function(a, b) { //sort items by last updated date in descending order\n                    return new Date(b.deleted.lastUpdated) - new Date(a.deleted.lastUpdated);\n                });\n                items = (this.consent.currentItems).concat(this.consent.historyItems); //combine both current and history items and display current items first;\n                items.forEach(function(item, index) {\n                    content += self.getConsentHistoryRow(item, index);\n                });\n                content += \"</table></div>\";\n                $(\"#consentHistoryModal .modal-body\").html(content);\n                $(\"#consentHistoryModal\").modal(\"show\");\n            },\n            /**** this function is used when this section becomes editable, note: this is called after the user has edited the consent list; this will refresh the list ****/\n            reloadConsentList: function(userId) {\n                var self = this;\n                $(\"#consentListTable\").animate({opacity: 0}, function() {\n                    self.consent.consentLoading = true;\n                    setTimeout(function() { // Set a one second delay before getting updated list. Mostly to give user sense of progress/make it\n                        self.modules.tnthAjax.getConsent(userId || self.subjectId, {sync: true}, function(data) {\n                            self.getConsentList(data);\n                        });\n                    }, 1500);\n                });\n            },\n            getConsentList: function(data) {\n                if (!data) { return false; }\n                if (data.error) {\n                    this.consent.consentListErrorMessage = i18next.t(\"Error occurred retrieving consent list content.\");\n                    this.consent.consentLoading = false;\n                    return false;\n                }\n                this.getTerms(); //get terms of use if any\n                var self = this, dataArray = [];\n                if (data.consent_agreements && (data.consent_agreements).length > 0) {\n                    dataArray = data.consent_agreements;\n                }\n                this.consent.consentItems = dataArray;\n                this.consent.consentDisplayRows = [];\n                if (this.consent.consentItems.length === 0) {\n                    clearInterval(self.consentListReadyIntervalId);\n                    $(\"#consentListTable\").animate({opacity: 1});\n                    this.consent.consentLoading = false;\n                    return false;\n                }\n\n                var existingOrgs = {};\n                this.consent.currentItems = $.grep(this.consent.consentItems, function(item) {\n                    return self.getConsentStatus(item) === \"active\";\n                });\n                this.consent.historyItems = $.grep(this.consent.consentItems, function(item) { //iltered out deleted items from all consents\n                    return self.getConsentStatus(item) !== \"active\";\n                });\n                this.consent.currentItems.forEach(function(item, index) {\n                    if (!(existingOrgs[item.organization_id]) && !(/null/.test(item.agreement_url))) {\n                        self.getConsentRow(item, index);\n                        existingOrgs[item.organization_id] = true;\n                    }\n                });\n                clearInterval(this.consentListReadyIntervalId);\n                this.consentListReadyIntervalId = setInterval(function() {\n                    if ($(\"#consentListTable .consentlist-cell\").length > 0) {\n                        $(\"#consentListTable .button--LR[show='true']\").addClass(\"show\");\n                        $(\"#consentListTable tbody tr\").each(function(index) {\n                            $(this).addClass(index % 2 !== 0 ? \"even\" : \"odd\");\n                        });\n                        if (!self.isConsentWithTopLevelOrg()) {\n                            $(\"#consentListTable .agreement\").each(function() { $(this).parent().hide(); });\n                        }\n                        if (self.isConsentEditable()) {\n                            self.initConsentItemEvent();\n                            self.initConsentDateEvents();\n                        }\n                        $(\"#consentListTable\").animate({opacity: 1}, 1500);\n                        clearInterval(self.consentListReadyIntervalId);\n                    }\n                    if (self.showConsentHistory()) {\n                        $(\"#viewConsentHistoryButton\").on(\"click\", function(e) {\n                            e.preventDefault();\n                            e.stopImmediatePropagation()\n                            self.getConsentHistory();\n                        });\n                        setTimeout(function() {\n                            $(\"#viewConsentHistoryButton\").removeClass(\"tnth-hide\");\n                        }, 550);\n                    }\n                }, 50);\n                this.consent.consentLoading = false;\n            },\n            pad : function(n) { n = parseInt(n); return (n < 10) ? \"0\" + n : n; },\n            __convertToNumericField: function(field) {\n                if (field && (\"ontouchstart\" in window || (typeof(window.DocumentTouch) !== \"undefined\" && document instanceof window.DocumentTouch))) {\n                    field.each(function() {$(this).prop(\"type\", \"tel\");});\n                }\n            },\n            escapeHtml: function (text) {\n                if (text === null || text !== \"undefined\" || String(text).length === 0) {\n                    return text;\n                }\n                return text.replace(/[\\\"&'\\/<>]/g, function (a) {\n                    return {\n                        '\"': \"&quot;\", \"&\": \"&amp;\", \"'\": \"&#39;\",\n                        \"/\": \"&#47;\",  \"<\": \"&lt;\",  \">\": \"&gt;\"\n                    }[a];\n                });\n            }\n\n        }\n    });\n})();\n"],"sourceRoot":""}