{"version":3,"sources":["webpack:///webpack/bootstrap","webpack:///./static/js/src/modules/SYSTEM_IDENTIFIER_ENUM.js","webpack:///./static/js/src/modules/Utility.js","webpack:///./static/js/src/initialQueries.js","webpack:///./static/js/src/modules/TnthDate.js","webpack:///./static/js/src/modules/CLINICAL_CODE_ENUM.js","webpack:///./static/js/src/modules/TnthAjax.js","webpack:///./static/js/src/modules/OrgTool.js"],"names":["installedModules","__webpack_require__","moduleId","exports","module","i","l","modules","call","m","c","d","name","getter","o","Object","defineProperty","enumerable","get","r","Symbol","toStringTag","value","t","mode","__esModule","ns","create","key","bind","n","object","property","prototype","hasOwnProperty","p","s","__webpack_exports__","external_study_id","external_site_id","practice_region","race","race_system","ethnicity","ethnicity_system","indigenous","timezone","language","language_system","shortname","SNOMED_SYS_URL","CLINICAL_SYS_URL","CANCER_TREATMENT_CODE","NONE_TREATMENT_CODE","getExportFileName","getUrlParameter","UtilityObj","Utility","this","requestAttempts","hasValue","val","String","showMain","$","css","visibility","-ms-filter","filter","-moz-opacity","-khtml-opacity","opacity","hideLoader","delay","time","hide","setTimeout","fadeOut","loader","show","document","getElementById","isDelayLoading","self","DELAY_LOADING","isTouchDevice","window","DocumentTouch","getIEVersion","match","navigator","userAgent","parseInt","newHttpRequest","url","params","callBack","xmlhttp","param","XDomainRequest","onload","responseText","XMLHttpRequest","ActiveXObject","onreadystatechange","readyState","status","error","open","setRequestHeader","cache","send","ajaxRequest","callback","i18next","defaults","type","contentType","timeout","extend","uself","ajax","done","data","fail","always","initWorker","callbackFunc","worker","Worker","postMessage","addEventListener","e","terminate","console","log","lineno","filename","message","workerAllowed","getRequestMethod","sendRequest","useWorker","LRKeyEvent","length","on","keyCode","toggleClass","getLoaderHTML","concat","convertToNumericField","field","each","prop","isString","obj","toString","disableHeaderFooterLinks","links","not","addClass","off","preventDefault","pad","isNaN","escapeHtml","text","replace","a","\"","&","'","/","<",">","containHtmlTags","test","prefix","Date","getDate","slice","getMonth","getFullYear","capitalize","str","txt","charAt","toUpperCase","substr","toLowerCase","restoreVis","loadingElement","mainElement","setAttribute","VueErrorHandling","Vue","config","errorHandler","err","vm","info","handler","current","$options","$parent","extension","results","RegExp","exec","location","search","decodeURIComponent","resetBrowserBackHistory","locationUrl","stateObject","title","historyDefined","history","pushState","href","forward","handlePostLogout","sessionStorage","getItem","orgin","removeItem","displaySystemOutageMessage","locale","MAINTENANCE_MESSAGE","MAINTENANCE_WINDOW","messageElement","querySelector","createElement","classList","add","appendChild","innerHTML","d1","d2","startDate","endDate","hoursTil","Math","floor","getTime","options","year","month","day","hour","minute","second","hour12","timeZoneName","displayStartDate","toLocaleString","displayEndDate","join","FieldsChecker","_modules_TnthDate_js__WEBPACK_IMPORTED_MODULE_0__","_modules_TnthAjax_js__WEBPACK_IMPORTED_MODULE_1__","_modules_OrgTool_js__WEBPACK_IMPORTED_MODULE_2__","_modules_Utility_js__WEBPACK_IMPORTED_MODULE_3__","dependencies","__getDependency","Error","userId","roleRequired","userRoles","CONFIG_REQUIRED_CORE_DATA","preselectClinic","defaultSections","mainSections","orgTool","ACCEPT_ON_NEXT","init","setUserId","alert","initConfig","initSections","initSectionData","tnthAjax","getCurrentUser","id","getOrgTool","setSectionDataLoadedFlag","sectionId","flag","loaded","sectionIsLoaded","sections","getSections","initDataObj","topTerms","getTerms","demographicsContainer","getDemo","clinicalContainer","getTreatment","getClinical","async","orgsContainer","section","sectionCompleted","attr","sectionObj","display","postDemoData","targetField","demoArray","resourceType","fname","lname","given","trim","family","y","birthDate","getSectionContainerId","putDemo","handlePostEvent","setUserRoles","getRoles","roles","map","item","removeCachedRoles","indexOf","getStillNeededCoreData","setConfig","inConfig","configMatch","dataArray","found","split","forEach","getConfig","still_needed","fields","handleAcceptOnNext","getConfigurationByKey","sync","REQUIRED_CORE_DATA","acceptOnNextCheckboxes","matchedTermsCheckbox","data-required","data-collection-method","collection_method","parentNode","closest","removeClass","find","push","ckBox","trigger","removeAttr","getTotalSections","keys","constructProgressBar","remove","availableSections","sectionConfigs","getSectionConfigs","active","append","w","setProgressBar","configArray","scrollTo","element","stop","animate","scrollTop","offset","top","isAcceptOnNext","hasClass","continueToFinish","hideSectionSavingLoader","fadeIn","stopContinue","continueToNext","getNext","handleIncomplete","handleIncompleteFuncObj","performance","navigation","agreedCheckboxes","modal","handlePreSelectedClinic","__modal","getConsentModal","currentSectionLoaded","isLoaded","getFieldEventType","triggerEvent","nodeName","initFields","events","termsCheckboxEvent","nameGroupEvent","bdGroupEvent","rolesGroupEvent","patientQEvent","clinicsEvent","onFieldsDidInit","submit","reload","next","children","first","is","handleRefreshElement","contentHTML","contentElement","isSavingInProgress","sectionHasError","hasError","showSectionSavingLoader","handleSectionError","elapsedSaveTime","startDataSavingTime","endDataSavingTime","clearInterval","dataSavingIntervalId","setInterval","loadingInProgress","updateTerms","typeInTous","isActive","tous","item_found","vs","__self","termsEvent","types","arrTypes","dataUrl","theTerms","userOrgId","careProvider","reference","pop","topOrg","getTopLevelParentOrg","postTerms","html","coreTypes","parentCoreType","coreDataType","inArray","notificationEntry","portalModules","Global","deleteNotification","apply","stopPropagation","validateDateInputFields","theVal","putRoles","thisItem","toCall","parents","nextRadio","nextItem","nextAll","parentOrg","getElementParentOrg","getSelectedOrg","__defaultModal","ob","stateContainer","st","ready","fc","OrgTool","startTime","intervalId","endTime","elapsedTime","tnthDates","monthField","dayField","yearField","errorFieldId","validity","valid","errorField","today","date","setHours","swap_mm_dd","currentDate","splitDate","convertMonthNumeric","jan","feb","mar","apr","may","jun","jul","aug","sep","oct","nov","dec","convertMonthString","1","2","3","4","5","6","7","8","9","10","11","12","isDate","displayDateString","getDateDiff","dateToCalc","dateTime","isValidDefaultDateFormat","dArray","dt","isDateObj","isValidDate","errorMsg","getDateObj","convertedDate","getConvertedDate","givenDate","getGivenDate","h","mi","dateObj","formatDateString","dateString","format","hours","minutes","seconds","nd","iosDateTest","getHours","getMinutes","getSeconds","convertToLocalTime","newDate","getTimezoneOffset","getDateWithTimeZone","dObj","utcDate","getTodayDateObj","td","tm","ty","th","tmi","ts","gmtToday","displayDay","displayMonth","displayYear","displayHour","displayMinute","displaySecond","gmtDate","dateValidator","restrictToPresent","errorMessage","iy","im","iid","CLINICAL_CODE_ENUM","biopsy","code","pca_diag","pca_localized","beforeSend","ajaxSetup","xhr","settings","crossDomain","method","defaultParams","attempts","max_attempts","dataType","fieldHelper","FieldLoaderHelper","showLoader","result","JSON","parse","sendError","showError","showUpdate","headers","cache-control","expires","pragma","stringify","reportError","arguments","undefined","page_url","subject_id","delayDuration","el","__timeout","containerId","successField","loadingField","currentUser","setItem","entry_method","__url","getRequiredCoreData","required","getOptionalCoreData","sessionStorageKey","getPortalFooter","getOrgs","demoOrgsData","getConsent","setConsent","hasConsent","org","testPatient","user_id","organization_id","agreement_url","agreementUrl","staff_editable","include_in_reports","send_reminders","acceptance_date","deleteConsent","consented","getAllValidConsent","arrExcludedOrgIds","exclude","arrConsents","grep","orgId","eOrg","withdrawConsent","arrConsent","consent_agreements","expired","deleted","consentedOrgIds","filterStatus","demoDataKey","clearDemoSessionData","toSend","getLocale","communication","hasTreatment","entry","sortedArray","sort","b","resource","meta","lastUpdated","resourceItemCode","coding","system","procId","SYSTEM_IDENTIFIER_ENUM","postTreatment","started","treatmentDate","deleteTreatment","procID","procArray","subject","performedDateTime","postProc","treatmentData","deleteProc","getProc","newEntry","procedureId","getRoleList","deleteRoles","getObservationId","obId","_code","content","postClinical","obsCode","obsArray","issued","issuedDate","valueQuantity","units","performer","obsId","getTermsUrl","getInstrumentsList","qList","organization","orgID","questionnaires","q","questionnaire","postTermsByUser","accessUrl","access_url","invite","passwordReset","assessmentStatus","updateAssessment","assessmentList","assessmentReport","instrumentId","getCurrentQB","completionDate","as_of_date","patientReport","setTablePreference","tableName","getTablePreference","emailLog","auditLog","setting","deactivateUser","reactivateUser","configVar","sessionConfigKey","getConfiguration","getEmailReady","OrgObj","_SYSTEM_IDENTIFIER_ENUM_js__WEBPACK_IMPORTED_MODULE_0__","_TnthAjax_js__WEBPACK_IMPORTED_MODULE_1__","orgName","parentOrgId","isTopLevel","TOP_LEVEL_ORGS","orgsList","initialized","orgsData","populateOrgsList","onLoaded","doPopulateUI","populateUI","getUserId","array","Array","isArray","index","getTopLevelOrgs","ml","getOrgsList","orgList","getOrgName","filterOrgs","leafOrgs","allChildrenHidden","subOrgs","allSubOrgsHidden","isVisible","ip","findOrg","items","parentId","partOf","identifier","getShortName","shortName","orgItem","orgsHTML","container","parentContent","getState","parentOrgsArray","orgA","orgB","parentDiv","parentFragment","createDocumentFragment","parentOrgItem","orgShortName","parentState","parentOrgName","childClinic","_parentOrgId","_parentOrg","_isTopLevel","state","topLevelOrgId","attrObj","dataAttributes","containerClass","textClass","parentOrgContainer","getSelectedOrgTopLevelParentOrg","getUserTopLevelParentOrgs","uo","parentList","currentOrg","currentOrgItem","getChildOrgs","orgs","mainOrgsList","childOrgs","getHereBelowOrgs","userOrgs","here_below_orgs","selectedOrg","co","cOrgs","morphPatientOrgs","checkedOrgs"],"mappings":"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","file":"initialQueries.bundle.js","sourcesContent":[" \t// The module cache\n \tvar installedModules = {};\n\n \t// The require function\n \tfunction __webpack_require__(moduleId) {\n\n \t\t// Check if module is in cache\n \t\tif(installedModules[moduleId]) {\n \t\t\treturn installedModules[moduleId].exports;\n \t\t}\n \t\t// Create a new module (and put it into the cache)\n \t\tvar module = installedModules[moduleId] = {\n \t\t\ti: moduleId,\n \t\t\tl: false,\n \t\t\texports: {}\n \t\t};\n\n \t\t// Execute the module function\n \t\tmodules[moduleId].call(module.exports, module, module.exports, __webpack_require__);\n\n \t\t// Flag the module as loaded\n \t\tmodule.l = true;\n\n \t\t// Return the exports of the module\n \t\treturn module.exports;\n \t}\n\n\n \t// expose the modules object (__webpack_modules__)\n \t__webpack_require__.m = modules;\n\n \t// expose the module cache\n \t__webpack_require__.c = installedModules;\n\n \t// define getter function for harmony exports\n \t__webpack_require__.d = function(exports, name, getter) {\n \t\tif(!__webpack_require__.o(exports, name)) {\n \t\t\tObject.defineProperty(exports, name, { enumerable: true, get: getter });\n \t\t}\n \t};\n\n \t// define __esModule on exports\n \t__webpack_require__.r = function(exports) {\n \t\tif(typeof Symbol !== 'undefined' && Symbol.toStringTag) {\n \t\t\tObject.defineProperty(exports, Symbol.toStringTag, { value: 'Module' });\n \t\t}\n \t\tObject.defineProperty(exports, '__esModule', { value: true });\n \t};\n\n \t// create a fake namespace object\n \t// mode & 1: value is a module id, require it\n \t// mode & 2: merge all properties of value into the ns\n \t// mode & 4: return value when already ns object\n \t// mode & 8|1: behave like require\n \t__webpack_require__.t = function(value, mode) {\n \t\tif(mode & 1) value = __webpack_require__(value);\n \t\tif(mode & 8) return value;\n \t\tif((mode & 4) && typeof value === 'object' && value && value.__esModule) return value;\n \t\tvar ns = Object.create(null);\n \t\t__webpack_require__.r(ns);\n \t\tObject.defineProperty(ns, 'default', { enumerable: true, value: value });\n \t\tif(mode & 2 && typeof value != 'string') for(var key in value) __webpack_require__.d(ns, key, function(key) { return value[key]; }.bind(null, key));\n \t\treturn ns;\n \t};\n\n \t// getDefaultExport function for compatibility with non-harmony modules\n \t__webpack_require__.n = function(module) {\n \t\tvar getter = module && module.__esModule ?\n \t\t\tfunction getDefault() { return module['default']; } :\n \t\t\tfunction getModuleExports() { return module; };\n \t\t__webpack_require__.d(getter, 'a', getter);\n \t\treturn getter;\n \t};\n\n \t// Object.prototype.hasOwnProperty.call\n \t__webpack_require__.o = function(object, property) { return Object.prototype.hasOwnProperty.call(object, property); };\n\n \t// __webpack_public_path__\n \t__webpack_require__.p = \"\";\n\n\n \t// Load entry module and return exports\n \treturn __webpack_require__(__webpack_require__.s = 18);\n","export default {\n    \"external_study_id\": \"http://us.truenth.org/identity-codes/external-study-id\",\n    \"external_site_id\": \"http://us.truenth.org/identity-codes/external-site-id\",\n    \"practice_region\": \"http://us.truenth.org/identity-codes/practice-region\",\n    \"race\": \"http://hl7.org/fhir/StructureDefinition/us-core-race\",\n    \"race_system\": \"http://hl7.org/fhir/v3/Race\",\n    \"ethnicity\": \"http://hl7.org/fhir/StructureDefinition/us-core-ethnicity\",\n    \"ethnicity_system\": \"http://hl7.org/fhir/v3/Ethnicity\",\n    \"indigenous\": \"http://us.truenth.org/fhir/StructureDefinition/AU-NHHD-METeOR-id-291036\",\n    \"timezone\": \"http://hl7.org/fhir/StructureDefinition/user-timezone\",\n    \"language\": \"http://hl7.org/fhir/valueset/languages\",\n    \"language_system\": \"urn:ietf:bcp:47\",\n    \"shortname\": \"http://us.truenth.org/identity-codes/shortname\",\n    SNOMED_SYS_URL: \"http://snomed.info/sct\",\n    CLINICAL_SYS_URL: \"http://us.truenth.org/clinical-codes\",\n    CANCER_TREATMENT_CODE: \"118877007\",\n    NONE_TREATMENT_CODE: \"999\"\n};\n\n","var Utility = (function() {\n    var UtilityObj = function() { /*global $ */\n        this.requestAttempts = 0;\n    };\n    UtilityObj.prototype.hasValue = function(val) {\n        return String(val) !== \"null\" && String(val) !== \"\" && String(val) !== \"undefined\";\n    };\n    UtilityObj.prototype.showMain = function() {\n        $(\"#mainHolder\").css({\n            \"visibility\": \"visible\",\n            \"-ms-filter\": \"progid:DXImageTransform.Microsoft.Alpha(Opacity=100)\",\n            \"filter\": \"alpha(opacity=100)\",\n            \"-moz-opacity\": 1,\n            \"-khtml-opacity\": 1,\n            \"opacity\": 1\n        });\n    };\n    UtilityObj.prototype.hideLoader = function(delay, time) {\n        if (delay) {\n            $(\"#loadingIndicator\").hide();\n            return;\n        }\n        setTimeout(function() {\n            $(\"#loadingIndicator\").fadeOut();\n        }, time || 200);\n    };\n    UtilityObj.prototype.loader = function(show) {\n        //landing page\n        if (document.getElementById(\"fullSizeContainer\")) {\n            this.hideLoader();\n            this.showMain();\n            return false;\n        }\n        if (show) {\n            $(\"#loadingIndicator\").show();\n            return;\n        }\n        if (!this.isDelayLoading()) {\n            var self = this;\n            setTimeout(function() {\n                self.showMain();\n            }, 100);\n            this.hideLoader(true, 350);\n        }\n    };\n    UtilityObj.prototype.isDelayLoading = function() { /*global DELAY_LOADING*/\n        return (typeof DELAY_LOADING !== \"undefined\") && DELAY_LOADING;\n    };\n    UtilityObj.prototype.isTouchDevice = function() {\n        return true === (\"ontouchstart\" in window || window.DocumentTouch && document instanceof window.DocumentTouch);\n    };\n    UtilityObj.prototype.getIEVersion = function() {\n        var match = navigator.userAgent.match(/(?:MSIE |Trident\\/.*; rv:)(\\d+)/);\n        return match ? parseInt(match[1]) : false;\n    };\n    UtilityObj.prototype.newHttpRequest = function(url, params, callBack) { /* note: this function supports older version of IE (version <= 9) - jquery ajax calls errored in older IE version*/\n        this.requestAttempts++;\n        var xmlhttp, self = this;\n        callBack = callBack || function() {};\n        if (window.XDomainRequest) { /*global XDomainRequest */\n            xmlhttp = new XDomainRequest();\n            xmlhttp.onload = function() {\n                callBack(xmlhttp.responseText);\n            };\n        } else if (window.XMLHttpRequest) {\n            xmlhttp = new XMLHttpRequest();\n        } else {\n            xmlhttp = new ActiveXObject(\"Microsoft.XMLHTTP\"); /*global ActiveXObject */\n        }\n        xmlhttp.onreadystatechange = function() {\n            if (xmlhttp.readyState === 4) {\n                if (xmlhttp.status === 200) {\n                    callBack(xmlhttp.responseText);\n                    self.requestAttempts = 0;\n                    return;\n                }\n                if (self.requestAttempts < 3) {\n                    setTimeout(function() {\n                        self.newHttpRequest(url, params, callBack);\n                    }, 3000);\n                } else {\n                    callBack({error: xmlhttp.responseText});\n                    self.loader();\n                    self.requestAttempts = 0;\n                }\n            }\n        };\n        params = params || {};\n        xmlhttp.open(\"GET\", url, true);\n        for (var param in params) {\n            if (params.hasOwnProperty(param)) {\n                xmlhttp.setRequestHeader(param, params[param]);\n            }\n        }\n        if (!params.cache) {\n            xmlhttp.setRequestHeader(\"cache-control\", \"no-cache\");\n            xmlhttp.setRequestHeader(\"expires\", \"-1\");\n            xmlhttp.setRequestHeader(\"pragma\", \"no-cache\"); //legacy HTTP 1.0 servers and IE support\n        }\n        xmlhttp.send();\n    };\n    UtilityObj.prototype.ajaxRequest = function(url, params, callback) {\n        callback = callback || function() {};\n        if (!url) {\n            callback({error: i18next.t(\"Url is required.\")});\n            return false;\n        }\n        var defaults = {\n            url: url,\n            type: \"GET\",\n            contentType: \"text/plain\",\n            timeout: 5000,\n            cache: false\n        };\n        params = params || defaults;\n        params = $.extend({}, defaults, params);\n        this.requestAttempts++;\n        var uself = this;\n        $.ajax(params).done(function(data) {\n            callback(data);\n            uself.requestAttempts = 0;\n        }).fail(function() {\n            if (uself.requestAttempts <= 3) {\n                setTimeout(function() { uself.ajaxRequest(url, params, callback);}, 3000);\n            } else {\n                callback({error: i18next.t(\"Error occurred processing request\")}); /*global i18next */\n                uself.requestAttempts = 0;\n                uself.loader();\n            }\n        }).always(function() {\n            uself.loader();\n        });\n    };\n    UtilityObj.prototype.initWorker = function(url, params, callbackFunc) {\n        var worker = new Worker(\"/static/js/ajaxWorker.js\");\n        var self = this;\n        worker.postMessage({url: url, params: params});\n        worker.addEventListener(\"message\", function(e) {\n            (callbackFunc).call(self, e.data);\n            worker.terminate();\n        }, false);\n        worker.addEventListener(\"error\", function(e) {\n            console.log(\"Worker runtime error: Line \", e.lineno, \" in \", e.filename, \": \", e.message);\n            worker.terminate();\n        }, false);\n    };\n    UtilityObj.prototype.workerAllowed = function() {\n        return window.Worker && !this.isTouchDevice();\n    };\n    UtilityObj.prototype.getRequestMethod = function() {\n        return this.getIEVersion() ? this.newHttpRequest: this.ajaxRequest; //NOTE JQuery ajax request does not work for IE <= 9\n    };\n    UtilityObj.prototype.sendRequest = function(url, params, callback) { /*generic function for sending GET ajax request, make use of worker if possible */\n        params = params || {};\n        if (params.useWorker && this.workerAllowed()) {\n            this.initWorker(url, params, callback);\n            return true;\n        }\n        var useFunc = this.getRequestMethod();\n        (useFunc).call(this, url, params, function(data) { (callback).call(this, data);});\n    };\n    UtilityObj.prototype.LRKeyEvent = function() {\n        var LR_INVOKE_KEYCODE = 187;\n        if ($(\".button--LR\").length > 0) {\n            $(\"html\").on(\"keydown\", function(e) {\n                if (parseInt(e.keyCode) === parseInt(LR_INVOKE_KEYCODE)) {\n                    $(\".button--LR\").toggleClass(\"data-show\");\n                }\n            });\n        }\n    };\n    UtilityObj.prototype.getLoaderHTML = function(message) {\n        return `<div class=\"loading-message-indicator\"><i class=\"fa fa-spinner fa-spin fa-2x\"></i>${message ? \"&nbsp;\" + message : \"\"}</div>`;\n    };\n    UtilityObj.prototype.convertToNumericField = function(field) {\n        if (!field) {\n            return;\n        }\n        if (this.isTouchDevice()) {\n            field.each(function() {\n                $(this).prop(\"type\", \"tel\");\n            });\n        }\n    };\n    UtilityObj.prototype.isString = function(obj) {\n        return (Object.prototype.toString.call(obj) === \"[object String]\");\n    };\n    UtilityObj.prototype.disableHeaderFooterLinks = function() {\n        var links = $(\"#tnthNavWrapper a, #homeFooter a\").not(\"a[href*='logout']\").not(\"a.required-link\").not(\"a.home-link\");\n        links.addClass(\"disabled\");\n        links.prop(\"onclick\", null).off(\"click\");\n        links.on(\"click\", function(e) {\n            e.preventDefault();\n            return false;\n        });\n    };\n    UtilityObj.prototype.pad = function(n) {\n        n = parseInt(n);\n        return (!isNaN(n) && n < 10) ? \"0\" + n : n;\n    };\n    UtilityObj.prototype.escapeHtml = function(text) {\n        \"use strict\";\n        if (text === null || text !== \"undefined\" || String(text).length === 0) {\n            return text;\n        }\n        return text.replace(/[\\\"&'\\/<>]/g, function(a) {\n            return {\n                '\"': \"&quot;\",\n                \"&\": \"&amp;\",\n                \"'\": \"&#39;\",\n                \"/\": \"&#47;\",\n                \"<\": \"&lt;\",\n                \">\": \"&gt;\"\n            }[a];\n        });\n    };\n    UtilityObj.prototype.containHtmlTags = function(text) {\n        if (!text) {\n            return false;\n        }\n        return /[<>]/.test(text);\n    };\n    UtilityObj.prototype.getExportFileName = function(prefix) {\n        var d = new Date();\n        return (prefix ? prefix : \"ExportList_\") + (\"00\" + d.getDate()).slice(-2) + (\"00\" + (d.getMonth() + 1)).slice(-2) + d.getFullYear();\n    };\n    UtilityObj.prototype.capitalize = function(str) {\n        return str.replace(/\\w\\S*/g, function(txt) {\n            return txt.charAt(0).toUpperCase() + txt.substr(1).toLowerCase();\n        });\n    };\n    UtilityObj.prototype.restoreVis = function() {\n        var loadingElement = document.getElementById(\"loadingIndicator\"), mainElement = document.getElementById(\"mainHolder\");\n        if (loadingElement) { loadingElement.setAttribute(\"style\", \"display:none; visibility:hidden;\"); }\n        if (mainElement) { mainElement.setAttribute(\"style\", \"visibility:visible;-ms-filter:'progid:DXImageTransform.Microsoft.Alpha(Opacity=100)';filter:alpha(opacity=100); -moz-opacity:1; -khtml-opacity:1; opacity:1\"); }\n    };\n    UtilityObj.prototype.VueErrorHandling = function() {\n        if (typeof Vue === \"undefined\") { return false; } /*global Vue */\n        var self = this;\n        Vue.config.errorHandler = function (err, vm, info)  {\n            var handler, current = vm;\n            if (vm.$options.errorHandler) {\n                handler = vm.$options.errorHandler;\n            } else {\n                while (!handler && current.$parent) {\n                    current = current.$parent;\n                    handler = current.$options.errorHandler;\n                }\n            }\n            self.restoreVis();\n            if (handler) {\n                handler.call(current, err, vm, info);\n                return;\n            }\n            console.log(err);\n        };\n    };\n    UtilityObj.prototype.extend = function(obj, extension) { // Extend an object with an extension\n        for (var key in extension) {\n            if (extension.hasOwnProperty(key)) {\n                obj[key] = extension[key];\n            }\n        }\n        return obj;\n    };\n    UtilityObj.prototype.getUrlParameter = function(name) {\n        name = name.replace(/[\\[]/, \"\\\\[\").replace(/[\\]]/, \"\\\\]\");\n        var regex = new RegExp(\"[\\\\?&]\" + name + \"=([^&#]*)\");\n        var results = regex.exec(location.search);\n        return results === null ? \"\" : decodeURIComponent(results[1]);\n    };\n    UtilityObj.prototype.resetBrowserBackHistory = function(locationUrl, stateObject, title) {\n        var historyDefined = typeof history !== \"undefined\" && history.pushState;\n        locationUrl = locationUrl || location.href;\n        if (historyDefined) {\n            history.pushState(stateObject, title, locationUrl);\n        }\n        window.addEventListener(\"popstate\", function() {\n            if (historyDefined) {\n                history.pushState(stateObject, title, locationUrl);\n            } else {\n                window.history.forward(1);\n            }\n        });\n    };\n    UtilityObj.prototype.handlePostLogout = function() {\n        if (typeof sessionStorage === \"undefined\") {\n            return false;\n        }\n        if (sessionStorage.getItem(\"logout\")) {\n            this.resetBrowserBackHistory(location.orgin, \"logout\"); /* global resetBrowserBackHistory */\n            sessionStorage.removeItem(\"logout\");\n        }\n    };\n    UtilityObj.prototype.displaySystemOutageMessage = function(locale) {\n        locale = locale || \"en-us\";\n        locale = locale.replace(\"_\", \"-\");\n        var systemMaintenanceElId = \"systemMaintenanceContainer\";\n        if (!document.getElementById(systemMaintenanceElId)) { //check for system outage maintenance message element\n            return;\n        }\n        var self = this;\n        this.ajaxRequest(\"api/settings\", {contentType: \"application/json; charset=utf-8\"}, function(data) {\n            if (!data || !(data.MAINTENANCE_MESSAGE || data.MAINTENANCE_WINDOW)) {\n                return false;\n            }\n            var messageElement = document.querySelector(\".message-container\");\n            if (!messageElement) {\n                messageElement = document.createElement(\"div\");\n                messageElement.classList.add(\"message-container\");\n                document.getElementById(systemMaintenanceElId).appendChild(messageElement);\n            }\n            if (data.MAINTENANCE_MESSAGE) {\n                messageElement.innerHTML = self.escapeHtml(data.MAINTENANCE_MESSAGE);\n                return;\n            }\n            if (!data.MAINTENANCE_WINDOW || !data.MAINTENANCE_WINDOW.length) {\n                return;\n            }\n            //use maintenance window specified in config to compose the message, assuming in following example format: [\"2018-11-02T12:00:00Z\", \"2018-11-02T18:00:00Z\"], dates in system ISO format\n            var hoursDiff = function(d1, d2) {\n                if (!d1 || !d2) {\n                    return 0;\n                }\n                return Math.floor(((d2.getTime() - d1.getTime())/ (1000 * 60 * 60)) % 24);\n            };\n            //date object automatically convert iso date/time to local date/time as it assumes a timezone of UTC if date in ISO format\n            var startDate = new Date(data.MAINTENANCE_WINDOW[0]), endDate = new Date(data.MAINTENANCE_WINDOW[1]);\n            var hoursTil = hoursDiff(new Date(), startDate);\n            if (hoursTil < 0 || isNaN(hoursTil)) { //maintenance window has passed\n                document.getElementById(systemMaintenanceElId).classList.add(\"tnth-hide\");\n                return;\n            }\n            /*global i18next */\n            //construct message based on maintenance window\n            try {\n                var options = {year: \"numeric\", month: \"long\", day: \"numeric\", hour: \"numeric\", minute: \"numeric\", second: \"numeric\", hour12: true, timeZoneName: \"short\"};\n                var displayStartDate = startDate.toLocaleString(locale,options).replace(/[,]/g, \" \"); //display language-sensitive representation of date/time\n                var displayEndDate = endDate.toLocaleString(locale, options).replace(/[,]/g, \" \");\n                var message = [\"<div>\" + i18next.t(\"Hi there.\") + \"</div>\",\n                    \"<div>\" + i18next.t(\"TrueNTH will be down for website maintenance starting <b>{startdate}</b>. This should last until <b>{enddate}</b>.\".replace(\"{startdate}\", displayStartDate).replace(\"{enddate}\", displayEndDate)) + \"</div>\",\n                    \"<div>\" + i18next.t(\"Thanks for your patience while we upgrade our site.\") + \"</div>\"].join(\"\");\n                messageElement.innerHTML = self.escapeHtml(message);\n            } catch(e) {\n                console.log(\"Error occurred converting system outage date/time \", e); /*eslint no-console:off */\n                document.getElementById(systemMaintenanceElId).classList.add(\"tnth-hide\");\n            }\n        });\n    };\n    return new UtilityObj();\n})();\nexport default Utility;\nexport var getExportFileName = Utility.getExportFileName; /* expose common functions */\nexport var getUrlParameter= Utility.getUrlParameter;\n","import {validateDateInputFields} from \"./modules/TnthDate.js\";\nimport tnthAjax from \"./modules/TnthAjax.js\";\nimport OrgTool from \"./modules/OrgTool.js\";\nimport Utility from \"./modules/Utility.js\";\n(function() { /*global $ Utility disableHeaderFooterLinks */\n    var FieldsChecker = function(dependencies) { //helper class to keep track of missing fields based on required/needed core data\n        this.__getDependency = function(key) {\n            if (key && this.dependencies.hasOwnProperty(key)) {\n                return this.dependencies[key];\n            } else {\n                //should show up in console\n                throw new Error(\"Dependency with key value: \" + key + \" not found.\");\n            }\n        };\n        this.userId = null;\n        this.roleRequired = false;\n        this.userRoles = [];\n        this.CONFIG_REQUIRED_CORE_DATA = null;\n        this.preselectClinic = \"\";\n        this.defaultSections = {};\n        this.mainSections = {};\n        this.dependencies = dependencies || {};\n        this.orgTool = null;\n        this.ACCEPT_ON_NEXT = false;\n\n    };\n\n    FieldsChecker.prototype.init = function(callback) {\n        var self = this;\n        this.setUserId(function() {\n            if (!self.userId) {\n                alert(\"User id is required\");\n                return false;\n            }\n            self.initConfig(function(data) {\n                self.preselectClinic = $(\"#preselectClinic\").val();\n                self.initSections();\n                self.initSectionData();\n                if (callback) {\n                    callback(data);\n                }\n            });\n        });\n    };\n\n    FieldsChecker.prototype.setUserId = function(callback) {\n        var self = this, tnthAjax = this.__getDependency(\"tnthAjax\");\n        callback = callback || function() {};\n        self.userId = $(\"#iq_userId\").val(); //set in template, check this first as API can return error\n        if (self.userId) {\n            callback();\n            return;\n        }\n        tnthAjax.getCurrentUser(function(data) {\n            if (data && data.id) {\n                self.userId = data.id;\n            }\n            callback();\n        });\n    };\n\n    FieldsChecker.prototype.getOrgTool = function() {\n        if (!this.orgTool) {\n            this.orgTool = this.__getDependency(\"orgTool\");\n            this.orgTool.init();\n        }\n        return this.orgTool;\n    };\n\n    FieldsChecker.prototype.setSectionDataLoadedFlag = function(sectionId, flag) {\n        if (!sectionId || !this.mainSections.hasOwnProperty(sectionId)) {\n            return false;\n        }\n        this.mainSections[sectionId].loaded = flag;\n    };\n\n    FieldsChecker.prototype.sectionIsLoaded = function(sectionId) {\n        if (!sectionId || !this.mainSections.hasOwnProperty(sectionId)) {\n            return false;\n        }\n        return this.mainSections[sectionId].loaded;\n    };\n\n    FieldsChecker.prototype.initSectionData = function() {\n        var self = this, sections = self.getSections(), tnthAjax = this.__getDependency(\"tnthAjax\");\n        var initDataObj = {\n            \"topTerms\": function() {\n                tnthAjax.getTerms(self.userId, \"\", \"\", function() {\n                    self.setSectionDataLoadedFlag(\"topTerms\", true);\n                });\n            },\n            \"demographicsContainer\": function() {\n                tnthAjax.getDemo(self.userId, {useWorker:true}, function() {\n                    self.setSectionDataLoadedFlag(\"demographicsContainer\", true);\n                });\n            },\n            \"clinicalContainer\": function() {\n                tnthAjax.getTreatment(self.userId, {useWorker:true}, function() {\n                    tnthAjax.getClinical(self.userId, {async:false}, function() {\n                        self.setSectionDataLoadedFlag(\"clinicalContainer\", true);\n                    });\n                });\n            },\n            \"orgsContainer\": function() {\n                tnthAjax.getDemo(self.userId, {useWorker:true}, function() {\n                    self.setSectionDataLoadedFlag(\"orgsContainer\", true);\n                });\n            }\n        };\n        for (var section in sections) {\n            if (!initDataObj.hasOwnProperty(section)) {\n                continue;\n            }\n            if (self.sectionCompleted(section)) {\n                continue;\n            }\n            initDataObj[section](); //will initialize data for the first/current incomplete section\n            break;\n        }\n    };\n\n    FieldsChecker.prototype.getSections = function() {\n        return this.mainSections;\n    };\n\n    FieldsChecker.prototype.initSections = function() {\n        this.mainSections = {};\n        var self = this;\n        $(\"#mainDiv .section-container\").each(function() {\n            var sectionId = $(this).attr(\"id\");\n            if (!sectionId) {\n                return true;\n            }\n            var sectionObj = self.mainSections[sectionId] = {};\n            sectionObj.config =  $(this).attr(\"data-config\");\n            sectionObj.display = $(this).attr(\"data-display\");\n        });\n    };\n\n    FieldsChecker.prototype.postDemoData = function(targetField) {\n        var demoArray = {}, tnthAjax = this.__getDependency(\"tnthAjax\");\n        demoArray.resourceType = \"Patient\";\n        var fname = $(\"input[name=firstname]\").val(), lname = $(\"input[name=lastname]\").val();\n        demoArray.name = {\"given\": $.trim(fname), \"family\": $.trim(lname)};\n        var y = $(\"#year\").val(), m = $(\"#month\").val(), d = $(\"#date\").val();\n        if (y && m && d) {\n            demoArray.birthDate = y + \"-\" + m + \"-\" + d;\n        }\n        var sectionId = this.getSectionContainerId(targetField);\n        tnthAjax.putDemo(this.userId, demoArray, $(\"#\"+sectionId));\n        this.handlePostEvent(sectionId);\n    };\n\n    FieldsChecker.prototype.setUserRoles = function(callback) {\n        var self = this, tnthAjax = self.__getDependency(\"tnthAjax\");\n        callback = callback || function() {};\n        tnthAjax.getRoles(this.userId, function(data) {\n            if (data.roles) {\n                self.userRoles = data.roles.map(function(item) {\n                    return item.name;\n                });\n            } else {\n                tnthAjax.removeCachedRoles();\n            }\n            self.roleRequired = self.userRoles.indexOf(\"patient\") !== -1 || self.userRoles.indexOf(\"staff\") !== -1 || self.userRoles.indexOf(\"staff_admin\") !== -1;\n            callback();\n        });\n    };\n\n    FieldsChecker.prototype.initConfig = function(callback) {\n        var self = this, tnthAjax = self.__getDependency(\"tnthAjax\");\n        tnthAjax.getStillNeededCoreData(self.userId, true, function(data) {\n            self.setConfig(data, callback);\n        });\n    };\n\n    FieldsChecker.prototype.inConfig = function(configMatch, dataArray) {\n        if (!configMatch) {\n            return false;\n        }\n        dataArray = dataArray || this.CONFIG_REQUIRED_CORE_DATA;\n        if (!dataArray || dataArray.length === 0) { return false; }\n        var found = false;\n        var ma = configMatch.split(\",\");\n        ma.forEach(function(item) {\n            if (found) { return true; } /* IMPORTANT, immediately return true. without checking this item, this is in the context of the loop, the sequence matters here, loop still continues*/\n            found = dataArray.indexOf(item) !== -1;\n        });\n        return found;\n    };\n\n    FieldsChecker.prototype.getConfig = function() {\n        return this.CONFIG_REQUIRED_CORE_DATA;\n    };\n\n    FieldsChecker.prototype.setConfig = function(data, callback) {\n        callback = callback || function() {};\n        var tnthAjax = this.__getDependency(\"tnthAjax\");\n        if (data && data.still_needed) {\n            var fields = (data.still_needed).map(function(item) {\n                return item.field;\n            });\n            this.CONFIG_REQUIRED_CORE_DATA = fields;\n            this.handleAcceptOnNext(data);\n        }\n        if (!this.CONFIG_REQUIRED_CORE_DATA) { //get default required core data\n            var self = this;\n            tnthAjax.getConfigurationByKey(\"REQUIRED_CORE_DATA\", {\n                sync: true\n            }, function(data) {\n                if (!data.error) {\n                    self.CONFIG_REQUIRED_CORE_DATA = data.REQUIRED_CORE_DATA;\n                }\n            });\n        }\n        this.setUserRoles(callback);\n    };\n\n    FieldsChecker.prototype.handleAcceptOnNext = function(data) {\n        if (!data || !data.still_needed) {\n            return false;\n        }\n        var ACCEPT_ON_NEXT = \"ACCEPT_ON_NEXT\"; /* example data format:[{\"field\": \"name\"}, {\"field\": \"website_terms_of_use\", \"collection_method\": \"ACCEPT_ON_NEXT\"}]*/\n        var acceptOnNextCheckboxes = [];\n        (data.still_needed).forEach(function(item) {\n            var matchedTermsCheckbox = $(\"#termsCheckbox [data-type='terms'][data-core-data-type='\" + $.trim(item.field) + \"']\");\n            if (matchedTermsCheckbox.length === 0) {\n                return;\n            }\n            matchedTermsCheckbox.attr({\"data-required\": \"true\",\"data-collection-method\": item.collection_method});\n            var parentNode = matchedTermsCheckbox.closest(\"label.terms-label\");\n            if (parentNode.length === 0) {\n                return;\n            }\n            parentNode.show().removeClass(\"tnth-hide\");\n            if (String(item.collection_method).toUpperCase() === ACCEPT_ON_NEXT) {\n                parentNode.find(\"i\").removeClass(\"fa-square-o\").addClass(\"fa-check-square-o\").addClass(\"edit-view\");\n                acceptOnNextCheckboxes.push(parentNode);\n            }\n        });\n        if (acceptOnNextCheckboxes.length === 0) {\n            return false;\n        }\n        this.ACCEPT_ON_NEXT = true; //set flag\n        //require for accept on next collection method\n        $(\"#termsCheckbox, #topTerms .terms-of-use-intro\").addClass(\"tnth-hide\");\n        $(\"#termsText\").addClass(\"agreed\");\n        $(\"#termsCheckbox_default\").removeClass(\"tnth-hide\");\n        $(\"#aboutForm .reg-complete-container\").addClass(\"inactive\"); //hiding thank you and continue button for accept on next collection method\n        $(\"#next\").addClass(\"accept-on-next\").on(\"click\", function() {\n            acceptOnNextCheckboxes.forEach(function(ckBox) {\n                ckBox.trigger(\"click\");\n            });\n        });\n        //show next button for data collection method of accept on next - such as organizations like Music\n        setTimeout(function() {\n            $(\"#aboutForm\").removeClass(\"tnth-hide\");\n            $(\"#next\").removeAttr(\"disabled\").addClass(\"open\");\n        }, 1000);\n    };\n\n    FieldsChecker.prototype.getTotalSections = function() {\n        return Object.keys(this.mainSections).length;\n    };\n\n    FieldsChecker.prototype.constructProgressBar = function() {\n        //don't construct progress bar when terms present\n        if ($(\"#topTerms\").length > 0 && !this.sectionCompleted(\"topTerms\")) {\n            return false;\n        }\n        var self = this;\n        var totalSections = self.getTotalSections();\n        if (totalSections <= 1) {\n            $(\"#progressWrapper\").remove();\n            return;\n        }\n        var availableSections = 0;\n        for (var section in self.mainSections) {\n            var sectionConfigs = self.getSectionConfigs(section);\n            var active = (section === \"topTerms\" && !self.inConfig(sectionConfigs)) || (self.roleRequired && !self.inConfig(sectionConfigs));\n            $(\"#progressbar\").append(\"<li sectionId='\" + section + \"'  \" + (active ? \" class='active'\" : \"\") + \">\" + self.mainSections[section].display + \"</li>\");\n            availableSections++;\n        }\n        if (availableSections === 0) {\n            return;\n        }\n        var w = (1 / availableSections) * 100;\n        $(\"#progressbar li\").each(function() {\n            $(this).css(\"width\", w + \"%\");\n        });\n        if (availableSections > 1) {\n            $(\"#progressWrapper\").show();\n        }\n    };\n\n    FieldsChecker.prototype.setProgressBar = function(sectionId) {\n        if (!sectionId) {\n            return;\n        }\n        if (this.sectionCompleted(sectionId)) {\n            $(\"#progressbar li[sectionId='\" + sectionId + \"']\").addClass(\"active\");\n        } else {\n            $(\"#progressbar li[sectionId='\" + sectionId + \"']\").removeClass(\"active\");\n        }\n    };\n\n    FieldsChecker.prototype.getSectionConfigs = function(sectionId) {\n        if (!sectionId || !this.mainSections[sectionId]) {\n            return false;\n        }\n        return this.mainSections[sectionId].config;\n    };\n\n    FieldsChecker.prototype.sectionCompleted = function(sectionId, configArray) {\n        if (!sectionId || !this.mainSections[sectionId]) {\n            return false;\n        }\n        var sectionConfigs = this.getSectionConfigs(sectionId);\n        return !this.inConfig(sectionConfigs, configArray || this.CONFIG_REQUIRED_CORE_DATA);\n    };\n\n    FieldsChecker.prototype.scrollTo = function(element) {\n        if (!element) {\n            return;\n        }\n        setTimeout(function() {\n            $(\"html, body\").stop().animate({\n                scrollTop: $(element).offset().top\n            }, 1500);\n        }(), 800);\n    };\n\n    FieldsChecker.prototype.isAcceptOnNext = function() {\n        return $(\"div.reg-complete-container\").hasClass(\"inactive\") || this.ACCEPT_ON_NEXT;\n    };\n\n    FieldsChecker.prototype.continueToFinish = function(sectionId) {\n        this.hideSectionSavingLoader(sectionId);\n        $(\"#progressWrapper\").hide();\n        $(\"#iqRefresh\").addClass(\"tnth-hide\");\n        $(\"#next\").attr(\"disabled\", true).removeClass(\"open\");\n        $(\"#buttonsContainer\").addClass(\"continue\");\n        $(\"#aboutForm\").removeClass(\"tnth-hide\");\n        $(\"div.reg-complete-container\").fadeIn();\n        this.scrollTo($(\"div.reg-complete-container\"));\n        $(\"#iqErrorMessage\").text(\"\");\n        $(\"#updateProfile\").removeAttr(\"disabled\").addClass(\"open\");\n    };\n\n    FieldsChecker.prototype.stopContinue = function(sectionId) {\n        this.hideSectionSavingLoader(sectionId);\n        $(\"#buttonsContainer\").removeClass(\"continue\");\n        $(\"#updateProfile\").attr(\"disabled\", true).removeClass(\"open\");\n        $(\"#buttonsContainer .loading-message-indicator\").hide();\n        $(\"div.reg-complete-container\").fadeOut();\n        $(\"#next\").attr(\"disabled\", true).addClass(\"open\");\n        this.setProgressBar(sectionId);\n    };\n\n    FieldsChecker.prototype.continueToNext = function(sectionId) {\n        this.setProgressBar(sectionId);\n        this.hideSectionSavingLoader(sectionId);\n        $(\"#aboutForm\").removeClass(\"tnth-hide\");\n        $(\"#iqRefresh\").addClass(\"tnth-hide\");\n        $(\"#buttonsContainer\").removeClass(\"continue\");\n        $(\"div.reg-complete-container\").fadeOut();\n        $(\"#buttonsContainer .loading-message-indicator\").hide();\n        $(\"#next\").removeAttr(\"disabled\").addClass(\"open\");\n        this.scrollTo($(\"#next\"));\n        $(\"#updateProfile\").attr(\"disabled\", true).removeClass(\"open\");\n    };\n\n    FieldsChecker.prototype.getNext = function() {\n        var found = false,\n            self = this;\n        for (var section in self.mainSections) {\n            if (!found && !self.sectionCompleted(section)) {\n                self.handleIncomplete(section);\n                $(\"#\" + section).fadeIn(500).addClass(\"open\");\n                self.stopContinue(section);\n                found = true;\n            }\n        }\n        if (!found) {\n            self.continueToFinish();\n        }\n    };\n\n    FieldsChecker.prototype.handleIncomplete = function(section) {\n        var preselectClinic = this.preselectClinic, self = this, i18next = this.__getDependency(\"i18next\");\n        var handleIncompleteFuncObj = {\n            \"topTerms\": function() {\n                $(\"#aboutForm\").addClass(\"full-size\");\n                $(\"#topTerms\").removeClass(\"hide-terms\").show();\n                if (!window.performance || self.ACCEPT_ON_NEXT) {\n                    return false;\n                }\n                if (performance.navigation.type === 1) {\n                    //page has been reloaded;\n                    var agreedCheckboxes = $(\"#topTerms [data-required][data-agree='false']\");\n                    if (agreedCheckboxes.length > 1) {\n                        $(\"#termsReminderCheckboxText\").text(i18next.t(\"You must agree to the terms and conditions by checking the provided checkboxes.\"));\n                    }\n                    if (agreedCheckboxes.length === 0) {\n                        $(\"#termsText\").addClass(\"agreed\");\n                    }\n                    $(\"#termsReminderModal\").modal(\"show\");\n                }\n                setTimeout(function() { Utility.disableHeaderFooterLinks();}, 1000);\n            },\n            \"orgsContainer\": function() {\n                if (preselectClinic) {\n                    self.handlePreSelectedClinic();\n                    var __modal = self.getConsentModal();\n                    if (__modal) {\n                        __modal.modal(\"show\");\n                    }\n                }\n                $(\"#orgsContainer\").fadeIn(500).addClass(\"open\");\n            }\n        };\n        if (!this.mainSections[section]) {\n            return false;\n        }\n        if (handleIncompleteFuncObj.hasOwnProperty(section)) {\n            handleIncompleteFuncObj[section]();\n        }\n    };\n\n    FieldsChecker.prototype.currentSectionLoaded = function() {\n        var self = this, isLoaded = true;\n        //check all\n        for (var section in self.mainSections) {\n            if (!self.mainSections.hasOwnProperty(section) || self.sectionCompleted(section)) {\n                continue;\n            }\n            if (!isLoaded) {\n                break;\n            }\n            if (!self.sectionCompleted(section)) {\n                isLoaded = self.sectionIsLoaded(section);\n                break;\n            }\n        }\n        return isLoaded;\n    };\n\n    FieldsChecker.prototype.getFieldEventType = function(field) {\n        var triggerEvent = $(field).attr(\"data-trigger-event\");\n        if (!triggerEvent) {\n            triggerEvent = ($(field).attr(\"type\") === \"text\" ? \"blur\" : \"click\");\n        }\n        if ($(field).get(0).nodeName.toLowerCase() === \"select\") {\n            triggerEvent = \"change\";\n        }\n        return triggerEvent;\n    };\n\n    FieldsChecker.prototype.initFields = function() {\n        var self = this;\n        var events = {\n            \"topTerms\": function() {\n                self.termsCheckboxEvent();\n            },\n            \"demographicsContainer\": function() {\n                self.nameGroupEvent();\n                self.bdGroupEvent();\n                self.rolesGroupEvent();\n\n            },\n            \"clinicalContainer\": function() { self.patientQEvent(); },\n            \"orgsContainer\": function() { self.clinicsEvent(); }\n        };\n        for (var sectionId in this.mainSections) {\n            if (self.sectionCompleted(sectionId)) {\n                continue;\n            }\n            if (events[sectionId]) {\n                events[sectionId]();\n            }\n        }\n    };\n\n    FieldsChecker.prototype.onFieldsDidInit = function() {\n        var self = this;\n        /****** prep work after initializing incomplete fields -set visuals e.g. top terms ************************/\n        self.constructProgressBar();\n\n        $(\"#updateProfile\").on(\"click\", function() {\n            $(this).hide();\n            $(\"#next\").removeClass(\"open\");\n            $(\".loading-message-indicator\").show();\n            $(\"#queriesForm\").submit();\n        });\n\n        $(\"#iqRefresh\").on(\"click\", function() {\n            window.location.reload();\n        });\n        /*** event for the next button ***/\n        $(\"#next\").on(\"click\", function() {\n            $(this).removeClass(\"open\"); //next button is hidden by default, the class open makes it visible\n            $(\"#buttonsContainer .loading-message-indicator\").show();\n            if (self.ACCEPT_ON_NEXT) {\n                self.handlePostEvent(\"topTerms\");\n            } else {\n                setTimeout(function() {\n                    window.location.reload();\n                }, 150);\n            }\n        });\n        /*** event for the arrow in the header**/\n        $(\"div.heading\").on(\"click\", function() {\n            $(\"html, body\").animate({\n                scrollTop: $(this).next(\"div.content-body\").children().first().offset().top\n            }, 1000);\n        });\n        $(window).bind(\"scroll mousedown mousewheel keyup\", function() {\n            if ($(\"html, body\").is(\":animated\")) {\n                $(\"html, body\").stop(true, true);\n            }\n        });\n        //if term of use form not present - need to show the form\n        if ($(\"#topTerms\").length === 0) {\n            $(\"#aboutForm\").fadeIn();\n            self.getNext();\n        } else {\n            if (!self.sectionCompleted(\"topTerms\")) {\n                self.handleIncomplete(\"topTerms\");\n            } else {\n                $(\"#aboutForm\").removeClass(\"full-size\");\n                self.getNext();\n                $(\"#aboutForm\").fadeIn();\n            }\n        }\n        setTimeout(function() {\n            $(\"#iqFooterWrapper\").show();\n        }, 500);\n    };\n\n    FieldsChecker.prototype.getSectionContainerId = function(field) {\n        return $(field).closest(\".section-container\").attr(\"id\");\n    };\n\n    FieldsChecker.prototype.handleRefreshElement = function(sectionId) {\n        if (!sectionId || $(\"#iqRefresh\").length) {\n            return;\n        }\n        var i18next = this.__getDependency(\"i18next\");\n        var contentHTML = \"<div id='iqRefresh' class='error-message tnth-hide'><i class='fa fa-refresh refresh-icon' aria-hidden='true'></i><span>{text}</span></div>\".replace(\"{text}\", i18next.t(\"Try Again\"));\n        var contentElement = $(\"#\"+sectionId).find(\".content-body\");\n        if (contentElement.length) {\n            contentElement.append(contentHTML);\n        } else {\n            $(\"#\"+sectionId).append(contentHTML);\n        }\n        $(\"#iqRefresh\").on(\"click\", function() {\n            window.location.reload();\n        });\n    };\n\n    FieldsChecker.prototype.isSavingInProgress = function(sectionId) {\n        if (!sectionId) {\n            return false;\n        }\n        return ($(\"#\"+sectionId).find(\".loading\").length > 0);\n    };\n\n    FieldsChecker.prototype.sectionHasError = function(sectionId) {\n        if (!sectionId) {\n            return false;\n        }\n        var hasError = false;\n        $(\"#\" + sectionId + \" .error-message\").each(function() { //check for errors\n            if (!hasError) { //short circuit the loop through elements\n                hasError = $(this).text() !== \"\";\n            }\n\n        });\n        return hasError;\n    };\n\n    FieldsChecker.prototype.showSectionSavingLoader = function(sectionId) {\n        if (!sectionId) {\n            return false;\n        }\n        $(\"#\"+sectionId).find(\".data-saving-indicator\").removeClass(\"tnth-hide\");\n    };\n\n    FieldsChecker.prototype.hideSectionSavingLoader = function(sectionId) {\n        if (!sectionId) {\n            return false;\n        }\n        $(\"#\"+sectionId).find(\".data-saving-indicator\").addClass(\"tnth-hide\");\n    };\n\n    FieldsChecker.prototype.handleSectionError = function(sectionId) {\n        this.stopContinue(sectionId);\n        this.handleRefreshElement(sectionId);\n        $(\"#iqRefresh\").removeClass(\"tnth-hide\");\n    };\n\n    FieldsChecker.prototype.handlePostEvent = function(sectionId) {\n        var self = this, elapsedSaveTime = 0;\n        window.startDataSavingTime = new Date();\n        window.endDataSavingTime = new Date();\n        this.showSectionSavingLoader(sectionId);\n        clearInterval(window.dataSavingIntervalId);\n        window.dataSavingIntervalId = setInterval(function() {\n            window.endDataSavingTime = new Date();\n            elapsedSaveTime = window.endDataSavingTime - window.startDataSavingTime;\n            elapsedSaveTime  /= 1000;\n            var loadingInProgress = self.isSavingInProgress(sectionId);\n            if (elapsedSaveTime < 0.5 || (loadingInProgress && elapsedSaveTime < 10)) {\n                return false;\n            }\n            window.startDataSavingTime = 0;\n            window.endDataSavingTime = 0 ;\n            clearInterval(window.dataSavingIntervalId);\n\n            var hasError = self.sectionHasError(sectionId);\n            if (hasError) {\n                self.handleSectionError(sectionId);\n                return false;\n            }\n            var tnthAjax = self.__getDependency(\"tnthAjax\");\n            tnthAjax.getStillNeededCoreData(self.userId, false, function(data) {\n                if (!data || data.error) {\n                    self.stopContinue(sectionId);\n                    return false;\n                }\n                if (self.isAcceptOnNext()) { //no need to show button(s), just continue\n                    location.reload();\n                    return;\n                }\n                if (!data.still_needed || !data.still_needed.length) {//finished all sections\n                    self.continueToFinish(sectionId);\n                    return true;\n                }\n                self.setConfig(data, function(){\n                    setTimeout(function() {\n                        self.hideSectionSavingLoader(sectionId);\n                    }, 50);\n                    if (self.sectionCompleted(sectionId)) {\n                        self.continueToNext(sectionId);\n                    }\n                });\n            });\n        }, 150);\n    };\n\n    FieldsChecker.prototype.updateTerms = function(data) {\n        function typeInTous(type, status) {\n            var found = false, isActive = String(status) === \"active\";\n            (data.tous).forEach(function(item) {\n                if (!found &&\n                    ($.trim(item.type) === $.trim(type)) &&\n                    (String($.trim(item.active)) === String(isActive))) {\n                    found = true;\n                }\n            });\n            return found;\n        }\n        if (data.tous) {\n            $(\"#termsCheckbox label.terms-label\").each(function() {\n                var item_found = 0;\n                var self = $(this);\n                self.find(\"[data-type='terms']\").each(function() {\n                    var type = $(this).attr(\"data-tou-type\");\n                    if (typeInTous(type, \"active\")) {\n                        item_found++;\n                        $(\"#termsCheckbox [data-tou-type='\" + type + \"']\").attr(\"data-agree\", \"true\"); //set the data-agree attribute for the corresponding consent item\n                    }\n                    if (typeInTous(type, \"inactive\")) {\n                        self.attr(\"data-reconsent\", \"true\");\n                        self.closest(\"#termsCheckbox\").attr(\"data-reconsent\", \"true\");\n                    }\n                });\n                if (item_found > 0) {\n                    if (self.find(\"[data-agree='false']\").length === 0) { // make sure that all items are agreed upon before checking the box\n                        self.find(\"i\").removeClass(\"fa-square-o\").addClass(\"fa-check-square-o\").addClass(\"edit-view\");\n                        var vs = self.find(\".display-view\");\n                        if (vs.length > 0) {\n                            self.show();\n                            vs.show();\n                            (self.find(\".edit-view\")).each(function() {\n                                $(this).hide();\n                            });\n                        } else {\n                            self.hide();\n                            return true;\n                        }\n                    }\n                    self.show().removeClass(\"tnth-hide\");\n                }\n            });\n        }\n    };\n\n    FieldsChecker.prototype.termsCheckboxEvent = function() {\n        var __self = this;\n        var userId = __self.userId, tnthAjax = this.__getDependency(\"tnthAjax\"), orgTool = this.getOrgTool();\n        var termsEvent = function() {\n            if ($(this).attr(\"data-agree\") !== \"false\") {\n                return;\n            }\n            var types = $(this).attr(\"data-tou-type\");\n            if (!types) {\n                return;\n            }\n            var arrTypes = types.split(\",\"), dataUrl = $(this).attr(\"data-url\");\n            arrTypes.forEach(function(type) {\n                if ($(\"#termsCheckbox [data-agree='true'][data-tou-type='\" + type + \"']\").length > 0) { //if already agreed, don't post again\n                    return true;\n                }\n                var theTerms = {};\n                theTerms[\"agreement_url\"] = dataUrl ? dataUrl : $(\"#termsURL\").data().url;\n                theTerms[\"type\"] = type;\n                var org = $(\"#userOrgs input[name='organization']:checked\"),\n                    userOrgId = org.val();\n                /*** if UI for orgs is not present, need to get the user org from backend ***/\n                if (!userOrgId) {\n                    $.ajax({\n                        type: \"GET\",\n                        url: \"/api/demographics/\" + userId,\n                        async: false\n                    }).done(function(data) {\n                        if (data && data.careProvider) {\n                            (data.careProvider).forEach(function(item) {\n                                if (!userOrgId) {\n                                    userOrgId = item.reference.split(\"/\").pop();\n                                    return true;\n                                }\n                            });\n                        }\n                    }).fail(function() {});\n                }\n                if (userOrgId && parseInt(userOrgId) !== 0 && !isNaN(parseInt(userOrgId))) {\n                    var topOrg = orgTool.getTopLevelParentOrg(userOrgId);\n                    theTerms[\"organization_id\"] = topOrg || userOrgId;\n                }\n                if (!theTerms[\"agreement_url\"]) { //this will display error to user if information is missing - can't check for org id as user might not belong to an org just yet\n                    $(\"#topTerms .post-tou-error\").html(i18next.t(\"Missing information for consent agreement.  Unable to complete request.\"));\n                    return;\n                }\n                tnthAjax.postTerms(theTerms, $(\"#topTerms\")); // Post terms agreement via API\n            });\n            // Update UI\n            if (this.nodeName.toLowerCase() === \"label\") {\n                $(this).find(\"i\").removeClass(\"fa-square-o\").addClass(\"fa-check-square-o\");\n            } else {\n                $(this).closest(\"label\").find(\"i\").removeClass(\"fa-square-o\").addClass(\"fa-check-square-o\");\n            }\n            //adding css rule here so the checkbox won't be hidden on click\n            $(this).attr(\"current\", \"true\");\n            $(this).attr(\"data-agree\", \"true\");\n\n            var coreTypes = [], parentCoreType = $(this).attr(\"data-core-data-type\");\n            if (parentCoreType) {\n                coreTypes.push(parentCoreType);\n            }\n            $(this).closest(\"label\").find(\"[data-core-data-type]\").each(function() {\n                var coreDataType = $(this).attr(\"data-core-data-type\");\n                if($.inArray(coreDataType, coreTypes) === -1) {\n                    coreTypes.push(coreDataType);\n                }\n            });\n            if (coreTypes.length > 0) { //need to delete notification for each corresponding coredata terms type once user has agreed\n                coreTypes.forEach(function(type) {\n                    var notificationEntry = $(\"#notificationBanner [data-name='\" + type + \"_update']\");\n                    if (notificationEntry.length > 0) {\n                        try {\n                            window.portalModules.Global.deleteNotification($(\"#notificationUserId\").val(), notificationEntry.attr(\"data-id\")); /*global Global */\n                        } catch(e) {\n                            alert(i18next.t(\"Error occurred deleting notification\"));\n                        }\n                    }\n                });\n            }\n            __self.handlePostEvent(__self.getSectionContainerId($(this)));\n        };\n        $(\"#topTerms label.terms-label\").each(function() { //account for the fact that some terms items are hidden as child elements to a label\n            $(this).on(\"click\", function() {\n                if ($(this).attr(\"data-required\")) {\n                    termsEvent.apply(this);\n                } else {\n                    $(this).find(\"[data-required]\").each(function() {\n                        termsEvent.apply(this);\n                    });\n                }\n            });\n        });\n\n        $(\"#topTerms [data-type='terms'][data-required='true']\").each(function() {\n            $(this).on(__self.getFieldEventType($(this)), termsEvent);\n        });\n\n        $(\"#topTerms .required-link\").each(function() {\n            $(this).on(\"click\", function(e) {\n                e.stopPropagation();\n            });\n        });\n    };\n\n    FieldsChecker.prototype.nameGroupEvent = function() {\n        var self = this;\n        $(\"#firstname, #lastname\").each(function() {\n            $(this).on(self.getFieldEventType($(this)), function() {\n                if ($(this).val() !== \"\") {\n                    self.postDemoData($(this));\n                }\n            });\n        });\n    };\n\n    FieldsChecker.prototype.bdGroupEvent = function() {\n        var self = this;\n        $(\"#month, #date, #year\").each(function() {\n            $(this).on(self.getFieldEventType($(this)), function() {\n                var d = $(\"#date\"), m = $(\"#month\"), y = $(\"#year\");\n                var isValid = validateDateInputFields(m, d, y, \"errorbirthday\");\n                if (!isValid) {\n                    return false;\n                }\n                $(\"#birthday\").val(y.val() + \"-\" + m.val() + \"-\" + d.val());\n                $(\"#errorbirthday\").text(\"\").hide();\n                self.postDemoData($(this));\n            });\n        });\n        $(\"#date, #year\").prop(\"type\", \"tel\");\n    };\n\n    FieldsChecker.prototype.rolesGroupEvent = function() {\n        var self = this, tnthAjax = this.__getDependency(\"tnthAjax\");\n        $(\"input[name='user_type']\").on(\"click\", function() {\n            var roles = [], theVal = $(this).val();\n            roles.push({name: theVal});\n            tnthAjax.putRoles(self.userId,{\"roles\": roles}, $(\"#rolesGroup\"));\n            self.handlePostEvent(self.getSectionContainerId($(this)));\n        });\n    };\n\n    FieldsChecker.prototype.patientQEvent = function() {\n        var self = this;\n        $(\"#patientQ [data-topic] input[type='radio']\").on(\"click\", function() {\n            var thisItem = $(this);\n            var toCall = thisItem.attr(\"name\") || thisItem.attr(\"data-name\");\n            var toSend = (toCall === \"biopsy\" ? ($(\"#patientQ input[name='biopsy']:checked\").val()) : thisItem.val());\n            if (toSend === \"true\" || toCall === \"pca_localized\") {\n                if (toCall === \"biopsy\" && !$(\"#biopsyDate\").val()) {\n                    return true;\n                }\n                thisItem.parents(\".pat-q\").next().fadeIn(150);\n                var nextRadio = thisItem.closest(\".pat-q\").next(\".pat-q\");\n                var nextItem = nextRadio.length > 0 ? nextRadio : thisItem.parents(\".pat-q\").next();\n                if (nextItem.length > 0) {\n                    var checkedRadio = nextItem.find(\"input[type='radio']:checked\");\n                    if (!(checkedRadio.length > 0)) {\n                        $(\"html, body\").animate({scrollTop: nextItem.offset().top}, 1000);\n                    }\n                }\n            } else {\n                thisItem.parents(\".pat-q\").nextAll().fadeOut(150);\n            }\n            self.handlePostEvent(self.getSectionContainerId($(this)));\n        });\n    };\n    FieldsChecker.prototype.getConsentModal = function(parentOrg) {\n        var orgTool = this.getOrgTool();\n        parentOrg = parentOrg || orgTool.getElementParentOrg(orgTool.getSelectedOrg());\n        if (parentOrg) {\n            var __modal = $(\"#\" + parentOrg + \"_consentModal\");\n            if (__modal.length > 0) {\n                return __modal;\n            } else {\n                var __defaultModal = $(\"#\" + parentOrg + \"_defaultConsentModal\");\n                if (__defaultModal.length > 0) {\n                    return __defaultModal;\n                }\n            }\n            return false;\n        } else {\n            return false;\n        }\n    };\n    FieldsChecker.prototype.handlePreSelectedClinic = function() {\n        var preselectClinic = $(\"#preselectClinic\").val(), orgTool = this.getOrgTool();\n        if (preselectClinic) {\n            var ob = $(\"#userOrgs input[value='\" + preselectClinic + \"']\");\n            if (ob.length > 0) {\n                ob.prop(\"checked\", true);\n                var parentOrg = orgTool.getElementParentOrg(orgTool.getSelectedOrg());\n                var __modal = this.getConsentModal(parentOrg);\n                if (__modal) {\n                    ob.attr(\"data-require-validate\", \"true\");\n                }\n                var stateContainer = ob.closest(\".state-container\");\n                var st = stateContainer.attr(\"state\");\n                if (stateContainer.length > 0 && st) {\n                    $(\"#stateSelector\").find(\"option[value='\" + st + \"']\").prop(\"selected\", true).val(st);\n                    stateContainer.show();\n                }\n            }\n        }\n    };\n\n    FieldsChecker.prototype.clinicsEvent = function() {\n        var self = this;\n        $(\"#userOrgs input[name='organization']\").not(\"[type='hidden']\").on(\"click\", function() {\n            if ($(this).prop(\"checked\")) {\n                var parentOrg = $(this).attr(\"data-parent-id\"), m = $(\"#consentContainer .modal, #defaultConsentContainer .modal\");\n                var requiringConsentViaModal = ($(\"#fillOrgs\").attr(\"patient_view\") && m.length > 0 && parseInt($(this).val()) !== 0);\n                if (requiringConsentViaModal) { //do nothing\n                    return true;\n                }\n                self.handlePostEvent(self.getSectionContainerId($(this)));\n\n            }\n        });\n        $(\"#stateSelector\").on(\"change\", function() {\n            if (!$(this).val()) {\n                return;\n            }\n            self.scrollTo($(\"#clinics .state-selector-container.selector-show\"));\n        });\n        /*** event for consent popups **/\n        $(\"#consentContainer .modal, #defaultConsentContainer .modal\").each(function() {\n            $(this).on(\"hidden.bs.modal\", function() {\n                if ($(this).find(\"input[name='toConsent']:checked\").length > 0) {\n                    $(\"#userOrgs input[name='organization']\").each(function() {\n                        $(this).removeAttr(\"data-require-validate\");\n                    });\n                    self.handlePostEvent(self.getSectionContainerId($(this)));\n                }\n            });\n        });\n    };\n    window.FieldsChecker = FieldsChecker;\n\n    $(document).ready(function() {\n        /*\n         * the flow here :\n         * get still needed core data\n         * populate all required fields\n         * get incomplete fields thereafter\n         * note: need to delay gathering incomplete fields to allow fields to be render\n         */\n        if ($(\"#aboutForm\").length > 0 || $(\"#topTerms\").length > 0) { /*global i18next, tnthAjax, OrgTool, tnthDates*/\n            var fc = window.fc = new window.FieldsChecker({\n                i18next: i18next,\n                tnthAjax: tnthAjax,\n                orgTool: new OrgTool()\n            });\n            var DELAY_LOADING = false;\n            fc.init(function() {\n                fc.startTime = new Date();\n                DELAY_LOADING = true; /*global DELAY_LOADING */\n                clearInterval(fc.intervalId);\n                fc.intervalId = setInterval(function() {\n                    fc.endTime = new Date();\n                    var elapsedTime = fc.endTime - fc.startTime;\n                    elapsedTime /= 1000;\n                    if (fc.currentSectionLoaded() || elapsedTime >= 5) {\n                        setTimeout(function() {\n                            fc.initFields();\n                            fc.onFieldsDidInit();\n                            Utility.showMain(); /* global showMain */\n                            Utility.hideLoader(true); /* global hideLoader */\n                        }, 300);\n                        fc.startTime = 0;\n                        fc.endTime = 0;\n                        clearInterval(fc.intervalId);\n                    }\n                }, 100);\n            });\n        }\n    });\n})();\n","var tnthDates =  { /*global i18next */\n    /** validateDateInputFields  check whether the date is a sensible date in month, day and year fields.\n     ** params: month, day and year fields and error field ID\n     ** NOTE this can replace the custom validation check; hook this up to the onchange/blur event of birthday field\n     ** work better in conjunction with HTML5 native validation check on the field e.g. required, pattern match  ***/\n    \"validateDateInputFields\": function(monthField, dayField, yearField, errorFieldId) {\n        var m = $(monthField).val(), d = $(dayField).val(), y = $(yearField).val();\n        if (m && d && y) {\n            if ($(yearField).get(0).validity.valid && $(monthField).get(0).validity.valid && $(dayField).get(0).validity.valid) {\n                m = parseInt(m);\n                d = parseInt(d);\n                y = parseInt(y);\n                var errorField = $(\"#\" + errorFieldId);\n\n                if (!(isNaN(m)) && !(isNaN(d)) && !(isNaN(y))) {\n                    var today = new Date();\n                    var date = new Date(y, m - 1, d);\n                    if (!(date.getFullYear() === y && (date.getMonth() + 1) === m && date.getDate() === d)) { // Check to see if this is a real date\n                        errorField.html(i18next.t(\"Invalid date. Please try again.\")).show();\n                        return false;\n                    } else if (date.setHours(0, 0, 0, 0) > today.setHours(0, 0, 0, 0)) {\n                        errorField.html(i18next.t(\"Date must not be in the future. Please try again.\")).show();\n                        return false; //shouldn't be in the future\n                    } else if (y < 1900) {\n                        errorField.html(i18next.t(\"Date must not be before 1900. Please try again.\")).show();\n                        return false;\n                    }\n                    errorField.html(\"\").hide();\n                    return true;\n                } else {\n                    return false;\n                }\n            } else {\n                return false;\n            }\n        } else {\n            return false;\n        }\n    },\n    /**\n     * Simply swaps: a/b/cdef to b/a/cdef (single & double digit permutations accepted...)\n     * Does not check for valid dates on input or output!\n     * @param currentDate string eg 7/4/1976\n     * @returns string eg 4/7/1976\n     */\n    \"swap_mm_dd\": function(currentDate) {\n        var splitDate = currentDate.split(\"/\");\n        return splitDate[1] + \"/\" + splitDate[0] + \"/\" + splitDate[2];\n    },\n    \"convertMonthNumeric\": function(month) { //Convert month string to numeric\n        if (!month) { return \"\"; }\n        else {\n            var month_map = {\"jan\": 1,\"feb\": 2,\"mar\": 3,\"apr\": 4,\"may\": 5,\"jun\": 6,\"jul\": 7,\"aug\": 8,\"sep\": 9,\"oct\": 10,\"nov\": 11,\"dec\": 12};\n            var m = month_map[month.toLowerCase()];\n            return m ? m : \"\";\n        }\n    },\n    \"convertMonthString\": function(month) { //Convert month string to text\n        if (!month) {\n            return \"\";\n        } else {\n            var numeric_month_map = {1: \"Jan\",2: \"Feb\",3: \"Mar\",4: \"Apr\",5: \"May\",6: \"Jun\",7: \"Jul\",8: \"Aug\",9: \"Sep\",10: \"Oct\",11: \"Nov\",12: \"Dec\"};\n            var m = numeric_month_map[parseInt(month)];\n            return m ? m : \"\";\n        }\n    },\n    \"isDate\": function(obj) {\n        return Object.prototype.toString.call(obj) === \"[object Date]\" && !isNaN(obj.getTime());\n    },\n    \"displayDateString\": function(m, d, y) {\n        var s = \"\";\n        s += (d ? d : \"\");\n        if (m) {\n            s += (s ? \" \" : \"\") + this.convertMonthString(m);\n        }\n        if (y) {\n            s += (s ? \" \" : \"\") + y;\n        }\n        return s;\n    },\n    /***\n     * Calculates number of days between two dates. Used in mPOWEr for surgery/discharge\n     * @param startDate - required. Assumes YYYY-MM-DD. This is typically the date of surgery or discharge\n     * @param dateToCalc - optional. If empty, then assumes today's date\n     * @returns number of days\n     */\n    \"getDateDiff\": function(startDate, dateToCalc) {\n        if (!startDate) {\n            return 0;\n        }\n        var a = startDate.split(/[^0-9]/);\n        var dateTime = new Date(a[0], a[1] - 1, a[2]).getTime();\n        var d;\n        if (dateToCalc) {\n            var c = dateToCalc.split(/[^0-9]/);\n            d = new Date(c[0], c[1] - 1, c[2]).getTime();\n        } else { // If no baseDate, then use today to find the number of days between dateToCalc and today\n            d = new Date().getTime();\n        }\n        return Math.floor((d - dateTime) / (1000 * 60 * 60 * 24)); // Round down to floor so we don't add an extra day if session is 12+ hours into the day\n    },\n    \"isValidDefaultDateFormat\": function(date, errorField) {\n        if (!date || date.length < 10) { return false; }\n        var dArray = $.trim(date).split(\" \");\n        if (dArray.length < 3) { return false; }\n        var day = parseInt(dArray[0])+\"\", month = dArray[1], year = dArray[2];\n        if (day.length < 1 || month.length < 3 || year.length < 4) { return false; }\n        if (!/(0)?[1-9]|1\\d|2\\d|3[01]/.test(day)) { return false; }\n        if (!/jan|feb|mar|apr|may|jun|jul|aug|sep|oct|nov|dec/i.test(month)) { return false; }\n        if (!/(19|20)\\d{2}/.test(year)) { return false; }\n        var dt = new Date(date);\n        if (!this.isDateObj(dt)) { return false; }\n        else if (!this.isValidDate(year, this.convertMonthNumeric(month), day)) {\n            return false;\n        } else {\n            var today = new Date(),\n                errorMsg = \"\";\n            if (dt.getFullYear() < 1900) { errorMsg = \"Year must be after 1900\"; }\n            // Only allow if date is before today\n            if (dt.setHours(0, 0, 0, 0) > today.setHours(0, 0, 0, 0)) {\n                errorMsg = \"The date must not be in the future.\";\n            }\n            if (errorMsg) {\n                $(errorField).text(errorMsg);\n                return false;\n            } else {\n                $(errorField).text(\"\");\n                return true;\n            }\n        }\n    },\n    \"isDateObj\": function(d) {\n        return Object.prototype.toString.call(d) === \"[object Date]\" && !isNaN(d.getTime());\n    },\n    \"isValidDate\": function(y, m, d) {\n        var date = this.getDateObj(y, m, d), convertedDate = this.getConvertedDate(date), givenDate = this.getGivenDate(y, m, d);\n        return String(givenDate) === String(convertedDate);\n    },\n    /*\n     * method does not check for valid numbers, will return NaN if conversion failed\n     */\n    \"getDateObj\": function(y, m, d, h, mi, s) {\n        h = h || 0;\n        mi = mi || 0;\n        s = s || 0;\n        return new Date(parseInt(y), parseInt(m) - 1, parseInt(d), parseInt(h), parseInt(mi), parseInt(s));\n    },\n    \"getConvertedDate\": function(dateObj) {\n        if (dateObj && this.isDateObj(dateObj)) { return \"\" + dateObj.getFullYear() + (dateObj.getMonth() + 1) + dateObj.getDate(); }\n        else { return \"\"; }\n    },\n    \"getGivenDate\": function(y, m, d) {\n        return \"\" + y + m + d;\n    },\n    \"formatDateString\": function(dateString, format) { //NB For dateString in ISO-8601 format date as returned from server e.g. '2011-06-29T16:52:48'\n        if (dateString) {\n            var iosDateTest = /^([\\+-]?\\d{4}(?!\\d{2}\\b))((-?)((0[1-9]|1[0-2])(\\3([12]\\d|0[1-9]|3[01]))?|W([0-4]\\d|5[0-2])(-?[1-7])?|(00[1-9]|0[1-9]\\d|[12]\\d{2}|3([0-5]\\d|6[1-6])))([T\\s]((([01]\\d|2[0-3])((:?)[0-5]\\d)?|24\\:?00)([\\.,]\\d+(?!:))?)?(\\17[0-5]\\d([\\.,]\\d+)?)?([zZ]|([\\+-])([01]\\d|2[0-3]):?([0-5]\\d)?)?)?)?$/;\n            var d = new Date(dateString);\n            var day, month, year, hours, minutes, seconds, nd;\n            if (!iosDateTest && !isNaN(d) && !this.isDateObj(d)) { //note instantiating ios formatted date using Date object resulted in error in IE\n                return \"\";\n            }\n            if (iosDateTest.test(dateString)) {\n                //IOS date, no need to convert again to date object, just parse it as is\n                //issue when passing it into Date object, the output date is inconsistent across from browsers\n                var dArray = $.trim($.trim(dateString).replace(/[\\.TZ:\\-]/gi, \" \")).split(\" \");\n                year = dArray[0];\n                month = dArray[1];\n                day = dArray[2];\n                hours = dArray[3] || \"0\";\n                minutes = dArray[4] || \"0\";\n                seconds = dArray[5] || \"0\";\n            } else {\n                day = d.getDate();\n                month = d.getMonth() + 1;\n                year = d.getFullYear();\n                hours = d.getHours();\n                minutes = d.getMinutes();\n                seconds = d.getSeconds();\n                nd = \"\";\n            }\n            var pad = function(n) {n = parseInt(n); return (n < 10) ? \"0\" + n : n;};\n            day = pad(day);\n            month = pad(month);\n            hours = pad(hours);\n            minutes = pad(minutes);\n            seconds = pad(seconds);\n\n            switch (format) {\n            case \"mm/dd/yyyy\":\n                nd = month + \"/\" + day + \"/\" + year;\n                break;\n            case \"mm-dd-yyyy\":\n                nd = month + \"-\" + day + \"-\" + year;\n                break;\n            case \"mm-dd-yyyy hh:mm:ss\":\n                nd = month + \"-\" + day + \"-\" + year + \" \" + hours + \":\" + minutes + \":\" + seconds;\n                break;\n            case \"dd/mm/yyyy\":\n                nd = day + \"/\" + month + \"/\" + year;\n                break;\n            case \"dd/mm/yyyy hh:mm:ss\":\n                nd = day + \"/\" + month + \"/\" + year + \" \" + hours + \":\" + minutes + \":\" + seconds;\n                break;\n            case \"dd-mm-yyyy\":\n                nd = day + \"-\" + month + \"-\" + year;\n                break;\n            case \"dd-mm-yyyy hh:mm:ss\":\n                nd = day + \"-\" + month + \"-\" + year + \" \" + hours + \":\" + minutes + \":\" + seconds;\n                break;\n            case \"iso-short\":\n            case \"yyyy-mm-dd\":\n                nd = year + \"-\" + month + \"-\" + day;\n                break;\n            case \"iso\":\n            case \"yyyy-mm-dd hh:mm:ss\":\n                nd = year + \"-\" + month + \"-\" + day + \" \" + hours + \":\" + minutes + \":\" + seconds;\n                break;\n            case \"system\":\n                nd = year + \"-\" + month + \"-\" + day + \"T\" + hours + \":\" + minutes + \":\" + seconds + \"Z\";\n                break;\n            case \"d M y hh:mm:ss\":\n                nd = this.displayDateString(month, day, year);\n                nd = nd + \" \" + hours + \":\" + minutes + \":\" + seconds;\n                break;\n            case \"d M y\":\n                nd = this.displayDateString(month, day, year);\n                break;\n            default:\n                nd = this.displayDateString(month, day, year);\n                break;\n            }\n            return nd;\n        } else {\n            return \"\";\n        }\n    },\n    \"convertToLocalTime\": function(dateString) {\n        var convertedDate = \"\";\n        if (dateString) { //assuming dateString is UTC date/time\n            var d = new Date(dateString);\n            var newDate = new Date(d.getTime() + d.getTimezoneOffset() * 60 * 1000);\n            var offset = d.getTimezoneOffset() / 60;\n            var hours = d.getHours();\n            newDate.setHours(hours - offset);\n            var options = {year: \"numeric\", day: \"numeric\", month: \"short\", hour: \"numeric\", minute: \"numeric\", second: \"numeric\", hour12: false};\n            convertedDate = newDate.toLocaleString(options);\n        }\n        return convertedDate;\n    },\n    getDateWithTimeZone: function(dObj) {\n        /*\n         * param is a date object - calculating UTC date using Date object's timezoneOffset method\n         * the method return offset in minutes, so need to convert it to miliseconds - adding the resulting offset will be the UTC date/time\n         */\n        var utcDate = new Date(dObj.getTime() + (dObj.getTimezoneOffset()) * 60 * 1000);\n        return this.formatDateString(utcDate, \"yyyy-mm-dd hh:mm:ss\");  //I believe this is a valid python date format, will save it as GMT date/time NOTE, conversion already occurred, so there will be no need for backend to convert it again\n    },\n    getTodayDateObj: function() { //return object containing today's date/time information\n        var today = new Date();\n        var td = today.getDate(), tm = today.getMonth() + 1, ty = today.getFullYear();\n        var th = today.getHours(), tmi = today.getMinutes(), ts = today.getSeconds();\n        var gmtToday = this.getDateWithTimeZone(this.getDateObj(ty, tm, td, th, tmi, ts));\n        var pad = function(n) {n = parseInt(n); return (n < 10) ? \"0\" + n : n;};\n        return {\n            date: today,\n            day: td,\n            month: tm,\n            year: ty,\n            hour: th,\n            minute: tmi,\n            second: ts,\n            displayDay: pad(td),\n            displayMonth: pad(tm),\n            displayYear: pad(ty),\n            displayHour: pad(th),\n            displayMinute: pad(tmi),\n            displaySecond: pad(ts),\n            gmtDate: gmtToday\n        };\n    },\n    dateValidator: function(day, month, year, restrictToPresent) { //parameters: day, month and year values in numeric, boolean value for restrictToPresent, true if the date needs to be before today, false is the default\n        var errorMessage = \"\";\n        if (day && month && year) {\n            var iy = parseInt(year), im = parseInt(month), iid = parseInt(day), date = new Date(iy, im - 1, iid);\n            if (date.getFullYear() === iy && (date.getMonth() + 1) === im && date.getDate() === iid) { // Check to see if this is a real date\n                if (iy < 1900) {\n                    errorMessage = i18next.t(\"Year must be after 1900\");\n                }\n                if (restrictToPresent) { // Only allow if date is before today\n                    var today = new Date();\n                    if (date.setHours(0, 0, 0, 0) > today.setHours(0, 0, 0, 0)) {\n                        errorMessage = i18next.t(\"The date must not be in the future.\");\n                    }\n                }\n            } else {\n                errorMessage = i18next.t(\"Invalid Date. Please enter a valid date.\");\n            }\n        } else {\n            errorMessage = i18next.t(\"Missing value.\");\n        }\n        return errorMessage;\n    }\n};\nexport default tnthDates;\nexport var validateDateInputFields = tnthDates.validateDateInputFields; /* generic validation function for global use */\n\n","export default {\n    \"biopsy\": {\n        code: \"111\",\n        display: \"biopsy\"\n    },\n    \"pca_diag\": {\n        code: \"121\",\n        display: \"PCa diagnosis\"\n    },\n    \"pca_localized\": {\n        code: \"141\",\n        display: \"PCa localized diagnosis\"\n    }\n};\n\n","import Utility from \"./Utility.js\";\nimport tnthDates from \"./TnthDate.js\";\nimport SYSTEM_IDENTIFIER_ENUM from \"./SYSTEM_IDENTIFIER_ENUM.js\";\nimport CLINICAL_CODE_ENUM from \"./CLINICAL_CODE_ENUM.js\";\nexport default { /*global $ */\n    \"beforeSend\": function() {\n        $.ajaxSetup({\n            beforeSend: function(xhr, settings) {\n                if (!/^(GET|HEAD|OPTIONS|TRACE)$/i.test(settings.type) && !this.crossDomain) {\n                    xhr.setRequestHeader(\"X-CSRFToken\", $(\"#__CRSF_TOKEN\").val());\n                }\n            }\n        });\n    },\n    \"sendRequest\": function(url, method, userId, params, callback) {\n        if (!url) { return false; }\n        var defaultParams = {type: method ? method : \"GET\", url: url, attempts: 0, max_attempts: 3, contentType: \"application/json; charset=utf-8\", dataType: \"json\", sync: false, timeout: 5000, data: null, useWorker: false, async: true};\n        params = params || defaultParams;\n        params = $.extend({}, defaultParams, params);\n        params.async = params.sync ? false: params.async;\n        var self = this;\n        var fieldHelper = this.FieldLoaderHelper, targetField = params.targetField || null;\n        callback = callback || function() {};\n        params.attempts++;\n        fieldHelper.showLoader(targetField);\n        if (params.useWorker && window.Worker && !Utility.isTouchDevice()) { /*global isTouchDevice()*/\n            Utility.initWorker(url, params, function(result) { /*global initWorker*/\n                var data;\n                try {\n                    data = JSON.parse(result);\n                } catch(e) {\n                    callback({error: \"Error occurred parsing data for \" + url});\n                    return false;\n                }\n                if (!data) {\n                    callback({\"error\": true, \"data\": \"no data returned\"});\n                    fieldHelper.showError(targetField);\n                } else if (data.error) {\n                    callback({\"error\": true, \"data\": data});\n                    self.sendError(data, url, userId, params);\n                    fieldHelper.showError(targetField);\n                } else {\n                    callback(data);\n                    fieldHelper.showUpdate(targetField);\n                }\n            });\n            return true;\n        }\n        if (!params.cache) {\n            params.headers = {\n                \"cache-control\": \"no-cache\",\n                \"expires\": \"-1\",\n                \"pragma\": \"no-cache\"\n            };\n        }\n        $.ajax(params).done(function(data) {\n            params.attempts = 0;\n            if (data) {\n                fieldHelper.showUpdate(targetField);\n                callback(data);\n            } else {\n                fieldHelper.showError(targetField);\n                callback({\"error\": true, \"data\": \"no data returned\"});\n            }\n        }).fail(function(xhr) {\n            if (params.attempts < params.max_attempts) {\n                (function(self, url, method, userId, params, callback) {\n                    setTimeout(function() {\n                        self.sendRequest(url, method, userId, params, callback);\n                    }, 3000); //retry after 3 seconds\n                })(self, url, method, userId, params, callback);\n            } else {\n                params.attempts = 0;\n                fieldHelper.showError(targetField);\n                callback({\"error\": true, \"data\": xhr});\n                self.sendError(xhr, url, userId, params);\n            }\n        });\n    },\n    \"sendError\": function(xhr, url, userId, params) {\n        if (!xhr) { return false; }\n        var errorMessage = \"[Error occurred processing request]  status - \" + (parseInt(xhr.status) === 0 ? \"request timed out/network error\" : xhr.status) + \", response text - \" + (xhr.responseText ? xhr.responseText : \"no response text returned from server\");\n        if (params) {\n            try {\n                errorMessage += \" [data sent]: \" + JSON.stringify(params); //error can happen if for some reason the params are malformed\n            } catch(e) {\n                errorMessage += \" Error occurred transforming sent data: \" + e.message;\n            }\n        }\n        this.reportError(userId ? userId : \"Not available\", url, errorMessage, true);\n    },\n    \"reportError\": function(userId=0, page_url, message, sync) {\n        //params need to contain the following: subject_id: User on which action is being attempted message: Details of the error event page_url: The page requested resulting in the error\n        var params = {};\n        page_url = page_url || window.location.href;\n        params.subject_id = userId;\n        params.page_url = page_url;\n        params.message = \"Error generated in JS - \" + (message ? message.replace(/[\"']/g, \"\") : \"no detail available\"); //don't think we want to translate message sent back to the server here\n        console.log(\"Errors occurred.....\"); /*eslint no-console: off */\n        console.log(params); /*global console*/\n        $.ajax({\n            type: \"GET\",\n            url: \"/report-error\",\n            contentType: \"application/json; charset=utf-8\",\n            cache: false,\n            async: (sync ? false : true),\n            data: params\n        }).done(function() {}).fail(function() {});\n    },\n    \"FieldLoaderHelper\": {\n        delayDuration: 300,\n        showLoader: function(targetField) {\n            if (!targetField || targetField.length === 0) { return false; }\n            var el = $(\"#\" + (targetField.attr(\"data-save-container-id\") || targetField.attr(\"id\")) + \"_load\");\n            el.css(\"opacity\", 1);\n            el.addClass(\"loading\");\n        },\n        showUpdate: function(targetField) {\n            var __timeout = this.delayDuration;\n            if (!targetField || targetField.length === 0) { return false; }\n            setTimeout(function() {\n                (function(targetField) {\n                    var containerId = targetField.attr(\"data-save-container-id\") || targetField.attr(\"id\");\n                    var errorField = $(\"#\" + containerId + \"_error\");\n                    var successField = $(\"#\" + containerId + \"_success\");\n                    var loadingField = $(\"#\" + containerId + \"_load\");\n                    loadingField.removeClass(\"loading\");\n                    errorField.text(\"\").css(\"opacity\", 0);\n                    successField.text(i18next.t(\"success\"));\n                    loadingField.animate({\"opacity\": 0}, __timeout, function() {\n                        successField.animate({\"opacity\": 1}, __timeout, function() {\n                            setTimeout(function() {\n                                successField.animate({\"opacity\": 0}, __timeout * 2);\n                            }, __timeout * 2);\n                        });\n                    });\n                })(targetField);\n            }, __timeout);\n        },\n        showError: function(targetField) {\n            targetField = targetField || $(targetField);\n            var __timeout = this.delayDuration;\n            if (!targetField || targetField.length === 0) { return false; }\n            setTimeout(function() {\n                (function(targetField) {\n                    var containerId = targetField.attr(\"data-save-container-id\") || targetField.attr(\"id\");\n                    var errorField = $(\"#\" + containerId + \"_error\");\n                    var successField = $(\"#\" + containerId + \"_success\");\n                    var loadingField = $(\"#\" + containerId + \"_load\");\n                    loadingField.removeClass(\"loading\");\n                    errorField.text(i18next.t(\"Unable to update. System/Server Error.\"));\n                    successField.text(\"\").css(\"opacity\", 0);\n                    loadingField.animate({\"opacity\": 0}, __timeout, function() {\n                        errorField.animate({\"opacity\": 1}, __timeout, function() {\n                            setTimeout(function() {\n                                errorField.animate({\"opacity\": 0}, __timeout * 2);\n                            }, __timeout * 2);\n                        });\n                    });\n                })(targetField);\n            }, __timeout);\n        }\n    },\n    \"getCurrentUser\": function(callback, params) {\n        callback = callback||function() {};\n        if (sessionStorage.currentUser) {\n            callback(JSON.parse(sessionStorage.currentUser));\n        } else {\n            this.sendRequest(\"/api/me\", \"GET\", \"\", params, function(data) {\n                if (data && data.id) { //make sure the necessary data is there before setting session\n                    sessionStorage.setItem(\"currentUser\", JSON.stringify(data));\n                }\n                callback(data);\n            });\n        }\n    },\n    \"getStillNeededCoreData\": function(userId, sync, callback, entry_method) {\n        callback = callback || function() {};\n        if (!userId) {\n            callback({\"error\": i18next.t(\"User Id is required\")});\n            return false;\n        }\n        var __url = \"/api/coredata/user/\" + userId + \"/still_needed\" + (entry_method ? \"?entry_method=\" + (entry_method).replace(/\\_/g, \" \") : \"\");\n        this.sendRequest(__url, \"GET\", userId, {sync: sync,cache: true}, function(data) {\n            if (!data) {\n                callback({\"error\": i18next.t(\"no data returned\")});\n                return false;\n            }\n            if (data.error) {\n                callback({\"error\": i18next.t(\"unable to get needed core data\")});\n                return false;\n            }\n            callback(data);\n        });\n    },\n    \"getRequiredCoreData\": function(userId, sync, callback) {\n        callback = callback || function() {};\n        if (!userId) {\n            callback({\"error\": i18next.t(\"User Id is required\")});\n            return false;\n        }\n        this.sendRequest(\"/api/coredata/user/\" + userId + \"/required\", \"GET\", userId, {sync: sync,cache: true}, function(data) {\n            if (data) {\n                if (!data.error) {\n                    if (data.required) {\n                        callback(data.required);\n                    } else {\n                        callback({\"error\": i18next.t(\"no data returned\")});\n                    }\n                } else {\n                    callback({\"error\": i18next.t(\"unable to get required core data\")});\n                }\n            } else {\n                callback({\"error\": i18next.t(\"no data returned\")});\n            }\n        });\n    },\n    \"getOptionalCoreData\": function(userId, params, callback) {\n        callback = callback || function() {};\n        if (!userId) {\n            callback({\"error\": i18next.t(\"User Id is required\")});\n            return false;\n        }\n        var __url = \"/api/coredata/user/\" + userId + \"/optional\", sessionStorageKey = \"optionalCoreData_\" + userId;\n        if (sessionStorage.getItem(sessionStorageKey)) {\n            callback(JSON.parse(sessionStorage.getItem(sessionStorageKey)));\n        } else {\n            this.sendRequest(__url, \"GET\", userId, params, function(data) {\n                if (data) {\n                    callback(data);\n                } else {\n                    callback({\"error\": i18next.t(\"no data found\")});\n                }\n            });\n        }\n    },\n    \"getPortalFooter\": function(userId, sync, containerId, callback) {\n        callback = callback || function() {};\n        if (!userId) {\n            callback(\"<div class='error-message'>\" + i18next.t(\"User Id is required\") + \"</div>\");\n            return false;\n        }\n        this.sendRequest(\"/api/portal-footer-html/\", \"GET\", userId, {sync: sync,cache: true,\"dataType\": \"html\"}, function(data) {\n            if (data) {\n                if (!data.error) {\n                    if (containerId) {\n                        $(\"#\" + containerId).html(data);\n                    }\n                    callback(data);\n                } else {\n                    callback(\"<div class='error-message'>\" + i18next.t(\"Unable to retrieve portal footer html\") + \"</div>\");\n                }\n            } else {\n                callback(\"<div class='error-message'>\" + i18next.t(\"No data found\") + \"</div>\");\n            }\n        });\n    },\n    \"getOrgs\": function(userId, params, callback) {\n        callback = callback || function() {};\n        this.sendRequest(\"/api/organization\", \"GET\", userId, params, function(data) {\n            if (sessionStorage.demoOrgsData) {\n                callback(JSON.parse(sessionStorage.demoOrgsData));\n                return true;\n            }\n            if (!data.error) {\n                $(\".get-orgs-error\").html(\"\");\n                sessionStorage.setItem(\"demoOrgsData\", JSON.stringify(data));\n                callback(data);\n            } else {\n                var errorMessage = i18next.t(\"Server error occurred retrieving organization/clinic information.\");\n                $(\".get-orgs-error\").html(errorMessage);\n                callback({\"error\": errorMessage});\n            }\n        });\n    },\n    \"getConsent\": function(userId, params, callback) {\n        callback = callback || function() {};\n        if (!userId) {\n            callback({error: i18next.t(\"User id is required.\")});\n            return false;\n        }\n        this.sendRequest(\"/api/user/\" + userId + \"/consent\", \"GET\", userId, params, function(data) {\n            if (data) {\n                if (!data.error) {\n                    $(\".get-consent-error\").html(\"\");\n                    callback(data);\n                    return true;\n                } else {\n                    var errorMessage = i18next.t(\"Server error occurred retrieving consent information.\");\n                    callback({\"error\": errorMessage});\n                    $(\".get-consent-error\").html(errorMessage);\n                    return false;\n                }\n            }\n        });\n    },\n    \"setConsent\": function(userId, params, status, sync, callback) {\n        callback = callback || function() {};\n        if (!userId && !params) {\n            callback({\"error\": i18next.t(\"User id and parameters are required\")});\n            return false;\n        }\n        var consented = this.hasConsent(userId, params.org, status);\n        var __url = \"/api/user/\" + userId + \"/consent\";\n        if (consented && !params.testPatient) {\n            callback({\"error\": false});\n            return;\n        }\n        var data = {};\n        data.user_id = userId;\n        data.organization_id = params.org;\n        data.agreement_url = params.agreementUrl;\n        data.staff_editable = (String(params.staff_editable) !== \"null\"  && String(params.staff_editable) !== \"undefined\" ? params.staff_editable : false);\n        data.include_in_reports = (String(params.include_in_reports) !== \"null\" && String(params.include_in_reports) !== \"undefined\" ? params.include_in_reports : false);\n        data.send_reminders = (String(params.send_reminders) !== \"null\" &&  String(params.send_reminders) !== \"undefined\"? params.send_reminders : false);\n        if (params.acceptance_date) {\n            data.acceptance_date = params.acceptance_date;\n        }\n        this.sendRequest(__url, \"POST\", userId, {sync: sync, data: JSON.stringify(data)}, function(data) {\n            if (!data.error) {\n                $(\".set-consent-error\").html(\"\");\n                callback(data);\n            } else {\n                var errorMessage = i18next.t(\"Server error occurred setting consent status.\");\n                callback({\"error\": errorMessage});\n                $(\".set-consent-error\").html(errorMessage);\n            }\n        });\n    },\n    deleteConsent: function(userId, params={}) {\n        if (!userId) {\n            return false;\n        }\n        var consented = this.getAllValidConsent(userId, params.org);\n        if (!consented) {\n            return false;\n        }\n        var arrExcludedOrgIds = params.exclude ? params.exclude.split(\",\"): [];\n        var arrConsents = $.grep(consented, function(orgId) {\n            var inArray = $.grep(arrExcludedOrgIds, function(eOrg) {\n                return String(eOrg) === String(orgId);\n            });\n            return !(inArray.length); //filter out org Id(s) that are in the array of org Ids to be excluded;\n        });\n        var self = this;\n        arrConsents.forEach(function(orgId) { //delete all consents for the org\n            self.sendRequest(\"/api/user/\" + userId + \"/consent\", \"DELETE\", userId, {data: JSON.stringify({\"organization_id\": parseInt(orgId)})}, function(data) {\n                if (!data) {\n                    return false;\n                }\n                if (!data.error) {\n                    $(\".delete-consent-error\").html(\"\");\n                } else {\n                    $(\".delete-consent-error\").html(i18next.t(\"Server error occurred removing consent.\"));\n                }\n            });\n        });\n    },\n    withdrawConsent: function(userId, orgId, params, callback) {\n        callback = callback || function() {};\n        params = params || {};\n        if (!userId || !orgId) {\n            callback({\"error\": i18next.t(\"User id and organization id are required.\")});\n            return false;\n        }\n        var self = this, arrConsent = [];\n        this.sendRequest(\"/api/user/\" + userId + \"/consent\", \"GET\", userId, params, function(data) {\n            if (data && data.consent_agreements && data.consent_agreements.length) {\n                arrConsent = $.grep(data.consent_agreements, function(item) {\n                    var expired = tnthDates.getDateDiff(String(item.expires)); /*global tnthDates */\n                    return (String(orgId) === String(item.organization_id)) && !item.deleted && !(expired > 0) && String(item.status) === \"suspended\";\n                });\n            }\n            if (arrConsent.length) { //don't send request if suspended consent already existed\n                callback({\"data\": \"success\"});\n                return false;\n            }\n            self.sendRequest(\"/api/user/\" + userId + \"/consent/withdraw\",\n                \"POST\",\n                userId, {sync: params.sync,data: JSON.stringify({organization_id: orgId})},\n                function(data) {\n                    if (data.error) {\n                        callback({\"error\": i18next.t(\"Error occurred setting suspended consent status.\")});\n                        return false;\n                    }\n                    callback(data);\n                });\n        });\n    },\n    getAllValidConsent: function(userId, orgId) {\n        if (!userId || !orgId) { return false; }\n        var consentedOrgIds = [];\n        this.sendRequest(\"/api/user/\" + userId + \"/consent\", \"GET\", userId, {sync: true}, function(data) {\n            if (!data || data.error || !data.consent_agreements || !data.consent_agreements.length) {\n                return consentedOrgIds;\n            }\n            consentedOrgIds = $.grep(data.consent_agreements, function(item) {\n                var expired = tnthDates.getDateDiff(String(item.expires));\n                return !item.deleted && !(expired > 0) && (String(orgId).toLowerCase() === \"all\" || String(orgId) === String(item.organization_id));\n            });\n            consentedOrgIds = (consentedOrgIds).map(function(item) {\n                return item.organization_id;\n            });\n            return consentedOrgIds;\n        });\n        return consentedOrgIds;\n    },\n    hasConsent: function(userId, orgId, filterStatus) {  /****** NOTE - this will return the latest updated consent entry *******/\n        if (!userId || !orgId || String(filterStatus) === \"default\") { return false; }\n        var consentedOrgIds = [];\n        var __url = \"/api/user/\" + userId + \"/consent\", self = this;\n        self.sendRequest(__url, \"GET\", userId, {sync: true}, function(data) {\n            if (!data || data.error || (data.consent_agreements && data.consent_agreements.length === 0)) {\n                return false;\n            }\n            consentedOrgIds = $.grep(data.consent_agreements, function(item) {\n                var expired = item.expires ? tnthDates.getDateDiff(String(item.expires)) : 0; /*global tnthDates */\n                return (String(orgId) === String(item.organization_id)) && !item.deleted && !(expired > 0) && item.staff_editable && item.send_reminders && item.include_in_reports;\n            });\n        });\n        return consentedOrgIds.length;\n    },\n    \"getDemo\": function(userId, params, callback) {\n        callback = callback || function() {};\n        if (!userId) {\n            callback({\"error\": i18next.t(\"User id is required.\")});\n            return false;\n        }\n        params = params || {};\n        var demoDataKey = \"demoData_\"+userId;\n        if (sessionStorage.getItem(demoDataKey)) {\n            callback(JSON.parse(sessionStorage.getItem(demoDataKey)));\n            return;\n        }\n        this.sendRequest(\"/api/demographics/\" + userId, \"GET\", userId, params, function(data) {\n            var errorMessage = \"\";\n            if (data.error) {\n                errorMessage = i18next.t(\"Server error occurred retrieving demographics information.\");\n                $(\".get-demo-error\").html(errorMessage);\n                callback({\"error\": errorMessage});\n                return false;\n            }\n            $(\".get-demo-error\").html(errorMessage);\n            sessionStorage.setItem(demoDataKey, JSON.stringify(data));\n            callback(data);\n        });\n    },\n    \"clearDemoSessionData\": function(userId) {\n        sessionStorage.removeItem(\"demoData_\"+userId);\n    },\n    \"putDemo\": function(userId, toSend, targetField, sync, callback) {\n        callback = callback || function() {};\n        if (!userId) {\n            callback({\"error\": i18next.t(\"User Id is required\")});\n            return false;\n        }\n        this.clearDemoSessionData(userId);\n        this.sendRequest(\"/api/demographics/\" + userId, \"PUT\", userId, {sync: sync, data: JSON.stringify(toSend),targetField: targetField}, function(data) {\n            if (!data.error) {\n                $(\".put-demo-error\").html(\"\");\n            } else {\n                $(\".put-demo-error\").html(i18next.t(\"Server error occurred setting demographics information.\"));\n            }\n            callback(data);\n        });\n    },\n    \"getLocale\": function(userId) {\n        this.sendRequest(\"/api/demographics/\" + userId, \"GET\", userId, null, function(data) {\n            if (data) {\n                if (!data.error) {\n                    if (data.communication) {\n                        $(\"#profileLocaleTimezoneContainer .get-locale-error\").html(\"\");\n                    }\n                } else {\n                    $(\"#profileLocaleTimezoneContainer .get-locale-error\").html(i18next.t(\"Server error occurred retrieving locale information.\"));\n                }\n            }\n        });\n    },\n    \"hasTreatment\": function(data) {\n        if (!data || !data.entry || data.entry.length === 0) {\n            return false;\n        }\n        var sortedArray = data.entry.sort(function(a, b) { // sort from newest to oldest based on lsat updated date\n            return new Date(b.resource.meta.lastUpdated) - new Date(a.resource.meta.lastUpdated);\n        });\n        var found = false;\n        sortedArray.forEach(function(item) {\n            if (found) { return true; }\n            var resourceItemCode = String(item.resource.code.coding[0].code);\n            var system = String(item.resource.code.coding[0].system);\n            var procId = item.resource.id;\n            if ((resourceItemCode === SYSTEM_IDENTIFIER_ENUM.CANCER_TREATMENT_CODE && (system === SYSTEM_IDENTIFIER_ENUM.SNOMED_SYS_URL)) || (resourceItemCode === SYSTEM_IDENTIFIER_ENUM.NONE_TREATMENT_CODE && (system === SYSTEM_IDENTIFIER_ENUM.CLINICAL_SYS_URL))) {\n                found = {\"code\": resourceItemCode,\"id\": procId};\n            }\n        });\n        return found;\n    },\n    \"getTreatment\": function(userId, params, callback) {\n        callback = callback || function() {};\n        if (!userId) {\n            callback({error: i18next.t(\"User id is required\")});\n            return false;\n        }\n        this.sendRequest(\"/api/patient/\" + userId + \"/procedure\", \"GET\", userId, params, function(data) {\n            if (data.error) {\n                $(\"#userProcedures\").html(\"<span class='error-message'>\" + i18next.t(\"Error retrieving data from server\") + \"</span>\");\n            }\n            callback(data);\n        });\n    },\n    \"postTreatment\": function(userId, started, treatmentDate, targetField) {\n        if (!userId) { return false;}\n        this.deleteTreatment(userId, targetField);\n        var code = SYSTEM_IDENTIFIER_ENUM.NONE_TREATMENT_CODE, display = \"None\", system = SYSTEM_IDENTIFIER_ENUM.CLINICAL_SYS_URL;\n        if (started) {\n            code = SYSTEM_IDENTIFIER_ENUM.CANCER_TREATMENT_CODE;\n            display = \"Procedure on prostate\";\n            system = SYSTEM_IDENTIFIER_ENUM.SNOMED_SYS_URL;\n        }\n        if (!treatmentDate) {\n            var date = new Date();\n            treatmentDate = date.getFullYear() + \"-\" + (date.getMonth() + 1) + \"-\" + date.getDate();  //in yyyy-mm-dd format\n        }\n        var procID = [{\"code\": code,\"display\": display,\"system\": system}];\n        var procArray = {};\n        procArray.resourceType = \"Procedure\";\n        procArray.subject = {\"reference\": \"Patient/\" + userId};\n        procArray.code = {\"coding\": procID};\n        procArray.performedDateTime = treatmentDate ? treatmentDate : \"\";\n        this.postProc(userId, procArray, targetField);\n    },\n    deleteTreatment: function(userId, targetField) {\n        var self = this;\n        this.sendRequest(\"/api/patient/\" + userId + \"/procedure\", \"GET\", userId, {sync: true}, function(data) {\n            if (!data || data.error) { return false; }\n            var treatmentData = self.hasTreatment(data);\n            if (!treatmentData) { return false; }\n            if (String(treatmentData.code) === String(SYSTEM_IDENTIFIER_ENUM.CANCER_TREATMENT_CODE)){\n                self.deleteProc(treatmentData.id, targetField, true);\n                return true;\n            }\n            self.deleteProc(treatmentData.id, targetField, true);\n        });\n    },\n    \"getProc\": function(userId, newEntry, callback) {\n        callback = callback || function() {};\n        this.sendRequest(\"/api/patient/\" + userId + \"/procedure\", \"GET\", userId, null, function(data) {\n            callback(data);\n        });\n    },\n    \"postProc\": function(userId, toSend, targetField, callback) {\n        callback = callback || function() {};\n        this.sendRequest(\"/api/procedure\", \"POST\", userId, {data: JSON.stringify(toSend),targetField: targetField}, function(data) {\n            if (!data) {\n                callback({\"error\": i18next.t(\"no data returned\")});\n                return false;\n            }\n            if (data.error) {\n                var errorMessage = i18next.t(\"Server error occurred saving procedure/treatment information.\");\n                $(\"#userProcuedures .get-procs-error\").html(errorMessage);\n                callback({error: errorMessage});\n                return false;\n            }\n            $(\".get-procs-error\").html(\"\");\n            callback(data);\n        });\n    },\n    \"deleteProc\": function(procedureId, targetField, sync) {\n        this.sendRequest(\"/api/procedure/\" + procedureId, \"DELETE\", null, {sync: sync,targetField: targetField}, function(data) {\n            if (!data.error) {\n                $(\".del-procs-error\").html(\"\");\n            } else {\n                $(\".del-procs-error\").html(i18next.t(\"Server error occurred removing procedure/treatment information.\"));\n            }\n        });\n    },\n    \"getRoleList\": function(params, callback) {\n        this.sendRequest(\"/api/roles\", \"GET\", null, params, function(data) {\n            callback = callback || function() {};\n            if (!data.error) {\n                callback(data);\n            } else {\n                var errorMessage = i18next.t(\"Server error occurred retrieving roles information.\");\n                $(\".get-roles-error\").html(errorMessage);\n                callback({\"error\": errorMessage});\n            }\n        });\n    },\n    \"getRoles\": function(userId, callback, params) {\n        callback = callback || function() {};\n        var sessionStorageKey = \"userRole_\" + userId;\n        if (sessionStorage.getItem(sessionStorageKey)) {\n            var data = JSON.parse(sessionStorage.getItem(sessionStorageKey));\n            callback(data);\n        } else {\n            this.sendRequest(\"/api/user/\" + userId + \"/roles\", \"GET\", userId, params, function(data) {\n                if (data) {\n                    if (!data.error) {\n                        $(\".get-roles-error\").html(\"\");\n                        sessionStorage.setItem(sessionStorageKey, JSON.stringify(data));\n                        callback(data);\n                    } else {\n                        var errorMessage = i18next.t(\"Server error occurred retrieving user role information.\");\n                        $(\".get-roles-error\").html(errorMessage);\n                        callback({\"error\": errorMessage});\n                    }\n                }\n            });\n        }\n    },\n    \"removeCachedRoles\": function(userId) {\n        sessionStorage.removeItem(\"userRole_\"+userId);\n    },\n    \"putRoles\": function(userId, toSend, targetField, callback) {\n        callback = callback || function() {};\n        if (!userId) {\n            callback({error: i18next.t(\"User Id is required.\")});\n            return false;\n        }\n        this.removeCachedRoles(userId);\n        this.sendRequest(\"/api/user/\" + userId + \"/roles\", \"PUT\", userId, {data: JSON.stringify(toSend),targetField: targetField}, function(data) {\n            if (!data || data.error) {\n                var errorMessage = i18next.t(\"Server error occurred setting user role information.\");\n                $(\".put-roles-error\").html(errorMessage);\n                callback({error: errorMessage});\n                return;\n            }\n            $(\".put-roles-error\").html(\"\");\n            sessionStorage.setItem(\"userRole_\" + userId, \"\");\n            callback(data);\n        });\n    },\n    \"deleteRoles\": function(userId, toSend) {\n        if (!userId) {\n            return false;\n        }\n        this.removeCachedRoles(userId);\n        this.sendRequest(\"/api/user/\" + userId, \"GET\", userId, {data: JSON.stringify(toSend)}, function(data) {\n            if (data) {\n                if (!data.error) {\n                    $(\".delete-roles-error\").html(\"\");\n                } else {\n                    $(\".delete-roles-error\").html(i18next.t(\"Server error occurred deleting user role.\"));\n                }\n            }\n        });\n    },\n    \"getClinical\": function(userId, params, callback) {\n        callback = callback || function() {};\n        this.sendRequest(\"/api/patient/\" + userId + \"/clinical\", \"GET\", userId, params, function(data) {\n            if (data) {\n                if (!data.error) {\n                    $(\".get-clinical-error\").html(\"\");\n                    callback(data);\n                } else {\n                    var errorMessage = i18next.t(\"Server error occurred retrieving clinical data.\");\n                    $(\".get-clinical-error\").html(errorMessage);\n                    callback({\"error\": errorMessage});\n                }\n            }\n        });\n    },\n    \"getObservationId\": function(userId, code) {\n        if (!userId) { return false; }\n        var obId = \"\",_code = \"\";\n        this.sendRequest(\"/api/patient/\" + userId + \"/clinical\", \"GET\", userId, {sync: true}, function(data) {\n            if (data) {\n                if (!data.error) {\n                    if (data.entry) {\n                        (data.entry).forEach(function(item) {\n                            if (!obId) {\n                                _code = item.content.code.coding[0].code;\n                                if (String(_code) === String(code)) {\n                                    obId = item.content.id;\n                                }\n                            }\n                        });\n                    }\n                }\n            }\n        });\n        return obId;\n    },\n    \"postClinical\": function(userId, toCall, toSend, status, targetField, params, callback) {\n        if (!userId) { return false; }\n        params = params || {};\n        var code = \"\", display = \"\";\n        if (CLINICAL_CODE_ENUM.hasOwnProperty(String(toCall).toLowerCase())) {\n            var match = CLINICAL_CODE_ENUM[toCall];\n            code = match.code;\n            display = match.display;\n        }\n        if (!code) {\n            return false;\n        }\n        var self = this;\n        var system = SYSTEM_IDENTIFIER_ENUM.CLINICAL_SYS_URL;\n        var method = \"POST\";\n        var url = \"/api/patient/\" + userId + \"/clinical\";\n        var obsCode = [{\"code\": code,\"display\": display,\"system\": system}];\n        var obsArray = {};\n        obsArray.resourceType = \"Observation\";\n        obsArray.code = {\"coding\": obsCode};\n        obsArray.issued = params.issuedDate ? params.issuedDate : \"\";\n        obsArray.status = status ? status : \"\";\n        obsArray.valueQuantity = {\"units\": \"boolean\",\"value\": toSend};\n        if (params.performer) {\n            obsArray.performer = params.performer;\n        }\n        var obsId = self.getObservationId(userId, code);\n        if (obsId) {\n            method = \"PUT\";\n            url = url + \"/\" + obsId;\n        }\n        callback = callback || function() {};\n        this.sendRequest(url, method, userId, {data: JSON.stringify(obsArray),targetField: targetField}, function(data) {\n            if (!data || data.error) {\n                var errorMessage = i18next.t(\"Server error occurred updating clinical data.\");\n                $(\".post-clinical-error\").html(errorMessage).show();\n                callback({error: errorMessage});\n                return;\n            }\n            $(\".post-clinical-error\").html(\"\").hide();\n            callback(data);\n        });\n    },\n    \"getTermsUrl\": function(sync, callback) { /*global i18next */\n        callback = callback || function() {};\n        this.sendRequest(\"/api/tou\", \"GET\", null, {sync: sync}, function(data) {\n            if (data) {\n                if (!data.error) {\n                    $(\".get-tou-error\").html(\"\");\n                    if (data.url) {\n                        $(\"#termsURL\").attr(\"data-url\", data.url);\n                        $(\"#termsCheckbox_default .terms-url\").attr(\"href\", data.url);\n                        callback({\"url\": data.url});\n                    } else {\n                        callback({\"error\": i18next.t(\"no url returned\")});\n                    }\n                } else {\n                    $(\".get-tou-error\").html(i18next.t(\"Server error occurred retrieving tou url.\"));\n                    callback({\"error\": i18next.t(\"Server error\")});\n                }\n            }\n        });\n    },\n    \"getInstrumentsList\": function(sync, callback) { //return instruments list by organization(s)\n        callback = callback || function() {};\n        this.sendRequest(\"api/questionnaire_bank\", \"GET\", null, {\n            sync: sync\n        }, function(data) {\n            if (!data || data.error) {\n                callback({\"error\": i18next.t(\"error retrieving instruments list\")});\n                return;\n            }\n            if (!data.entry || !data.entry.length) {\n                callback({\"error\": i18next.t(\"no data returned\")});\n                return;\n            }\n            var qList = {};\n            (data.entry).forEach(function(item) {\n                if (item.organization) {\n                    var orgID = (item.organization.reference).split(\"/\")[2];\n                    if (!qList[orgID]) {\n                        qList[orgID] = []; //don't assign orgID to object if it was already present\n                    }\n                    if (item.questionnaires) {\n                        (item.questionnaires).forEach(function(q) {\n                            /*\n                             * add instrument name to instruments array for the org - will not add if it is already in the array\n                             * NOTE: inArray returns -1 if the item is NOT in the array\n                             */\n                            if ($.inArray(q.questionnaire.display, qList[orgID]) === -1) {\n                                qList[orgID].push(q.questionnaire.display);\n                            }\n                        });\n                    }\n                }\n            });\n            callback(qList);\n\n        });\n    },\n    \"getTerms\": function(userId, type, sync, callback, params) {\n        callback = callback || function() {};\n        params = params || {};\n        var url = \"/api/user/{userId}/tou{type}{all}\".replace(\"{userId}\", userId)\n            .replace(\"{type}\", type ? (\"/\" + type) : \"\")\n            .replace(\"{all}\", (params.hasOwnProperty(\"all\") ? \"?all=true\" : \"\"));\n        this.sendRequest(url, \"GET\", userId, {sync: sync}, function(data) {\n            if (!data || data.error) {\n                var errorMessage = i18next.t(\"Server error occurred retrieving tou data.\");\n                $(\".get-tou-error\").html(errorMessage);\n                callback({\"error\": errorMessage});\n                return;\n            }\n            $(\".get-tou-error\").html(\"\");\n            callback(data);\n        });\n    },\n    \"postTermsByUser\": function(userId, toSend, callback) {\n        callback = callback || function() {};\n        this.sendRequest(\"/api/user/\" + userId + \"/tou/accepted\", \"POST\", userId, {data: JSON.stringify(toSend)}, function(data) {\n            if (!data || data.error) {\n                $(\".post-tou-error\").html(i18next.t(\"Server error occurred saving terms of use information.\"));\n                callback(data);\n                return;\n            }\n            $(\".post-tou-error\").html(\"\");\n            callback(data);\n        });\n    },\n    \"postTerms\": function(toSend, targetField, callback) {\n        callback = callback || function() {};\n        this.sendRequest(\"/api/tou/accepted\", \"POST\", null, {data: JSON.stringify(toSend), targetField: targetField}, function(data) {\n            if (!data || data.error) {\n                var errorMessage = i18next.t(\"Server error occurred saving terms of use information.\");\n                $(\".post-tou-error\").html(errorMessage);\n                callback({error: errorMessage});\n                return;\n            }\n            $(\".post-tou-error\").html(\"\");\n            callback(data);\n        });\n    },\n    \"accessUrl\": function(userId, sync, callback) {\n        callback = callback || function() {};\n        if (!userId) { callback({\"error\": i18next.t(\"User id is required.\")}); return false; }\n        this.sendRequest(\"/api/user/\" + userId + \"/access_url\", \"GET\", userId, {sync: sync}, function(data) {\n            if (data) {\n                if (!data.error) {\n                    callback({url: data.access_url});\n                } else {\n                    callback({\"error\": i18next.t(\"Error occurred retrieving access url.\")});\n                }\n            } else {\n                callback({\"error\": i18next.t(\"no data returned\")});\n            }\n        });\n    },\n    \"invite\": function(userId, data, callback) {\n        callback = callback || function() {};\n        if (!data) { callback({\"error\": i18next.t(\"Invite data are required.\")}); return false; }\n        this.sendRequest(\"/invite\", \"POST\", userId, {\n            \"contentType\": \"application/x-www-form-urlencoded; charset=UTF-8\",\n            \"data\": data,\n            \"dataType\": \"html\"\n        }, function(data) {\n            if (data) {\n                callback(data);\n            } else {\n                callback({\"error\": i18next.t(\"no data returned\")});\n            }\n        });\n    },\n    \"passwordReset\": function(userId, callback) {\n        callback = callback || function() {};\n        if (!userId) { callback({\"error\": i18next.t(\"User id is required.\")}); return false; }\n        this.sendRequest(\"/api/user/\" + userId + \"/password_reset\", \"POST\", userId, {\"contentType\": \"application/x-www-form-urlencoded; charset=UTF-8\"}, function(data) {\n            if (data) {\n                if (!data.error) {\n                    callback(data);\n                } else {\n                    callback({\"error\": i18next.t(\"Error occurred sending password reset request.\")});\n                }\n            } else {\n                callback({\"error\": i18next.t(\"no data returned\")});\n            }\n        });\n    },\n    \"assessmentStatus\": function(userId, callback) {\n        callback = callback || function() {};\n        if (!userId) { callback({\"error\": i18next.t(\"User id is required.\")}); return false; }\n        this.sendRequest(\"/api/patient/\" + userId + \"/assessment-status\", \"GET\", userId, null, function(data) {\n            if (data) {\n                if (!data.error) {\n                    callback(data);\n                } else {\n                    callback({\"error\": i18next.t(\"Error occurred retrieving assessment status.\")});\n                }\n            } else {\n                callback({\"error\": i18next.t(\"no data returned\")});\n            }\n        });\n    },\n    \"updateAssessment\": function(userId, data, callback) {\n        callback = callback || function() {};\n        if (!userId) { callback({\"error\": i18next.t(\"User id is required.\")}); return false; }\n        if (!data) { callback({\"error\": i18next.t(\"Questionnaire response data is required.\")}); return false;}\n        this.sendRequest(\"/api/patient/\" + userId + \"/assessment\", \"PUT\", userId, {data: JSON.stringify(data)}, function(data) {\n            if (data) {\n                if (!data.error) {\n                    callback(data);\n                } else {\n                    callback({\"error\": i18next.t(\"Error occurred retrieving assessment list.\")});\n                }\n\n            } else {\n                callback({\"error\": i18next.t(\"no data returned\")});\n            }\n        });\n    },\n    \"assessmentList\": function(userId, params, callback) {\n        callback = callback || function() {};\n        if (!userId) {\n            callback({error: i18next.t(\"User id is required.\")});\n            return false;\n        }\n        this.sendRequest(\"/api/patient/\" + userId + \"/assessment\", \"GET\", userId, params, function(data) {\n            if (data) {\n                if (!data.error) {\n                    callback(data);\n                } else {\n                    callback({\"error\": i18next.t(\"Error occurred retrieving assessment list.\")});\n                }\n            } else {\n                callback({\"error\": i18next.t(\"no data returned\")});\n            }\n        });\n    },\n    \"assessmentReport\": function(userId, instrumentId, callback) {\n        callback = callback || function() {};\n        if (!userId || !instrumentId) {\n            callback({error: i18next.t(\"User id and instrument Id are required.\")});\n            return false;\n        }\n        this.sendRequest(\"/api/patient/\" + userId + \"/assessment/\" + instrumentId, \"GET\", userId, null, function(data) {\n            if (data) {\n                if (!data.error) {\n                    callback(data);\n                } else {\n                    callback({\"error\": i18next.t(\"Error occurred retrieving assessment report.\")});\n                }\n            } else {\n                callback({\"error\": i18next.t(\"no data returned\")});\n            }\n        });\n    },\n    \"getCurrentQB\": function(userId, completionDate, params, callback) {\n        callback = callback || function() {};\n        if (!userId) {\n            callback({error: i18next.t(\"User id is required.\")});\n            return false;\n        }\n        params = params || {};\n        this.sendRequest(\"/api/user/\" + userId + \"/questionnaire_bank\", \"GET\", userId, {data: {as_of_date: completionDate}, sync: params.sync}, function(data) {\n            if (!data || data.error) {\n                callback({\"error\": i18next.t(\"Error occurred retrieving current questionnaire bank for user.\")});\n                return false;\n            }\n            callback(data);\n        });\n    },\n    \"patientReport\": function(userId, params, callback) {\n        callback = callback || function() {};\n        if (!userId) {\n            callback({error: i18next.t(\"User id is required.\")});\n            return false;\n        }\n        this.sendRequest(\"/api/user/\" + userId + \"/user_documents?document_type=PatientReport\", \"GET\", userId, params, function(data) {\n            if (data) {\n                if (!data.error) {\n                    callback(data);\n                } else {\n                    callback({\"error\": i18next.t(\"Error occurred retrieving patient report.\")});\n                }\n            } else {\n                callback({\"error\": i18next.t(\"no data returned\")});\n            }\n        });\n    },\n    \"setTablePreference\": function(userId, tableName, params, callback) {\n        callback = callback || function() {};\n        params = params || {};\n        if (!userId || !tableName) {\n            callback({error: \"User Id and table name is required for setting preference.\"});\n            return false;\n        }\n        this.sendRequest(\"/api/user/\" + userId + \"/table_preferences/\" + tableName, \"PUT\", userId, {\"data\": params.data,\"sync\": params.sync}, function(data) {\n            if (!data || data.error) {\n                callback({\"error\": i18next.t(\"Error occurred setting table preference.\")});\n                return false;\n            }\n            callback(data);\n        });\n    },\n    \"getTablePreference\": function(userId, tableName, params, callback) {\n        params = params || function() {};\n        callback = callback || function(){};\n        if (!userId) {\n            callback({error: \"User Id is required for setting preference.\"});\n            return false;\n        }\n        this.sendRequest(\"/api/user/\" + userId + \"/table_preferences/\" + tableName, \"GET\", userId, params, function(data) {\n            if (data && data.error) {\n                callback({\"error\": i18next.t(\"Error occurred setting table preference.\")});\n                return;\n            }\n            callback(data);\n        });\n    },\n    \"emailLog\": function(userId, params, callback) {\n        callback = callback || function() {};\n        if (!userId) {\n            callback({error: i18next.t(\"User id is required.\")});\n            return false;\n        }\n        this.sendRequest(\"/api/user/\" + userId + \"/messages\", \"GET\", userId, params, function(data) {\n            if (data) {\n                if (!data.error) {\n                    callback(data);\n                } else {\n                    callback({\"error\": i18next.t(\"Error occurred retrieving email audit entries.\")});\n                }\n            } else {\n                callback({\"error\": i18next.t(\"no data returned\")});\n            }\n        });\n    },\n    \"auditLog\": function(userId, params, callback) {\n        callback = callback || function() {};\n        if (!userId) {\n            callback({error: i18next.t(\"User id is required.\")});\n            return false;\n        }\n        this.sendRequest(\"/api/user/\" + userId + \"/audit\", \"GET\", userId, params, function(data) {\n            if (data) {\n                if (!data.error) {\n                    callback(data);\n                } else {\n                    callback({\"error\": i18next.t(\"Error occurred retrieving audit log.\")});\n                }\n            } else {\n                callback({\"error\": i18next.t(\"no data returned\")});\n            }\n        });\n    },\n    \"setting\": function(key, userId, params, callback) {\n        callback = callback || function() {};\n        if (!key) {\n            callback({\"error\": i18next.t(\"configuration key is required.\")});\n            return false;\n        }\n        params = params || {};\n        this.sendRequest(\"/api/settings/\" + key, \"GET\", userId, {\n            \"sync\": params.sync\n        }, function(data) {\n            if (data) {\n                if (!data.error) {\n                    callback(data);\n                } else {\n                    callback({\"error\": i18next.t(\"Error occurred retrieving content for configuration key.\")});\n                }\n            } else {\n                callback({\"error\": i18next.t(\"no data returned\")});\n            }\n        });\n    },\n    \"deactivateUser\": function(userId, params, callback) {\n        callback = callback||function() {};\n        if (!userId) {\n            callback({\"error\": i18next.t(\"User id is required\")});\n            return false;\n        }\n        this.sendRequest(\"/api/user/\" + userId, \"DELETE\", userId, (params || {}), function(data) {\n            callback = callback||function() {};\n            if (!data || data.error) {\n                callback({\"error\": i18next.t(\"Error occurred deactivating user.\")});\n                return;\n            }\n            callback(data);\n        });\n    },\n    \"reactivateUser\": function(userId, params, callback) {\n        callback = callback||function() {};\n        if (!userId) {\n            callback({\"error\": i18next.t(\"User id is required\")});\n            return false;\n        }\n        this.sendRequest(\"/api/user/\" + userId + \"/reactivate\", \"POST\", userId, (params || {}), function(data) {\n            if (!data || data.error) {\n                callback({\"error\": i18next.t(\"Error occurred reactivating user.\")});\n                return;\n            }\n            callback(data);\n        });\n    },\n    \"getConfigurationByKey\": function(configVar, params, callback) {\n        callback = callback || function() {};\n        if (!configVar) {\n            callback({\"error\": i18next.t(\"configuration variable name is required.\")});\n            return false;\n        }\n        var sessionConfigKey = \"config_\" + configVar;\n        if (sessionStorage.getItem(sessionConfigKey)) {\n            var data = JSON.parse(sessionStorage.getItem(sessionConfigKey));\n            callback(data);\n            return true;\n        }\n        this.sendRequest(\"/api/settings/\" + configVar, \"GET\", null, (params || {}), function(data) {\n            if (!data) {\n                callback({\"error\": i18next.t(\"no data returned\")});\n                return;\n            }\n            callback(data);\n            sessionStorage.setItem(sessionConfigKey, JSON.stringify(data));\n        });\n    },\n    \"getConfiguration\": function(userId, params, callback) {\n        callback = callback || function() {};\n        var sessionConfigKey = \"settings_\" + userId;\n        if (sessionStorage.getItem(sessionConfigKey)) {\n            var data = JSON.parse(sessionStorage.getItem(sessionConfigKey));\n            callback(data);\n            return;\n        }\n        this.sendRequest(\"/api/settings\", \"GET\", userId, (params || {}), function(data) {\n            if (data) {\n                callback(data);\n                sessionStorage.setItem(sessionConfigKey, JSON.stringify(data));\n            } else {\n                callback({\n                    \"error\": i18next.t(\"no data returned\")\n                });\n            }\n        });\n\n    },\n    \"getEmailReady\": function(userId, params, callback) {\n        callback = callback || function() {};\n        if (!userId) {\n            callback({error: i18next.t(\"User id is required.\")});\n            return false;\n        }\n        this.sendRequest(\"/api/user/\" + userId + \"/email_ready\", \"GET\", userId, params, function(data) {\n            callback(data);\n        });\n    }\n};\n","import SYSTEM_IDENTIFIER_ENUM from \"./SYSTEM_IDENTIFIER_ENUM.js\";\nimport tnthAjax from \"./TnthAjax.js\";\nexport default (function() { /*global i18next $ */\n    var OrgObj = function(orgId, orgName, parentOrg) {\n        this.id = orgId;\n        this.name = orgName;\n        this.children = [];\n        this.parentOrgId = parentOrg;\n        this.isTopLevel = false;\n        this.language = null;\n        this.extension = [];\n    };\n\n    var OrgTool = function() {\n        this.TOP_LEVEL_ORGS = [];\n        this.orgsList = {};\n        this.initialized = false;\n    };\n\n    OrgTool.prototype.init = function(callback) {\n        var self = this;\n        callback = callback || function() {};\n        if (sessionStorage.orgsData) {\n            var orgsData = JSON.parse(sessionStorage.orgsData);\n            self.populateOrgsList(orgsData);\n            callback(orgsData);\n        } else {\n            $.ajax({\n                type: \"GET\",\n                url: \"/api/organization\",\n                async: false\n            }).done(function(data) {\n                if (data && data.entry) {\n                    self.populateOrgsList(data.entry);\n                    sessionStorage.setItem(\"orgsData\", JSON.stringify(data.entry));\n                    callback(data.entry);\n                }\n            }).fail(function(xhr) {\n                callback({\"error\": xhr.responseText});\n                tnthAjax.sendError(xhr, \"/api/organization\");\n            });\n        }\n    };\n    OrgTool.prototype.onLoaded = function(userId, doPopulateUI) {\n        if (userId) { this.setUserId(userId); }\n        if (doPopulateUI) { this.populateUI(); }\n        $(\"#userOrgs input[name='organization']\").each(function() {\n            $(this).prop(\"checked\", false);\n        });\n        $(\"#clinics\").attr(\"loaded\", true);\n    };\n    OrgTool.prototype.setUserId = function(userId) {\n        $(\"#fillOrgs\").attr(\"userId\", userId);\n    };\n    OrgTool.prototype.getUserId = function() {\n        return $(\"#fillOrgs\").attr(\"userId\");\n    };\n    OrgTool.prototype.inArray = function(n, array){\n        if (!n || !array || !Array.isArray(array)) { return false; }\n        var found = false;\n        for (var index = 0; !found && index < array.length; index++) {\n            found = String(array[index]) === String(n);\n        }\n        return found;\n    };\n    OrgTool.prototype.getElementParentOrg = function(o){\n        var parentOrg;\n        if (!o) {\n            return false;\n        }\n        parentOrg = $(o).attr(\"data-parent-id\");\n        if (!parentOrg) {\n            parentOrg = $(o).closest(\".org-container[data-parent-id]\").attr(\"data-parent-id\");\n        }\n        return parentOrg;\n    };\n    OrgTool.prototype.getTopLevelOrgs = function() {\n        var ml = this.getOrgsList(), orgList = [];\n        for (var org in ml) {\n            if (ml[org].isTopLevel) {\n                orgList.push(org);\n            }\n        }\n        return orgList;\n    };\n    OrgTool.prototype.getOrgsList = function(){\n        return this.orgsList;\n    };\n    OrgTool.prototype.getOrgName = function(orgId){\n        var orgsList = this.getOrgsList();\n        if (orgId && orgsList.hasOwnProperty(orgId)) {\n            return orgsList[orgId].name;\n        }\n        return \"\";\n    };\n    OrgTool.prototype.filterOrgs = function(leafOrgs) {\n        leafOrgs = leafOrgs || [];\n        if (leafOrgs.length === 0) { return false; }\n        var self = this;\n        $(\"#fillOrgs input[name='organization']\").each(function() {\n            if (!self.inArray($(this).val(), leafOrgs)) {\n                $(this).hide();\n                if (self.orgsList[$(this).val()]) {\n                    var l = $(this).closest(\"label\");\n                    if (self.orgsList[$(this).val()].children.length === 0) {\n                        l.hide();\n                    } else {\n                        l.addClass(\"data-display-only\");\n                    }\n                }\n            }\n        });\n\n        var topList = self.getTopLevelOrgs();\n        topList.forEach(function(orgId) {\n            var allChildrenHidden = true;\n            $(\"#fillOrgs .org-container[data-parent-id='\" + orgId + \"']\").each(function() {\n                var subOrgs = $(this).find(\".org-container\");\n                if (subOrgs.length > 0) {\n                    var allSubOrgsHidden = true;\n                    subOrgs.each(function() {\n                        var isVisible = false;\n                        $(this).find(\"input[name='organization']\").each(function() {\n                            if ($(this).is(\":visible\") || String($(this).css(\"display\")) !== \"none\") {\n                                isVisible = true;\n                                allChildrenHidden = false;\n                            }\n                        });\n                        if (!isVisible) {\n                            $(this).hide();\n                        } else {\n                            allSubOrgsHidden = false;\n                        }\n                    });\n                    if (allSubOrgsHidden) {\n                        $(this).children(\"label\").hide();\n                    }\n                } else {\n                    var ip = $(this).find(\"input[name='organization']\");\n                    if (ip.length > 0) {\n                        ip.each(function() {\n                            if ($(this).is(\":visible\") || String($(this).css(\"display\")) !== \"none\") {\n                                allChildrenHidden = false;\n                            }\n                        });\n                    }\n                }\n            });\n            if (allChildrenHidden) {\n                $(\"#fillOrgs\").find(\"legend[orgid='\" + orgId + \"']\").hide();\n            }\n        });\n    };\n    OrgTool.prototype.findOrg = function(entry, orgId){\n        var org;\n        if (!entry || !orgId) {\n            return false;\n        }\n        entry.forEach(function(item) {\n            if (!org) {\n                if (parseInt(item.id) === parseInt(orgId)) {\n                    org = item;\n                }\n            }\n        });\n        return org;\n    };\n    OrgTool.prototype.getOrgName = function(orgId){\n        var org = this.orgsList[orgId];\n        if (!org) {\n            return \"\";\n        }\n        return org.name;\n    };\n    OrgTool.prototype.populateOrgsList = function(items) {\n        if (Object.keys(this.orgsList).length > 0) {\n            return this.orgsList;\n        }\n        var entry = items, self = this, parentId, orgsList = {};\n        if (!items) { return false; }\n        items.forEach(function(item) {\n            if (item.partOf) {\n                parentId = item.partOf.reference.split(\"/\").pop();\n                if (!orgsList[parentId]) {\n                    var o = self.findOrg(entry, parentId);\n                    orgsList[parentId] = new OrgObj(o.id, o.name);\n                }\n                orgsList[parentId].children.push(new OrgObj(item.id, item.name, parentId));\n                if (orgsList[item.id]) {\n                    orgsList[item.id].parentOrgId = parentId;\n                }\n                else {\n                    orgsList[item.id] = new OrgObj(item.id, item.name, parentId);\n                }\n            } else {\n                if (!orgsList[item.id]) {\n                    orgsList[item.id] = new OrgObj(item.id, item.name);\n                }\n                if (parseInt(item.id) !== 0) {\n                    orgsList[item.id].isTopLevel = true;\n                    self.TOP_LEVEL_ORGS.push(item.id);\n                }\n            }\n            if (item.extension) {\n                orgsList[item.id].extension = item.extension;\n            }\n            if (item.language) {\n                orgsList[item.id].language = item.language;\n            }\n            if (item.identifier) {\n                orgsList[item.id].identifier = item.identifier;\n                (item.identifier).forEach(function(identifier) {\n                    if (identifier.system === SYSTEM_IDENTIFIER_ENUM.shortname) {\n                        orgsList[item.id].shortname = identifier.value;\n                    }\n                });\n            }\n\n        });\n        items.forEach(function(item) {\n            if (item.partOf) {\n                parentId = item.partOf.reference.split(\"/\").pop();\n                if (orgsList[item.id]) {\n                    orgsList[item.id].parentOrgId = parentId;\n                }\n            }\n        });\n        if (items.length > 0) { this.initialized = true; }\n        this.orgsList = orgsList;\n        return orgsList;\n    };\n    OrgTool.prototype.getShortName = function(orgId) {\n        var shortName = \"\";\n        if (!orgId) { return shortName; }\n        var orgsList = this.getOrgsList();\n        var orgItem = orgsList.hasOwnProperty(orgId) ? orgsList[orgId]: {};\n        if (orgItem.shortname) {\n            shortName = orgItem.shortname;\n        }\n        return shortName;\n    };\n    OrgTool.prototype.populateUI = function(){\n        if (sessionStorage.orgsHTML) {\n            $(\"#fillOrgs\").html(sessionStorage.orgsHTML);\n            return true;\n        }\n        var self = this, container = $(\"#fillOrgs\"), orgsList = this.orgsList, parentContent = \"\";\n        var getState = (item) => {\n            if (!item.identifier) {\n                return \"\";\n            }\n            var s = \"\", found = false;\n            (item.identifier).forEach(function(i) {\n                if (!found && (i.system === SYSTEM_IDENTIFIER_ENUM.practice_region && i.value)) {\n                    s = (i.value).split(\":\")[1];\n                    found = true;\n                }\n            });\n            return s;\n        };\n        var keys = Object.keys(orgsList), parentOrgsArray = [];\n        keys = keys.sort();\n        keys.forEach(function(org) { //draw parent orgs first\n            if (orgsList[org].isTopLevel) {\n                parentOrgsArray.push(org);\n            }\n        });\n        parentOrgsArray = parentOrgsArray.sort(function(a, b) { //sort parent orgs by name\n            var orgA = orgsList[a], orgB = orgsList[b];\n            if (orgA.name < orgB.name) { return -1; }\n            if (orgA.name > orgB.name) { return 1; }\n            return 0;\n        });\n        var parentFragment = document.createDocumentFragment(), parentDiv;\n        parentOrgsArray.forEach(function(org) {\n            parentDiv = document.createElement(\"div\");\n            parentDiv.setAttribute(\"id\", org+\"_container\");\n            let parentOrgItem = orgsList[org];\n            let orgShortName = parentOrgItem.shortname || parentOrgItem.name;\n            let parentState = getState(parentOrgItem);\n            let parentOrgName = parentOrgItem.name;\n            if (parentOrgItem.children.length) {\n                if ($(\"#userOrgs legend[orgId='\" + org + \"']\").length === 0) {\n                    parentDiv.classList.add(\"parent-org-container\");\n                    parentContent = `<legend orgId=\"${org}\">${parentOrgName}</legend>\n                        <input class=\"tnth-hide\" type=\"checkbox\" name=\"organization\" parent_org=\"true\" data-org-name=\"${parentOrgName}\" data-short-name=\"${orgShortName}\" id=\"${org}_org\" state=\"${parentState}\" value=\"${org}\" /></div>`;\n                }\n            } else {\n                if ($(\"#userOrgs label[id='org-label-\" + org + \"']\").length === 0) {\n                    parentDiv.classList.add(\"parent-org-container\", \"parent-singleton\");\n                    parentContent = `<label id=\"org-label-${org}\" class=\"org-label\">\n                        <input class=\"clinic\" type=\"checkbox\" name=\"organization\" parent_org=\"true\" id=\"${org}_org\" state=\"${parentState}\" value=\"${org}\"\n                        data-parent-id=\"${org}\"  data-org-name=\"${parentOrgName}\" data-short-name=\"${orgShortName}\" data-parent-name=\"${parentOrgName}\"/><span>${parentOrgName}</span></label></div>`;\n                }\n            }\n            parentDiv.innerHTML = parentContent;\n            parentFragment.appendChild(parentDiv);\n        });\n        container.get(0).appendChild(parentFragment);\n        keys.forEach(function(org) { //draw child orgs\n            if (orgsList[org].children.length > 0) { // Fill in each child clinic\n                var childClinic = \"\";\n                var items = orgsList[org].children.sort(function(a, b) { // sort child clinic in alphabetical order\n                    if (a.name < b.name) { return -1; }\n                    if (a.name > b.name) { return 1; }\n                    return 0;\n                });\n                items.forEach(function(item) {\n                    var _parentOrgId = item.parentOrgId, _parentOrg = orgsList[_parentOrgId];\n                    var _isTopLevel = _parentOrg ? _parentOrg.isTopLevel : false;\n                    var state = getState(orgsList[_parentOrgId]);\n                    var topLevelOrgId = self.getTopLevelParentOrg(item.id);\n\n                    if ($(\"#fillOrgs input[name='organization'][value='\" + item.id + \"']\").length > 0) {\n                        return true;\n                    }\n                    var attrObj = {dataAttributes:(' data-parent-id=\"' + topLevelOrgId + '\"  data-parent-name=\"' + orgsList[topLevelOrgId].name + '\" '), containerClass: \"\", textClass: \"\"};\n                    if (_isTopLevel) {\n                        attrObj.dataAttributes = (' data-parent-id=\"' + _parentOrgId + '\"  data-parent-name=\"' + _parentOrg.name + '\" ');\n                    }\n                    if (orgsList[item.id].children.length > 0) {\n                        if (_isTopLevel) {\n                            attrObj.containerClass = \"sub-org-container\";\n                            attrObj.textClass = \"text-muted\";\n                        } else {\n                            attrObj.textClass = \"text-muter\";\n                        }\n                    } else {\n                        if (_isTopLevel) {\n                            attrObj.textClass = \"text-muted singleton\";\n                        }\n                    }\n                    childClinic = `<div id=\"${item.id}_container\" ${attrObj.dataAttributes} class=\"indent org-container ${attrObj.containerClass}\">\n                        <label id=\"org-label-${item.id}\" class=\"org-label ${attrObj.textClass}\">\n                        <input class=\"clinic\" type=\"checkbox\" name=\"organization\" id=\"${item.id}_org\" data-org-name=\"${item.name}\" data-short-name=\"${item.shortname || item.name}\" state=\"${state ? state : ''}\" value=\"${item.id}\" ${attrObj.dataAttributes} />\n                        <span>${item.name}</span></label></div>`;\n                    var parentOrgContainer = $(\"#\" + _parentOrgId + \"_container\");\n                    if (parentOrgContainer.length > 0) {\n                        parentOrgContainer.append(childClinic);\n                    } else {\n                        container.append(childClinic);\n                    }\n                });\n            }\n        });\n        sessionStorage.setItem(\"orgsHTML\", container.html());\n        if (!container.text()) {\n            container.html(i18next.t(\"No organizations available\"));\n        }\n    };\n    OrgTool.prototype.getSelectedOrgTopLevelParentOrg = function(){\n        return this.getTopLevelParentOrg(this.getSelectedOrg().val());\n    };\n    OrgTool.prototype.getSelectedOrg = function() {\n        return $(\"#userOrgs input[name='organization']:checked\");\n    };\n    OrgTool.prototype.getUserTopLevelParentOrgs = function(uo) {\n        var parentList = [], self = this;\n        if (!uo) {\n            return false;\n        }\n        if (uo.parentList) { return uo.parentList; }\n        uo.forEach(function(o) {\n            var p = self.getTopLevelParentOrg(o);\n            if (p && !self.inArray(p, parentList)) {\n                parentList.push(p);\n            }\n        });\n        uo.parentList = parentList;\n        return parentList;\n    };\n    OrgTool.prototype.getTopLevelParentOrg = function(currentOrg) {\n        var ml = this.getOrgsList(), currentOrgItem = ml[currentOrg], self = this;\n        if (!currentOrgItem) { return false; }\n        if (currentOrgItem.isTopLevel) {\n            return currentOrg;\n        }\n        if (currentOrgItem.parentOrgId) {\n            return self.getTopLevelParentOrg(currentOrgItem.parentOrgId);\n        }\n        return currentOrg;\n    };\n    OrgTool.prototype.getChildOrgs = function(orgs, orgList) {\n        orgList = orgList || [];\n        if (!orgs || !orgs.length) {\n            return orgList;\n        }\n        var mainOrgsList = this.getOrgsList(), childOrgs = [];\n        orgs.forEach(function(org) {\n            var o = mainOrgsList[org.id];\n            if (!o) {\n                return true;\n            }\n            orgList.push(org.id);\n            var c = o.children ? o.children : null;\n            if (c && c.length) {\n                c.forEach(function(i) {\n                    childOrgs.push(i);\n                });\n            }\n        });\n        return this.getChildOrgs(childOrgs, orgList);\n    };\n    OrgTool.prototype.getHereBelowOrgs = function(userOrgs) {\n        var mainOrgsList = this.getOrgsList(), self = this, here_below_orgs = [];\n        if (!userOrgs) {\n            var selectedOrg = this.getSelectedOrg();\n            if (selectedOrg.length > 0) {\n                userOrgs = [];\n                selectedOrg.each(function() {\n                    userOrgs.push($(this).val());\n                });\n            }\n        }\n        userOrgs = userOrgs || [];\n        userOrgs.forEach(function(orgId) {\n            here_below_orgs.push(orgId);\n            var co = mainOrgsList[orgId], cOrgs = self.getChildOrgs((co && co.children ? co.children : []));\n            if (cOrgs.length) {\n                here_below_orgs = here_below_orgs.concat(cOrgs);\n            }\n        });\n        return here_below_orgs;\n    };\n    OrgTool.prototype.morphPatientOrgs = function() {\n        var checkedOrgs = {}, orgs = $(\"#userOrgs input[name='organization']\");\n        orgs.each(function() {\n            $(this).closest(\"label\").addClass(\"radio-label\");\n            if ($(this).prop(\"checked\")) {\n                checkedOrgs[$(this).val()] = true;\n            }\n            $(this).attr(\"type\", \"radio\");\n            if (checkedOrgs[$(this).val()]) {\n                $(this).prop(\"checked\", true);\n            }\n        });\n        $(\"#userOrgs .noOrg-container\").hide();\n    };\n    return OrgTool;\n})();\n"],"sourceRoot":""}