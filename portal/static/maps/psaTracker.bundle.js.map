{"version":3,"sources":["webpack:///webpack/bootstrap","webpack:///./static/js/src/modules/SYSTEM_IDENTIFIER_ENUM.js","webpack:///./static/js/src/modules/Utility.js","webpack:///./static/js/src/modules/TnthDate.js","webpack:///./static/js/src/modules/CLINICAL_CODE_ENUM.js","webpack:///./static/js/src/modules/TnthAjax.js","webpack:///./static/js/src/psaTracker.js"],"names":["installedModules","__webpack_require__","moduleId","exports","module","i","l","modules","call","m","c","d","name","getter","o","Object","defineProperty","enumerable","get","r","Symbol","toStringTag","value","t","mode","__esModule","ns","create","key","bind","n","object","property","prototype","hasOwnProperty","p","s","__webpack_exports__","external_study_id","external_site_id","practice_region","race","race_system","ethnicity","ethnicity_system","indigenous","timezone","language","language_system","shortname","SNOMED_SYS_URL","CLINICAL_SYS_URL","CANCER_TREATMENT_CODE","NONE_TREATMENT_CODE","getExportFileName","getUrlParameter","UtilityObj","Utility","this","requestAttempts","hasValue","val","String","showMain","$","css","visibility","-ms-filter","filter","-moz-opacity","-khtml-opacity","opacity","hideLoader","delay","time","hide","setTimeout","fadeOut","loader","show","document","getElementById","isDelayLoading","self","DELAY_LOADING","isTouchDevice","window","DocumentTouch","getIEVersion","match","navigator","userAgent","parseInt","newHttpRequest","url","params","callBack","xmlhttp","param","XDomainRequest","onload","responseText","XMLHttpRequest","ActiveXObject","onreadystatechange","readyState","status","error","open","setRequestHeader","cache","send","ajaxRequest","callback","i18next","defaults","type","contentType","timeout","extend","uself","ajax","done","data","fail","always","initWorker","callbackFunc","worker","Worker","postMessage","addEventListener","e","terminate","console","log","lineno","filename","message","workerAllowed","getRequestMethod","sendRequest","useWorker","LRKeyEvent","length","on","keyCode","toggleClass","getLoaderHTML","concat","convertToNumericField","field","each","prop","isString","obj","toString","disableHeaderFooterLinks","links","not","addClass","off","preventDefault","pad","isNaN","escapeHtml","text","replace","a","\"","&","'","/","<",">","containHtmlTags","test","prefix","Date","getDate","slice","getMonth","getFullYear","capitalize","str","txt","charAt","toUpperCase","substr","toLowerCase","restoreVis","loadingElement","mainElement","setAttribute","VueErrorHandling","Vue","config","errorHandler","err","vm","info","handler","current","$options","$parent","extension","results","RegExp","exec","location","search","decodeURIComponent","resetBrowserBackHistory","locationUrl","stateObject","title","historyDefined","history","pushState","href","forward","handlePostLogout","sessionStorage","getItem","orgin","removeItem","displaySystemOutageMessage","locale","MAINTENANCE_MESSAGE","MAINTENANCE_WINDOW","messageElement","querySelector","createElement","classList","add","appendChild","innerHTML","d1","d2","startDate","endDate","hoursTil","Math","floor","getTime","options","year","month","day","hour","minute","second","hour12","timeZoneName","displayStartDate","toLocaleString","displayEndDate","join","validateDateInputFields","tnthDates","monthField","dayField","yearField","errorFieldId","y","validity","valid","errorField","today","date","html","setHours","swap_mm_dd","currentDate","splitDate","split","convertMonthNumeric","jan","feb","mar","apr","may","jun","jul","aug","sep","oct","nov","dec","convertMonthString","1","2","3","4","5","6","7","8","9","10","11","12","isDate","displayDateString","getDateDiff","dateToCalc","dateTime","isValidDefaultDateFormat","dArray","trim","dt","isDateObj","isValidDate","errorMsg","getDateObj","convertedDate","getConvertedDate","givenDate","getGivenDate","h","mi","dateObj","formatDateString","dateString","format","hours","minutes","seconds","nd","iosDateTest","getHours","getMinutes","getSeconds","convertToLocalTime","newDate","getTimezoneOffset","offset","getDateWithTimeZone","dObj","utcDate","getTodayDateObj","td","tm","ty","th","tmi","ts","gmtToday","displayDay","displayMonth","displayYear","displayHour","displayMinute","displaySecond","gmtDate","dateValidator","restrictToPresent","errorMessage","iy","im","iid","CLINICAL_CODE_ENUM","biopsy","code","display","pca_diag","pca_localized","beforeSend","ajaxSetup","xhr","settings","crossDomain","method","userId","defaultParams","attempts","max_attempts","dataType","sync","async","fieldHelper","FieldLoaderHelper","targetField","showLoader","result","JSON","parse","sendError","showError","showUpdate","headers","cache-control","expires","pragma","stringify","reportError","page_url","subject_id","delayDuration","el","attr","__timeout","containerId","successField","loadingField","removeClass","animate","getCurrentUser","currentUser","id","setItem","getStillNeededCoreData","entry_method","__url","getRequiredCoreData","required","getOptionalCoreData","sessionStorageKey","getPortalFooter","getOrgs","demoOrgsData","getConsent","setConsent","hasConsent","org","testPatient","user_id","organization_id","agreement_url","agreementUrl","staff_editable","include_in_reports","send_reminders","acceptance_date","deleteConsent","consented","getAllValidConsent","arrExcludedOrgIds","exclude","arrConsents","grep","orgId","eOrg","forEach","withdrawConsent","arrConsent","consent_agreements","item","expired","deleted","consentedOrgIds","map","filterStatus","getDemo","demoDataKey","clearDemoSessionData","putDemo","toSend","getLocale","communication","hasTreatment","entry","sortedArray","sort","b","resource","meta","lastUpdated","found","resourceItemCode","coding","system","procId","SYSTEM_IDENTIFIER_ENUM","getTreatment","postTreatment","started","treatmentDate","deleteTreatment","procID","procArray","subject","reference","performedDateTime","postProc","treatmentData","deleteProc","getProc","newEntry","procedureId","getRoleList","getRoles","removeCachedRoles","putRoles","deleteRoles","getClinical","getObservationId","obId","_code","content","postClinical","toCall","obsCode","obsArray","issued","issuedDate","valueQuantity","units","performer","obsId","getTermsUrl","getInstrumentsList","qList","organization","orgID","questionnaires","q","inArray","questionnaire","push","getTerms","postTermsByUser","postTerms","accessUrl","access_url","invite","passwordReset","assessmentStatus","updateAssessment","assessmentList","assessmentReport","instrumentId","getCurrentQB","completionDate","as_of_date","patientReport","setTablePreference","tableName","getTablePreference","arguments","undefined","emailLog","auditLog","setting","deactivateUser","reactivateUser","getConfigurationByKey","configVar","sessionConfigKey","getConfiguration","getEmailReady","psaApp","_modules_TnthAjax_js__WEBPACK_IMPORTED_MODULE_0__","_modules_TnthDate_js__WEBPACK_IMPORTED_MODULE_1__","_modules_SYSTEM_IDENTIFIER_ENUM_js__WEBPACK_IMPORTED_MODULE_2__","components","refresh-icon","props","template","filter-control","errorCaptured","Error","Component","dataError","errorElement","warn","created","userIdKey","clinicalCode","clinicalDisplay","clinicalSystem","loading","savingInProgress","addErrorMessage","noResultMessage","editText","saveText","closeText","filterText","yLegendText","xLegendText","MAX_RESULT","treatmentEditUrl","newItem","edit","intro","header","body","addText","fields","resultLabel","dateLabel","resultPlaceholder","datePlaceholder","items","buttonLabel","sidenote","originals","resultRange","RANGE_ENUM","<= 4",">= 2",">= 3",">= 4",">= 5","filters","filterYearPrompt","filterResultPrompt","selectedFilterYearValue","selectedFilterResultRange","clearLabel","showRefresh","treatment","treatmentTextPrompt","treatmentDatePrompt","noTreatmentText","modalLoading","editLink","editTitle","addTitle","computed","yearList","titleYear","index","indexOf","methods","init","dependencies","getData","getProcedure","initElementsEvents","isActedOn","isEdit","refresh","clearFilter","getAddModalTitle","getRefreshMessage","validateResult","isValid","validateDate","datepicker","forceParse","maxViewMode","autoclose","trigger","clearNew","focus","getCurrentUserId","tnthAjax","getExistingItemByDate","onEdit","modal","isValidData","newResult","onAdd","existingItem","postData","substring","showTreatment","patch_dstu2","dataObj","contentCoding","updated","tempResults","getHistoryMinYear","filterData","drawGraph","showHistory","yearArray","redraw","filterDataByYearEvent","event","target","filterDataByResultEvent","showFilters","cDate","__handleTreatmentDate","minDate","maxDate","step","startMinDate","setUTCDate","getUTCDate","startMaxDate","getNearestPow10","base","LN10","ceil","pow","getRange","size","startAt","arr","getDayInMiliseconds","getInterval","DAY","DIFF","dateTicks","t0","t1","startTime","endTime","times","INTERVAL","setLetterSpacing","string","dxString","d3","margin","width","height","timeFormat","parseDate","graph_date","min","max","maxResult","xDomain","extent","bound","x","scale","range","firstDate","setDate","maxResultInLog","domain","xAxis","svg","axis","orient","ticks","tickSize","tickFormat","yAxis","valueline","line","select","append","graphArea","selectAll","textNode","arrDate","style","tickValues","tooltipContainer","RECT_WIDTH","enter","transition","duration","element","circleRadius","classed","TOOLTIP_WIDTH","pageX","pageY"],"mappings":"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","file":"psaTracker.bundle.js","sourcesContent":[" \t// The module cache\n \tvar installedModules = {};\n\n \t// The require function\n \tfunction __webpack_require__(moduleId) {\n\n \t\t// Check if module is in cache\n \t\tif(installedModules[moduleId]) {\n \t\t\treturn installedModules[moduleId].exports;\n \t\t}\n \t\t// Create a new module (and put it into the cache)\n \t\tvar module = installedModules[moduleId] = {\n \t\t\ti: moduleId,\n \t\t\tl: false,\n \t\t\texports: {}\n \t\t};\n\n \t\t// Execute the module function\n \t\tmodules[moduleId].call(module.exports, module, module.exports, __webpack_require__);\n\n \t\t// Flag the module as loaded\n \t\tmodule.l = true;\n\n \t\t// Return the exports of the module\n \t\treturn module.exports;\n \t}\n\n\n \t// expose the modules object (__webpack_modules__)\n \t__webpack_require__.m = modules;\n\n \t// expose the module cache\n \t__webpack_require__.c = installedModules;\n\n \t// define getter function for harmony exports\n \t__webpack_require__.d = function(exports, name, getter) {\n \t\tif(!__webpack_require__.o(exports, name)) {\n \t\t\tObject.defineProperty(exports, name, { enumerable: true, get: getter });\n \t\t}\n \t};\n\n \t// define __esModule on exports\n \t__webpack_require__.r = function(exports) {\n \t\tif(typeof Symbol !== 'undefined' && Symbol.toStringTag) {\n \t\t\tObject.defineProperty(exports, Symbol.toStringTag, { value: 'Module' });\n \t\t}\n \t\tObject.defineProperty(exports, '__esModule', { value: true });\n \t};\n\n \t// create a fake namespace object\n \t// mode & 1: value is a module id, require it\n \t// mode & 2: merge all properties of value into the ns\n \t// mode & 4: return value when already ns object\n \t// mode & 8|1: behave like require\n \t__webpack_require__.t = function(value, mode) {\n \t\tif(mode & 1) value = __webpack_require__(value);\n \t\tif(mode & 8) return value;\n \t\tif((mode & 4) && typeof value === 'object' && value && value.__esModule) return value;\n \t\tvar ns = Object.create(null);\n \t\t__webpack_require__.r(ns);\n \t\tObject.defineProperty(ns, 'default', { enumerable: true, value: value });\n \t\tif(mode & 2 && typeof value != 'string') for(var key in value) __webpack_require__.d(ns, key, function(key) { return value[key]; }.bind(null, key));\n \t\treturn ns;\n \t};\n\n \t// getDefaultExport function for compatibility with non-harmony modules\n \t__webpack_require__.n = function(module) {\n \t\tvar getter = module && module.__esModule ?\n \t\t\tfunction getDefault() { return module['default']; } :\n \t\t\tfunction getModuleExports() { return module; };\n \t\t__webpack_require__.d(getter, 'a', getter);\n \t\treturn getter;\n \t};\n\n \t// Object.prototype.hasOwnProperty.call\n \t__webpack_require__.o = function(object, property) { return Object.prototype.hasOwnProperty.call(object, property); };\n\n \t// __webpack_public_path__\n \t__webpack_require__.p = \"\";\n\n\n \t// Load entry module and return exports\n \treturn __webpack_require__(__webpack_require__.s = 14);\n","export default {\n    \"external_study_id\": \"http://us.truenth.org/identity-codes/external-study-id\",\n    \"external_site_id\": \"http://us.truenth.org/identity-codes/external-site-id\",\n    \"practice_region\": \"http://us.truenth.org/identity-codes/practice-region\",\n    \"race\": \"http://hl7.org/fhir/StructureDefinition/us-core-race\",\n    \"race_system\": \"http://hl7.org/fhir/v3/Race\",\n    \"ethnicity\": \"http://hl7.org/fhir/StructureDefinition/us-core-ethnicity\",\n    \"ethnicity_system\": \"http://hl7.org/fhir/v3/Ethnicity\",\n    \"indigenous\": \"http://us.truenth.org/fhir/StructureDefinition/AU-NHHD-METeOR-id-291036\",\n    \"timezone\": \"http://hl7.org/fhir/StructureDefinition/user-timezone\",\n    \"language\": \"http://hl7.org/fhir/valueset/languages\",\n    \"language_system\": \"urn:ietf:bcp:47\",\n    \"shortname\": \"http://us.truenth.org/identity-codes/shortname\",\n    SNOMED_SYS_URL: \"http://snomed.info/sct\",\n    CLINICAL_SYS_URL: \"http://us.truenth.org/clinical-codes\",\n    CANCER_TREATMENT_CODE: \"118877007\",\n    NONE_TREATMENT_CODE: \"999\"\n};\n\n","var Utility = (function() {\n    var UtilityObj = function() { /*global $ */\n        this.requestAttempts = 0;\n    };\n    UtilityObj.prototype.hasValue = function(val) {\n        return String(val) !== \"null\" && String(val) !== \"\" && String(val) !== \"undefined\";\n    };\n    UtilityObj.prototype.showMain = function() {\n        $(\"#mainHolder\").css({\n            \"visibility\": \"visible\",\n            \"-ms-filter\": \"progid:DXImageTransform.Microsoft.Alpha(Opacity=100)\",\n            \"filter\": \"alpha(opacity=100)\",\n            \"-moz-opacity\": 1,\n            \"-khtml-opacity\": 1,\n            \"opacity\": 1\n        });\n    };\n    UtilityObj.prototype.hideLoader = function(delay, time) {\n        if (delay) {\n            $(\"#loadingIndicator\").hide();\n            return;\n        }\n        setTimeout(function() {\n            $(\"#loadingIndicator\").fadeOut();\n        }, time || 200);\n    };\n    UtilityObj.prototype.loader = function(show) {\n        //landing page\n        if (document.getElementById(\"fullSizeContainer\")) {\n            this.hideLoader();\n            this.showMain();\n            return false;\n        }\n        if (show) {\n            $(\"#loadingIndicator\").show();\n            return;\n        }\n        if (!this.isDelayLoading()) {\n            var self = this;\n            setTimeout(function() {\n                self.showMain();\n            }, 100);\n            this.hideLoader(true, 350);\n        }\n    };\n    UtilityObj.prototype.isDelayLoading = function() { /*global DELAY_LOADING*/\n        return (typeof DELAY_LOADING !== \"undefined\") && DELAY_LOADING;\n    };\n    UtilityObj.prototype.isTouchDevice = function() {\n        return true === (\"ontouchstart\" in window || window.DocumentTouch && document instanceof window.DocumentTouch);\n    };\n    UtilityObj.prototype.getIEVersion = function() {\n        var match = navigator.userAgent.match(/(?:MSIE |Trident\\/.*; rv:)(\\d+)/);\n        return match ? parseInt(match[1]) : false;\n    };\n    UtilityObj.prototype.newHttpRequest = function(url, params, callBack) { /* note: this function supports older version of IE (version <= 9) - jquery ajax calls errored in older IE version*/\n        this.requestAttempts++;\n        var xmlhttp, self = this;\n        callBack = callBack || function() {};\n        if (window.XDomainRequest) { /*global XDomainRequest */\n            xmlhttp = new XDomainRequest();\n            xmlhttp.onload = function() {\n                callBack(xmlhttp.responseText);\n            };\n        } else if (window.XMLHttpRequest) {\n            xmlhttp = new XMLHttpRequest();\n        } else {\n            xmlhttp = new ActiveXObject(\"Microsoft.XMLHTTP\"); /*global ActiveXObject */\n        }\n        xmlhttp.onreadystatechange = function() {\n            if (xmlhttp.readyState === 4) {\n                if (xmlhttp.status === 200) {\n                    callBack(xmlhttp.responseText);\n                    self.requestAttempts = 0;\n                    return;\n                }\n                if (self.requestAttempts < 3) {\n                    setTimeout(function() {\n                        self.newHttpRequest(url, params, callBack);\n                    }, 3000);\n                } else {\n                    callBack({error: xmlhttp.responseText});\n                    self.loader();\n                    self.requestAttempts = 0;\n                }\n            }\n        };\n        params = params || {};\n        xmlhttp.open(\"GET\", url, true);\n        for (var param in params) {\n            if (params.hasOwnProperty(param)) {\n                xmlhttp.setRequestHeader(param, params[param]);\n            }\n        }\n        if (!params.cache) {\n            xmlhttp.setRequestHeader(\"cache-control\", \"no-cache\");\n            xmlhttp.setRequestHeader(\"expires\", \"-1\");\n            xmlhttp.setRequestHeader(\"pragma\", \"no-cache\"); //legacy HTTP 1.0 servers and IE support\n        }\n        xmlhttp.send();\n    };\n    UtilityObj.prototype.ajaxRequest = function(url, params, callback) {\n        callback = callback || function() {};\n        if (!url) {\n            callback({error: i18next.t(\"Url is required.\")});\n            return false;\n        }\n        var defaults = {\n            url: url,\n            type: \"GET\",\n            contentType: \"text/plain\",\n            timeout: 5000,\n            cache: false\n        };\n        params = params || defaults;\n        params = $.extend({}, defaults, params);\n        this.requestAttempts++;\n        var uself = this;\n        $.ajax(params).done(function(data) {\n            callback(data);\n            uself.requestAttempts = 0;\n        }).fail(function() {\n            if (uself.requestAttempts <= 3) {\n                setTimeout(function() { uself.ajaxRequest(url, params, callback);}, 3000);\n            } else {\n                callback({error: i18next.t(\"Error occurred processing request\")}); /*global i18next */\n                uself.requestAttempts = 0;\n                uself.loader();\n            }\n        }).always(function() {\n            uself.loader();\n        });\n    };\n    UtilityObj.prototype.initWorker = function(url, params, callbackFunc) {\n        var worker = new Worker(\"/static/js/ajaxWorker.js\");\n        var self = this;\n        worker.postMessage({url: url, params: params});\n        worker.addEventListener(\"message\", function(e) {\n            (callbackFunc).call(self, e.data);\n            worker.terminate();\n        }, false);\n        worker.addEventListener(\"error\", function(e) {\n            console.log(\"Worker runtime error: Line \", e.lineno, \" in \", e.filename, \": \", e.message);\n            worker.terminate();\n        }, false);\n    };\n    UtilityObj.prototype.workerAllowed = function() {\n        return window.Worker && !this.isTouchDevice();\n    };\n    UtilityObj.prototype.getRequestMethod = function() {\n        return this.getIEVersion() ? this.newHttpRequest: this.ajaxRequest; //NOTE JQuery ajax request does not work for IE <= 9\n    };\n    UtilityObj.prototype.sendRequest = function(url, params, callback) { /*generic function for sending GET ajax request, make use of worker if possible */\n        params = params || {};\n        if (params.useWorker && this.workerAllowed()) {\n            this.initWorker(url, params, callback);\n            return true;\n        }\n        var useFunc = this.getRequestMethod();\n        (useFunc).call(this, url, params, function(data) { (callback).call(this, data);});\n    };\n    UtilityObj.prototype.LRKeyEvent = function() {\n        var LR_INVOKE_KEYCODE = 187;\n        if ($(\".button--LR\").length > 0) {\n            $(\"html\").on(\"keydown\", function(e) {\n                if (parseInt(e.keyCode) === parseInt(LR_INVOKE_KEYCODE)) {\n                    $(\".button--LR\").toggleClass(\"data-show\");\n                }\n            });\n        }\n    };\n    UtilityObj.prototype.getLoaderHTML = function(message) {\n        return `<div class=\"loading-message-indicator\"><i class=\"fa fa-spinner fa-spin fa-2x\"></i>${message ? \"&nbsp;\" + message : \"\"}</div>`;\n    };\n    UtilityObj.prototype.convertToNumericField = function(field) {\n        if (!field) {\n            return;\n        }\n        if (this.isTouchDevice()) {\n            field.each(function() {\n                $(this).prop(\"type\", \"tel\");\n            });\n        }\n    };\n    UtilityObj.prototype.isString = function(obj) {\n        return (Object.prototype.toString.call(obj) === \"[object String]\");\n    };\n    UtilityObj.prototype.disableHeaderFooterLinks = function() {\n        var links = $(\"#tnthNavWrapper a, #homeFooter a\").not(\"a[href*='logout']\").not(\"a.required-link\").not(\"a.home-link\");\n        links.addClass(\"disabled\");\n        links.prop(\"onclick\", null).off(\"click\");\n        links.on(\"click\", function(e) {\n            e.preventDefault();\n            return false;\n        });\n    };\n    UtilityObj.prototype.pad = function(n) {\n        n = parseInt(n);\n        return (!isNaN(n) && n < 10) ? \"0\" + n : n;\n    };\n    UtilityObj.prototype.escapeHtml = function(text) {\n        \"use strict\";\n        if (text === null || text !== \"undefined\" || String(text).length === 0) {\n            return text;\n        }\n        return text.replace(/[\\\"&'\\/<>]/g, function(a) {\n            return {\n                '\"': \"&quot;\",\n                \"&\": \"&amp;\",\n                \"'\": \"&#39;\",\n                \"/\": \"&#47;\",\n                \"<\": \"&lt;\",\n                \">\": \"&gt;\"\n            }[a];\n        });\n    };\n    UtilityObj.prototype.containHtmlTags = function(text) {\n        if (!text) {\n            return false;\n        }\n        return /[<>]/.test(text);\n    };\n    UtilityObj.prototype.getExportFileName = function(prefix) {\n        var d = new Date();\n        return (prefix ? prefix : \"ExportList_\") + (\"00\" + d.getDate()).slice(-2) + (\"00\" + (d.getMonth() + 1)).slice(-2) + d.getFullYear();\n    };\n    UtilityObj.prototype.capitalize = function(str) {\n        return str.replace(/\\w\\S*/g, function(txt) {\n            return txt.charAt(0).toUpperCase() + txt.substr(1).toLowerCase();\n        });\n    };\n    UtilityObj.prototype.restoreVis = function() {\n        var loadingElement = document.getElementById(\"loadingIndicator\"), mainElement = document.getElementById(\"mainHolder\");\n        if (loadingElement) { loadingElement.setAttribute(\"style\", \"display:none; visibility:hidden;\"); }\n        if (mainElement) { mainElement.setAttribute(\"style\", \"visibility:visible;-ms-filter:'progid:DXImageTransform.Microsoft.Alpha(Opacity=100)';filter:alpha(opacity=100); -moz-opacity:1; -khtml-opacity:1; opacity:1\"); }\n    };\n    UtilityObj.prototype.VueErrorHandling = function() {\n        if (typeof Vue === \"undefined\") { return false; } /*global Vue */\n        var self = this;\n        Vue.config.errorHandler = function (err, vm, info)  {\n            var handler, current = vm;\n            if (vm.$options.errorHandler) {\n                handler = vm.$options.errorHandler;\n            } else {\n                while (!handler && current.$parent) {\n                    current = current.$parent;\n                    handler = current.$options.errorHandler;\n                }\n            }\n            self.restoreVis();\n            if (handler) {\n                handler.call(current, err, vm, info);\n                return;\n            }\n            console.log(err);\n        };\n    };\n    UtilityObj.prototype.extend = function(obj, extension) { // Extend an object with an extension\n        for (var key in extension) {\n            if (extension.hasOwnProperty(key)) {\n                obj[key] = extension[key];\n            }\n        }\n        return obj;\n    };\n    UtilityObj.prototype.getUrlParameter = function(name) {\n        name = name.replace(/[\\[]/, \"\\\\[\").replace(/[\\]]/, \"\\\\]\");\n        var regex = new RegExp(\"[\\\\?&]\" + name + \"=([^&#]*)\");\n        var results = regex.exec(location.search);\n        return results === null ? \"\" : decodeURIComponent(results[1]);\n    };\n    UtilityObj.prototype.resetBrowserBackHistory = function(locationUrl, stateObject, title) {\n        var historyDefined = typeof history !== \"undefined\" && history.pushState;\n        locationUrl = locationUrl || location.href;\n        if (historyDefined) {\n            history.pushState(stateObject, title, locationUrl);\n        }\n        window.addEventListener(\"popstate\", function() {\n            if (historyDefined) {\n                history.pushState(stateObject, title, locationUrl);\n            } else {\n                window.history.forward(1);\n            }\n        });\n    };\n    UtilityObj.prototype.handlePostLogout = function() {\n        if (typeof sessionStorage === \"undefined\") {\n            return false;\n        }\n        if (sessionStorage.getItem(\"logout\")) {\n            this.resetBrowserBackHistory(location.orgin, \"logout\"); /* global resetBrowserBackHistory */\n            sessionStorage.removeItem(\"logout\");\n        }\n    };\n    UtilityObj.prototype.displaySystemOutageMessage = function(locale) {\n        locale = locale || \"en-us\";\n        locale = locale.replace(\"_\", \"-\");\n        var systemMaintenanceElId = \"systemMaintenanceContainer\";\n        if (!document.getElementById(systemMaintenanceElId)) { //check for system outage maintenance message element\n            return;\n        }\n        var self = this;\n        this.ajaxRequest(\"api/settings\", {contentType: \"application/json; charset=utf-8\"}, function(data) {\n            if (!data || !(data.MAINTENANCE_MESSAGE || data.MAINTENANCE_WINDOW)) {\n                return false;\n            }\n            var messageElement = document.querySelector(\".message-container\");\n            if (!messageElement) {\n                messageElement = document.createElement(\"div\");\n                messageElement.classList.add(\"message-container\");\n                document.getElementById(systemMaintenanceElId).appendChild(messageElement);\n            }\n            if (data.MAINTENANCE_MESSAGE) {\n                messageElement.innerHTML = self.escapeHtml(data.MAINTENANCE_MESSAGE);\n                return;\n            }\n            if (!data.MAINTENANCE_WINDOW || !data.MAINTENANCE_WINDOW.length) {\n                return;\n            }\n            //use maintenance window specified in config to compose the message, assuming in following example format: [\"2018-11-02T12:00:00Z\", \"2018-11-02T18:00:00Z\"], dates in system ISO format\n            var hoursDiff = function(d1, d2) {\n                if (!d1 || !d2) {\n                    return 0;\n                }\n                return Math.floor(((d2.getTime() - d1.getTime())/ (1000 * 60 * 60)) % 24);\n            };\n            //date object automatically convert iso date/time to local date/time as it assumes a timezone of UTC if date in ISO format\n            var startDate = new Date(data.MAINTENANCE_WINDOW[0]), endDate = new Date(data.MAINTENANCE_WINDOW[1]);\n            var hoursTil = hoursDiff(new Date(), startDate);\n            if (hoursTil < 0 || isNaN(hoursTil)) { //maintenance window has passed\n                document.getElementById(systemMaintenanceElId).classList.add(\"tnth-hide\");\n                return;\n            }\n            /*global i18next */\n            //construct message based on maintenance window\n            try {\n                var options = {year: \"numeric\", month: \"long\", day: \"numeric\", hour: \"numeric\", minute: \"numeric\", second: \"numeric\", hour12: true, timeZoneName: \"short\"};\n                var displayStartDate = startDate.toLocaleString(locale,options).replace(/[,]/g, \" \"); //display language-sensitive representation of date/time\n                var displayEndDate = endDate.toLocaleString(locale, options).replace(/[,]/g, \" \");\n                var message = [\"<div>\" + i18next.t(\"Hi there.\") + \"</div>\",\n                    \"<div>\" + i18next.t(\"TrueNTH will be down for website maintenance starting <b>{startdate}</b>. This should last until <b>{enddate}</b>.\".replace(\"{startdate}\", displayStartDate).replace(\"{enddate}\", displayEndDate)) + \"</div>\",\n                    \"<div>\" + i18next.t(\"Thanks for your patience while we upgrade our site.\") + \"</div>\"].join(\"\");\n                messageElement.innerHTML = self.escapeHtml(message);\n            } catch(e) {\n                console.log(\"Error occurred converting system outage date/time \", e); /*eslint no-console:off */\n                document.getElementById(systemMaintenanceElId).classList.add(\"tnth-hide\");\n            }\n        });\n    };\n    return new UtilityObj();\n})();\nexport default Utility;\nexport var getExportFileName = Utility.getExportFileName; /* expose common functions */\nexport var getUrlParameter= Utility.getUrlParameter;\n","var tnthDates =  { /*global i18next */\n    /** validateDateInputFields  check whether the date is a sensible date in month, day and year fields.\n     ** params: month, day and year fields and error field ID\n     ** NOTE this can replace the custom validation check; hook this up to the onchange/blur event of birthday field\n     ** work better in conjunction with HTML5 native validation check on the field e.g. required, pattern match  ***/\n    \"validateDateInputFields\": function(monthField, dayField, yearField, errorFieldId) {\n        var m = $(monthField).val(), d = $(dayField).val(), y = $(yearField).val();\n        if (m && d && y) {\n            if ($(yearField).get(0).validity.valid && $(monthField).get(0).validity.valid && $(dayField).get(0).validity.valid) {\n                m = parseInt(m);\n                d = parseInt(d);\n                y = parseInt(y);\n                var errorField = $(\"#\" + errorFieldId);\n\n                if (!(isNaN(m)) && !(isNaN(d)) && !(isNaN(y))) {\n                    var today = new Date();\n                    var date = new Date(y, m - 1, d);\n                    if (!(date.getFullYear() === y && (date.getMonth() + 1) === m && date.getDate() === d)) { // Check to see if this is a real date\n                        errorField.html(i18next.t(\"Invalid date. Please try again.\")).show();\n                        return false;\n                    } else if (date.setHours(0, 0, 0, 0) > today.setHours(0, 0, 0, 0)) {\n                        errorField.html(i18next.t(\"Date must not be in the future. Please try again.\")).show();\n                        return false; //shouldn't be in the future\n                    } else if (y < 1900) {\n                        errorField.html(i18next.t(\"Date must not be before 1900. Please try again.\")).show();\n                        return false;\n                    }\n                    errorField.html(\"\").hide();\n                    return true;\n                } else {\n                    return false;\n                }\n            } else {\n                return false;\n            }\n        } else {\n            return false;\n        }\n    },\n    /**\n     * Simply swaps: a/b/cdef to b/a/cdef (single & double digit permutations accepted...)\n     * Does not check for valid dates on input or output!\n     * @param currentDate string eg 7/4/1976\n     * @returns string eg 4/7/1976\n     */\n    \"swap_mm_dd\": function(currentDate) {\n        var splitDate = currentDate.split(\"/\");\n        return splitDate[1] + \"/\" + splitDate[0] + \"/\" + splitDate[2];\n    },\n    \"convertMonthNumeric\": function(month) { //Convert month string to numeric\n        if (!month) { return \"\"; }\n        else {\n            var month_map = {\"jan\": 1,\"feb\": 2,\"mar\": 3,\"apr\": 4,\"may\": 5,\"jun\": 6,\"jul\": 7,\"aug\": 8,\"sep\": 9,\"oct\": 10,\"nov\": 11,\"dec\": 12};\n            var m = month_map[month.toLowerCase()];\n            return m ? m : \"\";\n        }\n    },\n    \"convertMonthString\": function(month) { //Convert month string to text\n        if (!month) {\n            return \"\";\n        } else {\n            var numeric_month_map = {1: \"Jan\",2: \"Feb\",3: \"Mar\",4: \"Apr\",5: \"May\",6: \"Jun\",7: \"Jul\",8: \"Aug\",9: \"Sep\",10: \"Oct\",11: \"Nov\",12: \"Dec\"};\n            var m = numeric_month_map[parseInt(month)];\n            return m ? m : \"\";\n        }\n    },\n    \"isDate\": function(obj) {\n        return Object.prototype.toString.call(obj) === \"[object Date]\" && !isNaN(obj.getTime());\n    },\n    \"displayDateString\": function(m, d, y) {\n        var s = \"\";\n        s += (d ? d : \"\");\n        if (m) {\n            s += (s ? \" \" : \"\") + this.convertMonthString(m);\n        }\n        if (y) {\n            s += (s ? \" \" : \"\") + y;\n        }\n        return s;\n    },\n    /***\n     * Calculates number of days between two dates. Used in mPOWEr for surgery/discharge\n     * @param startDate - required. Assumes YYYY-MM-DD. This is typically the date of surgery or discharge\n     * @param dateToCalc - optional. If empty, then assumes today's date\n     * @returns number of days\n     */\n    \"getDateDiff\": function(startDate, dateToCalc) {\n        var a = startDate.split(/[^0-9]/);\n        var dateTime = new Date(a[0], a[1] - 1, a[2]).getTime();\n        var d;\n        if (dateToCalc) {\n            var c = dateToCalc.split(/[^0-9]/);\n            d = new Date(c[0], c[1] - 1, c[2]).getTime();\n        } else { // If no baseDate, then use today to find the number of days between dateToCalc and today\n            d = new Date().getTime();\n        }\n        return Math.floor((d - dateTime) / (1000 * 60 * 60 * 24)); // Round down to floor so we don't add an extra day if session is 12+ hours into the day\n    },\n    \"isValidDefaultDateFormat\": function(date, errorField) {\n        if (!date || date.length < 10) { return false; }\n        var dArray = $.trim(date).split(\" \");\n        if (dArray.length < 3) { return false; }\n        var day = parseInt(dArray[0])+\"\", month = dArray[1], year = dArray[2];\n        if (day.length < 1 || month.length < 3 || year.length < 4) { return false; }\n        if (!/(0)?[1-9]|1\\d|2\\d|3[01]/.test(day)) { return false; }\n        if (!/jan|feb|mar|apr|may|jun|jul|aug|sep|oct|nov|dec/i.test(month)) { return false; }\n        if (!/(19|20)\\d{2}/.test(year)) { return false; }\n        var dt = new Date(date);\n        if (!this.isDateObj(dt)) { return false; }\n        else if (!this.isValidDate(year, this.convertMonthNumeric(month), day)) {\n            return false;\n        } else {\n            var today = new Date(),\n                errorMsg = \"\";\n            if (dt.getFullYear() < 1900) { errorMsg = \"Year must be after 1900\"; }\n            // Only allow if date is before today\n            if (dt.setHours(0, 0, 0, 0) > today.setHours(0, 0, 0, 0)) {\n                errorMsg = \"The date must not be in the future.\";\n            }\n            if (errorMsg) {\n                $(errorField).text(errorMsg);\n                return false;\n            } else {\n                $(errorField).text(\"\");\n                return true;\n            }\n        }\n    },\n    \"isDateObj\": function(d) {\n        return Object.prototype.toString.call(d) === \"[object Date]\" && !isNaN(d.getTime());\n    },\n    \"isValidDate\": function(y, m, d) {\n        var date = this.getDateObj(y, m, d), convertedDate = this.getConvertedDate(date), givenDate = this.getGivenDate(y, m, d);\n        return String(givenDate) === String(convertedDate);\n    },\n    /*\n     * method does not check for valid numbers, will return NaN if conversion failed\n     */\n    \"getDateObj\": function(y, m, d, h, mi, s) {\n        h = h || 0;\n        mi = mi || 0;\n        s = s || 0;\n        return new Date(parseInt(y), parseInt(m) - 1, parseInt(d), parseInt(h), parseInt(mi), parseInt(s));\n    },\n    \"getConvertedDate\": function(dateObj) {\n        if (dateObj && this.isDateObj(dateObj)) { return \"\" + dateObj.getFullYear() + (dateObj.getMonth() + 1) + dateObj.getDate(); }\n        else { return \"\"; }\n    },\n    \"getGivenDate\": function(y, m, d) {\n        return \"\" + y + m + d;\n    },\n    \"formatDateString\": function(dateString, format) { //NB For dateString in ISO-8601 format date as returned from server e.g. '2011-06-29T16:52:48'\n        if (dateString) {\n            var iosDateTest = /^([\\+-]?\\d{4}(?!\\d{2}\\b))((-?)((0[1-9]|1[0-2])(\\3([12]\\d|0[1-9]|3[01]))?|W([0-4]\\d|5[0-2])(-?[1-7])?|(00[1-9]|0[1-9]\\d|[12]\\d{2}|3([0-5]\\d|6[1-6])))([T\\s]((([01]\\d|2[0-3])((:?)[0-5]\\d)?|24\\:?00)([\\.,]\\d+(?!:))?)?(\\17[0-5]\\d([\\.,]\\d+)?)?([zZ]|([\\+-])([01]\\d|2[0-3]):?([0-5]\\d)?)?)?)?$/;\n            var d = new Date(dateString);\n            var day, month, year, hours, minutes, seconds, nd;\n            if (!iosDateTest && !isNaN(d) && !this.isDateObj(d)) { //note instantiating ios formatted date using Date object resulted in error in IE\n                return \"\";\n            }\n            if (iosDateTest.test(dateString)) {\n                //IOS date, no need to convert again to date object, just parse it as is\n                //issue when passing it into Date object, the output date is inconsistent across from browsers\n                var dArray = $.trim($.trim(dateString).replace(/[\\.TZ:\\-]/gi, \" \")).split(\" \");\n                year = dArray[0];\n                month = dArray[1];\n                day = dArray[2];\n                hours = dArray[3] || \"0\";\n                minutes = dArray[4] || \"0\";\n                seconds = dArray[5] || \"0\";\n            } else {\n                day = d.getDate();\n                month = d.getMonth() + 1;\n                year = d.getFullYear();\n                hours = d.getHours();\n                minutes = d.getMinutes();\n                seconds = d.getSeconds();\n                nd = \"\";\n            }\n            var pad = function(n) {n = parseInt(n); return (n < 10) ? \"0\" + n : n;};\n            day = pad(day);\n            month = pad(month);\n            hours = pad(hours);\n            minutes = pad(minutes);\n            seconds = pad(seconds);\n\n            switch (format) {\n            case \"mm/dd/yyyy\":\n                nd = month + \"/\" + day + \"/\" + year;\n                break;\n            case \"mm-dd-yyyy\":\n                nd = month + \"-\" + day + \"-\" + year;\n                break;\n            case \"mm-dd-yyyy hh:mm:ss\":\n                nd = month + \"-\" + day + \"-\" + year + \" \" + hours + \":\" + minutes + \":\" + seconds;\n                break;\n            case \"dd/mm/yyyy\":\n                nd = day + \"/\" + month + \"/\" + year;\n                break;\n            case \"dd/mm/yyyy hh:mm:ss\":\n                nd = day + \"/\" + month + \"/\" + year + \" \" + hours + \":\" + minutes + \":\" + seconds;\n                break;\n            case \"dd-mm-yyyy\":\n                nd = day + \"-\" + month + \"-\" + year;\n                break;\n            case \"dd-mm-yyyy hh:mm:ss\":\n                nd = day + \"-\" + month + \"-\" + year + \" \" + hours + \":\" + minutes + \":\" + seconds;\n                break;\n            case \"iso-short\":\n            case \"yyyy-mm-dd\":\n                nd = year + \"-\" + month + \"-\" + day;\n                break;\n            case \"iso\":\n            case \"yyyy-mm-dd hh:mm:ss\":\n                nd = year + \"-\" + month + \"-\" + day + \" \" + hours + \":\" + minutes + \":\" + seconds;\n                break;\n            case \"system\":\n                nd = year + \"-\" + month + \"-\" + day + \"T\" + hours + \":\" + minutes + \":\" + seconds + \"Z\";\n                break;\n            case \"d M y hh:mm:ss\":\n                nd = this.displayDateString(month, day, year);\n                nd = nd + \" \" + hours + \":\" + minutes + \":\" + seconds;\n                break;\n            case \"d M y\":\n                nd = this.displayDateString(month, day, year);\n                break;\n            default:\n                nd = this.displayDateString(month, day, year);\n                break;\n            }\n            return nd;\n        } else {\n            return \"\";\n        }\n    },\n    \"convertToLocalTime\": function(dateString) {\n        var convertedDate = \"\";\n        if (dateString) { //assuming dateString is UTC date/time\n            var d = new Date(dateString);\n            var newDate = new Date(d.getTime() + d.getTimezoneOffset() * 60 * 1000);\n            var offset = d.getTimezoneOffset() / 60;\n            var hours = d.getHours();\n            newDate.setHours(hours - offset);\n            var options = {year: \"numeric\", day: \"numeric\", month: \"short\", hour: \"numeric\", minute: \"numeric\", second: \"numeric\", hour12: false};\n            convertedDate = newDate.toLocaleString(options);\n        }\n        return convertedDate;\n    },\n    getDateWithTimeZone: function(dObj) {\n        /*\n         * param is a date object - calculating UTC date using Date object's timezoneOffset method\n         * the method return offset in minutes, so need to convert it to miliseconds - adding the resulting offset will be the UTC date/time\n         */\n        var utcDate = new Date(dObj.getTime() + (dObj.getTimezoneOffset()) * 60 * 1000);\n        return this.formatDateString(utcDate, \"yyyy-mm-dd hh:mm:ss\");  //I believe this is a valid python date format, will save it as GMT date/time NOTE, conversion already occurred, so there will be no need for backend to convert it again\n    },\n    getTodayDateObj: function() { //return object containing today's date/time information\n        var today = new Date();\n        var td = today.getDate(), tm = today.getMonth() + 1, ty = today.getFullYear();\n        var th = today.getHours(), tmi = today.getMinutes(), ts = today.getSeconds();\n        var gmtToday = this.getDateWithTimeZone(this.getDateObj(ty, tm, td, th, tmi, ts));\n        var pad = function(n) {n = parseInt(n); return (n < 10) ? \"0\" + n : n;};\n        return {\n            date: today,\n            day: td,\n            month: tm,\n            year: ty,\n            hour: th,\n            minute: tmi,\n            second: ts,\n            displayDay: pad(td),\n            displayMonth: pad(tm),\n            displayYear: pad(ty),\n            displayHour: pad(th),\n            displayMinute: pad(tmi),\n            displaySecond: pad(ts),\n            gmtDate: gmtToday\n        };\n    },\n    dateValidator: function(day, month, year, restrictToPresent) { //parameters: day, month and year values in numeric, boolean value for restrictToPresent, true if the date needs to be before today, false is the default\n        var errorMessage = \"\";\n        if (day && month && year) {\n            var iy = parseInt(year), im = parseInt(month), iid = parseInt(day), date = new Date(iy, im - 1, iid);\n            if (date.getFullYear() === iy && (date.getMonth() + 1) === im && date.getDate() === iid) { // Check to see if this is a real date\n                if (iy < 1900) {\n                    errorMessage = i18next.t(\"Year must be after 1900\");\n                }\n                if (restrictToPresent) { // Only allow if date is before today\n                    var today = new Date();\n                    if (date.setHours(0, 0, 0, 0) > today.setHours(0, 0, 0, 0)) {\n                        errorMessage = i18next.t(\"The date must not be in the future.\");\n                    }\n                }\n            } else {\n                errorMessage = i18next.t(\"Invalid Date. Please enter a valid date.\");\n            }\n        } else {\n            errorMessage = i18next.t(\"Missing value.\");\n        }\n        return errorMessage;\n    }\n};\nexport default tnthDates;\nexport var validateDateInputFields = tnthDates.validateDateInputFields; /* generic validation function for global use */\n\n","export default {\n    \"biopsy\": {\n        code: \"111\",\n        display: \"biopsy\"\n    },\n    \"pca_diag\": {\n        code: \"121\",\n        display: \"PCa diagnosis\"\n    },\n    \"pca_localized\": {\n        code: \"141\",\n        display: \"PCa localized diagnosis\"\n    }\n};\n\n","import Utility from \"./Utility.js\";\nimport tnthDates from \"./TnthDate.js\";\nimport SYSTEM_IDENTIFIER_ENUM from \"./SYSTEM_IDENTIFIER_ENUM.js\";\nimport CLINICAL_CODE_ENUM from \"./CLINICAL_CODE_ENUM.js\";\nexport default { /*global $ */\n    \"beforeSend\": function() {\n        $.ajaxSetup({\n            beforeSend: function(xhr, settings) {\n                if (!/^(GET|HEAD|OPTIONS|TRACE)$/i.test(settings.type) && !this.crossDomain) {\n                    xhr.setRequestHeader(\"X-CSRFToken\", $(\"#__CRSF_TOKEN\").val());\n                }\n            }\n        });\n    },\n    \"sendRequest\": function(url, method, userId, params, callback) {\n        if (!url) { return false; }\n        var defaultParams = {type: method ? method : \"GET\", url: url, attempts: 0, max_attempts: 3, contentType: \"application/json; charset=utf-8\", dataType: \"json\", sync: false, timeout: 5000, data: null, useWorker: false, async: true};\n        params = params || defaultParams;\n        params = $.extend({}, defaultParams, params);\n        params.async = params.sync ? false: params.async;\n        var self = this;\n        var fieldHelper = this.FieldLoaderHelper, targetField = params.targetField || null;\n        callback = callback || function() {};\n        params.attempts++;\n        fieldHelper.showLoader(targetField);\n        if (params.useWorker && window.Worker && !Utility.isTouchDevice()) { /*global isTouchDevice()*/\n            Utility.initWorker(url, params, function(result) { /*global initWorker*/\n                var data;\n                try {\n                    data = JSON.parse(result);\n                } catch(e) {\n                    callback({error: \"Error occurred parsing data for \" + url});\n                    return false;\n                }\n                if (!data) {\n                    callback({\"error\": true, \"data\": \"no data returned\"});\n                    fieldHelper.showError(targetField);\n                } else if (data.error) {\n                    callback({\"error\": true, \"data\": data});\n                    self.sendError(data, url, userId, params);\n                    fieldHelper.showError(targetField);\n                } else {\n                    callback(data);\n                    fieldHelper.showUpdate(targetField);\n                }\n            });\n            return true;\n        }\n        if (!params.cache) {\n            params.headers = {\n                \"cache-control\": \"no-cache\",\n                \"expires\": \"-1\",\n                \"pragma\": \"no-cache\"\n            };\n        }\n        $.ajax(params).done(function(data) {\n            params.attempts = 0;\n            if (data) {\n                fieldHelper.showUpdate(targetField);\n                callback(data);\n            } else {\n                fieldHelper.showError(targetField);\n                callback({\"error\": true, \"data\": \"no data returned\"});\n            }\n        }).fail(function(xhr) {\n            if (params.attempts < params.max_attempts) {\n                (function(self, url, method, userId, params, callback) {\n                    setTimeout(function() {\n                        self.sendRequest(url, method, userId, params, callback);\n                    }, 3000); //retry after 3 seconds\n                })(self, url, method, userId, params, callback);\n            } else {\n                params.attempts = 0;\n                fieldHelper.showError(targetField);\n                callback({\"error\": true, \"data\": xhr});\n                self.sendError(xhr, url, userId, params);\n            }\n        });\n    },\n    \"sendError\": function(xhr, url, userId, params) {\n        if (!xhr) { return false; }\n        var errorMessage = \"[Error occurred processing request]  status - \" + (parseInt(xhr.status) === 0 ? \"request timed out/network error\" : xhr.status) + \", response text - \" + (xhr.responseText ? xhr.responseText : \"no response text returned from server\");\n        if (params) {\n            try {\n                errorMessage += \" [data sent]: \" + JSON.stringify(params); //error can happen if for some reason the params are malformed\n            } catch(e) {\n                errorMessage += \" Error occurred transforming sent data: \" + e.message;\n            }\n        }\n        this.reportError(userId ? userId : \"Not available\", url, errorMessage, true);\n    },\n    \"reportError\": function(userId, page_url, message, sync) {\n        //params need to contain the following: subject_id: User on which action is being attempted message: Details of the error event page_url: The page requested resulting in the error\n        var params = {};\n        params.subject_id = userId ? userId : 0;\n        params.page_url = page_url ? page_url : window.location.href;\n        params.message = \"Error generated in JS - \" + (message ? message.replace(/[\"']/g, \"\") : \"no detail available\"); //don't think we want to translate message sent back to the server here\n        if (window.console) {\n            console.log(\"Errors occurred.....\"); /*eslint no-console: off */\n            console.log(params); /*global console*/\n        }\n        $.ajax({\n            type: \"GET\",\n            url: \"/report-error\",\n            contentType: \"application/json; charset=utf-8\",\n            cache: false,\n            async: (sync ? false : true),\n            data: params\n        }).done(function() {}).fail(function() {});\n    },\n    \"FieldLoaderHelper\": {\n        delayDuration: 300,\n        showLoader: function(targetField) {\n            if (!targetField || targetField.length === 0) { return false; }\n            var el = $(\"#\" + (targetField.attr(\"data-save-container-id\") || targetField.attr(\"id\")) + \"_load\");\n            el.css(\"opacity\", 1);\n            el.addClass(\"loading\");\n        },\n        showUpdate: function(targetField) {\n            var __timeout = this.delayDuration;\n            if (!targetField || targetField.length === 0) { return false; }\n            setTimeout(function() {\n                (function(targetField) {\n                    var containerId = targetField.attr(\"data-save-container-id\") || targetField.attr(\"id\");\n                    var errorField = $(\"#\" + containerId + \"_error\");\n                    var successField = $(\"#\" + containerId + \"_success\");\n                    var loadingField = $(\"#\" + containerId + \"_load\");\n                    loadingField.removeClass(\"loading\");\n                    errorField.text(\"\").css(\"opacity\", 0);\n                    successField.text(i18next.t(\"success\"));\n                    loadingField.animate({\"opacity\": 0}, __timeout, function() {\n                        successField.animate({\"opacity\": 1}, __timeout, function() {\n                            setTimeout(function() {\n                                successField.animate({\"opacity\": 0}, __timeout * 2);\n                            }, __timeout * 2);\n                        });\n                    });\n                })(targetField);\n            }, __timeout);\n        },\n        showError: function(targetField) {\n            targetField = targetField || $(targetField);\n            var __timeout = this.delayDuration;\n            if (!targetField || targetField.length === 0) { return false; }\n            setTimeout(function() {\n                (function(targetField) {\n                    var containerId = targetField.attr(\"data-save-container-id\") || targetField.attr(\"id\");\n                    var errorField = $(\"#\" + containerId + \"_error\");\n                    var successField = $(\"#\" + containerId + \"_success\");\n                    var loadingField = $(\"#\" + containerId + \"_load\");\n                    loadingField.removeClass(\"loading\");\n                    errorField.text(i18next.t(\"Unable to update. System/Server Error.\"));\n                    successField.text(\"\").css(\"opacity\", 0);\n                    loadingField.animate({\"opacity\": 0}, __timeout, function() {\n                        errorField.animate({\"opacity\": 1}, __timeout, function() {\n                            setTimeout(function() {\n                                errorField.animate({\"opacity\": 0}, __timeout * 2);\n                            }, __timeout * 2);\n                        });\n                    });\n                })(targetField);\n            }, __timeout);\n        }\n    },\n    \"getCurrentUser\": function(callback, params) {\n        callback = callback||function() {};\n        if (sessionStorage.currentUser) {\n            callback(JSON.parse(sessionStorage.currentUser));\n        } else {\n            this.sendRequest(\"/api/me\", \"GET\", \"\", params, function(data) {\n                if (data && data.id) { //make sure the necessary data is there before setting session\n                    sessionStorage.setItem(\"currentUser\", JSON.stringify(data));\n                }\n                callback(data);\n            });\n        }\n    },\n    \"getStillNeededCoreData\": function(userId, sync, callback, entry_method) {\n        callback = callback || function() {};\n        if (!userId) {\n            callback({\"error\": i18next.t(\"User Id is required\")});\n            return false;\n        }\n        var __url = \"/api/coredata/user/\" + userId + \"/still_needed\" + (entry_method ? \"?entry_method=\" + (entry_method).replace(/\\_/g, \" \") : \"\");\n        this.sendRequest(__url, \"GET\", userId, {sync: sync,cache: true}, function(data) {\n            if (!data) {\n                callback({\"error\": i18next.t(\"no data returned\")});\n                return false;\n            }\n            if (data.error) {\n                callback({\"error\": i18next.t(\"unable to get needed core data\")});\n                return false;\n            }\n            callback(data);\n        });\n    },\n    \"getRequiredCoreData\": function(userId, sync, callback) {\n        callback = callback || function() {};\n        if (!userId) {\n            callback({\"error\": i18next.t(\"User Id is required\")});\n            return false;\n        }\n        this.sendRequest(\"/api/coredata/user/\" + userId + \"/required\", \"GET\", userId, {sync: sync,cache: true}, function(data) {\n            if (data) {\n                if (!data.error) {\n                    if (data.required) {\n                        callback(data.required);\n                    } else {\n                        callback({\"error\": i18next.t(\"no data returned\")});\n                    }\n                } else {\n                    callback({\"error\": i18next.t(\"unable to get required core data\")});\n                }\n            } else {\n                callback({\"error\": i18next.t(\"no data returned\")});\n            }\n        });\n    },\n    \"getOptionalCoreData\": function(userId, params, callback) {\n        callback = callback || function() {};\n        if (!userId) {\n            callback({\"error\": i18next.t(\"User Id is required\")});\n            return false;\n        }\n        var __url = \"/api/coredata/user/\" + userId + \"/optional\", sessionStorageKey = \"optionalCoreData_\" + userId;\n        if (sessionStorage.getItem(sessionStorageKey)) {\n            callback(JSON.parse(sessionStorage.getItem(sessionStorageKey)));\n        } else {\n            this.sendRequest(__url, \"GET\", userId, params, function(data) {\n                if (data) {\n                    callback(data);\n                } else {\n                    callback({\"error\": i18next.t(\"no data found\")});\n                }\n            });\n        }\n    },\n    \"getPortalFooter\": function(userId, sync, containerId, callback) {\n        callback = callback || function() {};\n        if (!userId) {\n            callback(\"<div class='error-message'>\" + i18next.t(\"User Id is required\") + \"</div>\");\n            return false;\n        }\n        this.sendRequest(\"/api/portal-footer-html/\", \"GET\", userId, {sync: sync,cache: true,\"dataType\": \"html\"}, function(data) {\n            if (data) {\n                if (!data.error) {\n                    if (containerId) {\n                        $(\"#\" + containerId).html(data);\n                    }\n                    callback(data);\n                } else {\n                    callback(\"<div class='error-message'>\" + i18next.t(\"Unable to retrieve portal footer html\") + \"</div>\");\n                }\n            } else {\n                callback(\"<div class='error-message'>\" + i18next.t(\"No data found\") + \"</div>\");\n            }\n        });\n    },\n    \"getOrgs\": function(userId, params, callback) {\n        callback = callback || function() {};\n        this.sendRequest(\"/api/organization\", \"GET\", userId, params, function(data) {\n            if (sessionStorage.demoOrgsData) {\n                callback(JSON.parse(sessionStorage.demoOrgsData));\n                return true;\n            }\n            if (!data.error) {\n                $(\".get-orgs-error\").html(\"\");\n                sessionStorage.setItem(\"demoOrgsData\", JSON.stringify(data));\n                callback(data);\n            } else {\n                var errorMessage = i18next.t(\"Server error occurred retrieving organization/clinic information.\");\n                $(\".get-orgs-error\").html(errorMessage);\n                callback({\"error\": errorMessage});\n            }\n        });\n    },\n    \"getConsent\": function(userId, params, callback) {\n        callback = callback || function() {};\n        if (!userId) {\n            callback({error: i18next.t(\"User id is required.\")});\n            return false;\n        }\n        this.sendRequest(\"/api/user/\" + userId + \"/consent\", \"GET\", userId, params, function(data) {\n            if (data) {\n                if (!data.error) {\n                    $(\".get-consent-error\").html(\"\");\n                    callback(data);\n                    return true;\n                } else {\n                    var errorMessage = i18next.t(\"Server error occurred retrieving consent information.\");\n                    callback({\"error\": errorMessage});\n                    $(\".get-consent-error\").html(errorMessage);\n                    return false;\n                }\n            }\n        });\n    },\n    \"setConsent\": function(userId, params, status, sync, callback) {\n        callback = callback || function() {};\n        if (!userId && !params) {\n            callback({\"error\": i18next.t(\"User id and parameters are required\")});\n            return false;\n        }\n        var consented = this.hasConsent(userId, params.org, status);\n        var __url = \"/api/user/\" + userId + \"/consent\";\n        if (consented && !params.testPatient) {\n            callback({\"error\": false});\n            return;\n        }\n        var data = {};\n        data.user_id = userId;\n        data.organization_id = params.org;\n        data.agreement_url = params.agreementUrl;\n        data.staff_editable = (String(params.staff_editable) !== \"null\"  && String(params.staff_editable) !== \"undefined\" ? params.staff_editable : false);\n        data.include_in_reports = (String(params.include_in_reports) !== \"null\" && String(params.include_in_reports) !== \"undefined\" ? params.include_in_reports : false);\n        data.send_reminders = (String(params.send_reminders) !== \"null\" &&  String(params.send_reminders) !== \"undefined\"? params.send_reminders : false);\n        if (params.acceptance_date) {\n            data.acceptance_date = params.acceptance_date;\n        }\n        this.sendRequest(__url, \"POST\", userId, {sync: sync, data: JSON.stringify(data)}, function(data) {\n            if (!data.error) {\n                $(\".set-consent-error\").html(\"\");\n                callback(data);\n            } else {\n                var errorMessage = i18next.t(\"Server error occurred setting consent status.\");\n                callback({\"error\": errorMessage});\n                $(\".set-consent-error\").html(errorMessage);\n            }\n        });\n    },\n    deleteConsent: function(userId, params) {\n        if (!userId || !params) {\n            return false;\n        }\n        var consented = this.getAllValidConsent(userId, params.org);\n        if (!consented) {\n            return false;\n        }\n        var arrExcludedOrgIds = params.exclude ? params.exclude.split(\",\"): [];\n        var arrConsents = $.grep(consented, function(orgId) {\n            var inArray = $.grep(arrExcludedOrgIds, function(eOrg) {\n                return String(eOrg) === String(orgId);\n            });\n           return !(inArray.length); //filter out org Id(s) that are in the array of org Ids to be excluded;\n        });\n        var self = this;\n        arrConsents.forEach(function(orgId) { //delete all consents for the org\n            self.sendRequest(\"/api/user/\" + userId + \"/consent\", \"DELETE\", userId, {data: JSON.stringify({\"organization_id\": parseInt(orgId)})}, function(data) {\n                if (!data) {\n                    return false;\n                }\n                if (!data.error) {\n                    $(\".delete-consent-error\").html(\"\");\n                } else {\n                    $(\".delete-consent-error\").html(i18next.t(\"Server error occurred removing consent.\"));\n                }\n            });\n        });\n    },\n    withdrawConsent: function(userId, orgId, params, callback) {\n        callback = callback || function() {};\n        if (!userId || !orgId) {\n            callback({\"error\": i18next.t(\"User id and organization id are required.\")});\n            return false;\n        }\n        params = params || {};\n        var self = this, arrConsent = [];\n        this.sendRequest(\"/api/user/\" + userId + \"/consent\", \"GET\", userId, params, function(data) {\n            if (data && data.consent_agreements && data.consent_agreements.length > 0) {\n                arrConsent = $.grep(data.consent_agreements, function(item) {\n                    var expired = item.expires ? tnthDates.getDateDiff(String(item.expires)) : 0; /*global tnthDates */\n                    return (String(orgId) === String(item.organization_id)) && !item.deleted && !(expired > 0) && String(item.status) === \"suspended\";\n                });\n            }\n            if (arrConsent.length > 0) { //don't send request if suspended consent already existed\n                callback({\"data\": \"success\"});\n                return false;\n            }\n            self.sendRequest(\"/api/user/\" + userId + \"/consent/withdraw\",\n            \"POST\",\n            userId, {sync: params.sync,data: JSON.stringify({organization_id: orgId})},\n            function(data) {\n                if (data.error) {\n                    callback({\"error\": i18next.t(\"Error occurred setting suspended consent status.\")});\n                    return false;\n                }\n                callback(data);\n            });\n        });\n    },\n    getAllValidConsent: function(userId, orgId) {\n        if (!userId || !orgId) { return false; }\n        var consentedOrgIds = [];\n        this.sendRequest(\"/api/user/\" + userId + \"/consent\", \"GET\", userId, {sync: true}, function(data) {\n            if (!data || data.error || !data.consent_agreements || data.consent_agreements.length === 0) {\n                return consentedOrgIds;\n            }\n            consentedOrgIds = $.grep(data.consent_agreements, function(item) {\n                var expired = item.expires ? tnthDates.getDateDiff(String(item.expires)) : 0;\n                return !item.deleted && !(expired > 0) && (String(orgId).toLowerCase() === \"all\" || String(orgId) === String(item.organization_id));\n            });\n            consentedOrgIds = (consentedOrgIds).map(function(item) {\n                return item.organization_id;\n            });\n            return consentedOrgIds;\n        });\n        return consentedOrgIds;\n    },\n    hasConsent: function(userId, orgId, filterStatus) {  /****** NOTE - this will return the latest updated consent entry *******/\n        if (!userId || !orgId || String(filterStatus) === \"default\") { return false; }\n        var consentedOrgIds = [];\n        var __url = \"/api/user/\" + userId + \"/consent\", self = this;\n        self.sendRequest(__url, \"GET\", userId, {sync: true}, function(data) {\n            if (!data || data.error || (data.consent_agreements && data.consent_agreements.length === 0)) {\n                return false;\n            }\n            consentedOrgIds = $.grep(data.consent_agreements, function(item) {\n                var expired = item.expires ? tnthDates.getDateDiff(String(item.expires)) : 0; /*global tnthDates */\n                return (String(orgId) === String(item.organization_id)) && !item.deleted && !(expired > 0) && item.staff_editable && item.send_reminders && item.include_in_reports;\n            });\n        });\n        return consentedOrgIds.length;\n    },\n    \"getDemo\": function(userId, params, callback) {\n        callback = callback || function() {};\n        if (!userId) {\n            callback({\"error\": i18next.t(\"User id is required.\")});\n            return false;\n        }\n        params = params || {};\n        var demoDataKey = \"demoData_\"+userId;\n        if (sessionStorage.getItem(demoDataKey)) {\n            callback(JSON.parse(sessionStorage.getItem(demoDataKey)));\n            return;\n        }\n        this.sendRequest(\"/api/demographics/\" + userId, \"GET\", userId, params, function(data) {\n            var errorMessage = \"\";\n            if (data.error) {\n                errorMessage = i18next.t(\"Server error occurred retrieving demographics information.\");\n                $(\".get-demo-error\").html(errorMessage);\n                callback({\"error\": errorMessage});\n                return false;\n            }\n            $(\".get-demo-error\").html(errorMessage);\n            sessionStorage.setItem(demoDataKey, JSON.stringify(data));\n            callback(data);\n        });\n    },\n    \"clearDemoSessionData\": function(userId) {\n        sessionStorage.removeItem(\"demoData_\"+userId);\n    },\n    \"putDemo\": function(userId, toSend, targetField, sync, callback) {\n        callback = callback || function() {};\n        if (!userId) {\n            callback({\"error\": i18next.t(\"User Id is required\")});\n            return false;\n        }\n        this.clearDemoSessionData(userId);\n        this.sendRequest(\"/api/demographics/\" + userId, \"PUT\", userId, {sync: sync, data: JSON.stringify(toSend),targetField: targetField}, function(data) {\n            if (!data.error) {\n                $(\".put-demo-error\").html(\"\");\n            } else {\n                $(\".put-demo-error\").html(i18next.t(\"Server error occurred setting demographics information.\"));\n            }\n            callback(data);\n        });\n    },\n    \"getLocale\": function(userId) {\n        this.sendRequest(\"/api/demographics/\" + userId, \"GET\", userId, null, function(data) {\n            if (data) {\n                if (!data.error) {\n                    if (data.communication) {\n                        $(\"#profileLocaleTimezoneContainer .get-locale-error\").html(\"\");\n                    }\n                } else {\n                    $(\"#profileLocaleTimezoneContainer .get-locale-error\").html(i18next.t(\"Server error occurred retrieving locale information.\"));\n                }\n            }\n        });\n    },\n    \"hasTreatment\": function(data) {\n        if (!data || !data.entry || data.entry.length === 0) {\n            return false;\n        }\n        var sortedArray = data.entry.sort(function(a, b) { // sort from newest to oldest based on lsat updated date\n            return new Date(b.resource.meta.lastUpdated) - new Date(a.resource.meta.lastUpdated);\n        });\n        var found = false;\n        sortedArray.forEach(function(item) {\n            if (found) { return true; }\n            var resourceItemCode = String(item.resource.code.coding[0].code);\n            var system = String(item.resource.code.coding[0].system);\n            var procId = item.resource.id;\n            if ((resourceItemCode === SYSTEM_IDENTIFIER_ENUM.CANCER_TREATMENT_CODE && (system === SYSTEM_IDENTIFIER_ENUM.SNOMED_SYS_URL)) || (resourceItemCode === SYSTEM_IDENTIFIER_ENUM.NONE_TREATMENT_CODE && (system === SYSTEM_IDENTIFIER_ENUM.CLINICAL_SYS_URL))) {\n                found = {\"code\": resourceItemCode,\"id\": procId};\n            }\n        });\n        return found;\n    },\n    \"getTreatment\": function(userId, params, callback) {\n        callback = callback || function() {};\n        if (!userId) {\n            callback({error: i18next.t(\"User id is required\")});\n            return false;\n        }\n        this.sendRequest(\"/api/patient/\" + userId + \"/procedure\", \"GET\", userId, params, function(data) {\n            if (data.error) {\n                $(\"#userProcedures\").html(\"<span class='error-message'>\" + i18next.t(\"Error retrieving data from server\") + \"</span>\");\n            }\n            callback(data);\n        });\n    },\n    \"postTreatment\": function(userId, started, treatmentDate, targetField) {\n        if (!userId) { return false;}\n        this.deleteTreatment(userId, targetField);\n        var code = SYSTEM_IDENTIFIER_ENUM.NONE_TREATMENT_CODE, display = \"None\", system = SYSTEM_IDENTIFIER_ENUM.CLINICAL_SYS_URL;\n        if (started) {\n            code = SYSTEM_IDENTIFIER_ENUM.CANCER_TREATMENT_CODE;\n            display = \"Procedure on prostate\";\n            system = SYSTEM_IDENTIFIER_ENUM.SNOMED_SYS_URL;\n        }\n        if (!treatmentDate) {\n            var date = new Date();\n            treatmentDate = date.getFullYear() + \"-\" + (date.getMonth() + 1) + \"-\" + date.getDate();  //in yyyy-mm-dd format\n        }\n        var procID = [{\"code\": code,\"display\": display,\"system\": system}];\n        var procArray = {};\n        procArray.resourceType = \"Procedure\";\n        procArray.subject = {\"reference\": \"Patient/\" + userId};\n        procArray.code = {\"coding\": procID};\n        procArray.performedDateTime = treatmentDate ? treatmentDate : \"\";\n        this.postProc(userId, procArray, targetField);\n    },\n    deleteTreatment: function(userId, targetField) {\n        var self = this;\n        this.sendRequest(\"/api/patient/\" + userId + \"/procedure\", \"GET\", userId, {sync: true}, function(data) {\n            if (!data || data.error) { return false; }\n            var treatmentData = self.hasTreatment(data);\n            if (!treatmentData) { return false; }\n            if (String(treatmentData.code) === String(SYSTEM_IDENTIFIER_ENUM.CANCER_TREATMENT_CODE)){\n                self.deleteProc(treatmentData.id, targetField, true);\n                return true;\n            }\n            self.deleteProc(treatmentData.id, targetField, true);\n        });\n    },\n    \"getProc\": function(userId, newEntry, callback) {\n        callback = callback || function() {};\n        this.sendRequest(\"/api/patient/\" + userId + \"/procedure\", \"GET\", userId, null, function(data) {\n            callback(data);\n        });\n    },\n    \"postProc\": function(userId, toSend, targetField, callback) {\n        callback = callback || function() {};\n        this.sendRequest(\"/api/procedure\", \"POST\", userId, {data: JSON.stringify(toSend),targetField: targetField}, function(data) {\n            if (!data) {\n                callback({\"error\": i18next.t(\"no data returned\")});\n                return false;\n            }\n            if (data.error) {\n                var errorMessage = i18next.t(\"Server error occurred saving procedure/treatment information.\");\n                $(\"#userProcuedures .get-procs-error\").html(errorMessage);\n                callback({error: errorMessage});\n                return false;\n            }\n            $(\".get-procs-error\").html(\"\");\n            callback(data);\n        });\n    },\n    \"deleteProc\": function(procedureId, targetField, sync) {\n        this.sendRequest(\"/api/procedure/\" + procedureId, \"DELETE\", null, {sync: sync,targetField: targetField}, function(data) {\n            if (!data.error) {\n                $(\".del-procs-error\").html(\"\");\n            } else {\n                $(\".del-procs-error\").html(i18next.t(\"Server error occurred removing procedure/treatment information.\"));\n            }\n        });\n    },\n    \"getRoleList\": function(params, callback) {\n        this.sendRequest(\"/api/roles\", \"GET\", null, params, function(data) {\n            callback = callback || function() {};\n            if (!data.error) {\n                callback(data);\n            } else {\n                var errorMessage = i18next.t(\"Server error occurred retrieving roles information.\");\n                $(\".get-roles-error\").html(errorMessage);\n                callback({\"error\": errorMessage});\n            }\n        });\n    },\n    \"getRoles\": function(userId, callback, params) {\n        callback = callback || function() {};\n        var sessionStorageKey = \"userRole_\" + userId;\n        if (sessionStorage.getItem(sessionStorageKey)) {\n            var data = JSON.parse(sessionStorage.getItem(sessionStorageKey));\n            callback(data);\n        } else {\n            this.sendRequest(\"/api/user/\" + userId + \"/roles\", \"GET\", userId, params, function(data) {\n                if (data) {\n                    if (!data.error) {\n                        $(\".get-roles-error\").html(\"\");\n                        sessionStorage.setItem(sessionStorageKey, JSON.stringify(data));\n                        callback(data);\n                    } else {\n                        var errorMessage = i18next.t(\"Server error occurred retrieving user role information.\");\n                        $(\".get-roles-error\").html(errorMessage);\n                        callback({\"error\": errorMessage});\n                    }\n                }\n            });\n        }\n    },\n    \"removeCachedRoles\": function(userId) {\n        sessionStorage.removeItem(\"userRole_\"+userId);\n    },\n    \"putRoles\": function(userId, toSend, targetField, callback) {\n        callback = callback || function() {};\n        if (!userId) {\n            callback({error: i18next.t(\"User Id is required.\")});\n            return false;\n        }\n        this.removeCachedRoles(userId);\n        this.sendRequest(\"/api/user/\" + userId + \"/roles\", \"PUT\", userId, {data: JSON.stringify(toSend),targetField: targetField}, function(data) {\n            if (!data || data.error) {\n                var errorMessage = i18next.t(\"Server error occurred setting user role information.\");\n                $(\".put-roles-error\").html(errorMessage);\n                callback({error: errorMessage});\n                return;\n            }\n            $(\".put-roles-error\").html(\"\");\n            sessionStorage.setItem(\"userRole_\" + userId, \"\");\n            callback(data);\n        });\n    },\n    \"deleteRoles\": function(userId, toSend) {\n        if (!userId) {\n            return false;\n        }\n        this.removeCachedRoles(userId);\n        this.sendRequest(\"/api/user/\" + userId, \"GET\", userId, {data: JSON.stringify(toSend)}, function(data) {\n            if (data) {\n                if (!data.error) {\n                    $(\".delete-roles-error\").html(\"\");\n                } else {\n                    $(\".delete-roles-error\").html(i18next.t(\"Server error occurred deleting user role.\"));\n                }\n            }\n        });\n    },\n    \"getClinical\": function(userId, params, callback) {\n        callback = callback || function() {};\n        this.sendRequest(\"/api/patient/\" + userId + \"/clinical\", \"GET\", userId, params, function(data) {\n            if (data) {\n                if (!data.error) {\n                    $(\".get-clinical-error\").html(\"\");\n                    callback(data);\n                } else {\n                    var errorMessage = i18next.t(\"Server error occurred retrieving clinical data.\");\n                    $(\".get-clinical-error\").html(errorMessage);\n                    callback({\"error\": errorMessage});\n                }\n            }\n        });\n    },\n    \"getObservationId\": function(userId, code) {\n        if (!userId) { return false; }\n        var obId = \"\",_code = \"\";\n        this.sendRequest(\"/api/patient/\" + userId + \"/clinical\", \"GET\", userId, {sync: true}, function(data) {\n            if (data) {\n                if (!data.error) {\n                    if (data.entry) {\n                        (data.entry).forEach(function(item) {\n                            if (!obId) {\n                                _code = item.content.code.coding[0].code;\n                                if (String(_code) === String(code)) {\n                                    obId = item.content.id;\n                                }\n                            }\n                        });\n                    }\n                }\n            }\n        });\n        return obId;\n    },\n    \"postClinical\": function(userId, toCall, toSend, status, targetField, params, callback) {\n        if (!userId) { return false; }\n        params = params || {};\n        var code = \"\", display = \"\";\n        if (CLINICAL_CODE_ENUM.hasOwnProperty(String(toCall).toLowerCase())) {\n            var match = CLINICAL_CODE_ENUM[toCall];\n            code = match.code;\n            display = match.display;\n        }\n        if (!code) {\n            return false;\n        }\n        var self = this;\n        var system = SYSTEM_IDENTIFIER_ENUM.CLINICAL_SYS_URL;\n        var method = \"POST\";\n        var url = \"/api/patient/\" + userId + \"/clinical\";\n        var obsCode = [{\"code\": code,\"display\": display,\"system\": system}];\n        var obsArray = {};\n        obsArray.resourceType = \"Observation\";\n        obsArray.code = {\"coding\": obsCode};\n        obsArray.issued = params.issuedDate ? params.issuedDate : \"\";\n        obsArray.status = status ? status : \"\";\n        obsArray.valueQuantity = {\"units\": \"boolean\",\"value\": toSend};\n        if (params.performer) {\n            obsArray.performer = params.performer;\n        }\n        var obsId = self.getObservationId(userId, code);\n        if (obsId) {\n            method = \"PUT\";\n            url = url + \"/\" + obsId;\n        }\n        callback = callback || function() {};\n        this.sendRequest(url, method, userId, {data: JSON.stringify(obsArray),targetField: targetField}, function(data) {\n            if (!data || data.error) {\n                var errorMessage = i18next.t(\"Server error occurred updating clinical data.\");\n                $(\".post-clinical-error\").html(errorMessage).show();\n                callback({error: errorMessage});\n                return;\n            }\n            $(\".post-clinical-error\").html(\"\").hide();\n            callback(data);\n        });\n    },\n    \"getTermsUrl\": function(sync, callback) { /*global i18next */\n        callback = callback || function() {};\n        this.sendRequest(\"/api/tou\", \"GET\", null, {sync: sync}, function(data) {\n            if (data) {\n                if (!data.error) {\n                    $(\".get-tou-error\").html(\"\");\n                    if (data.url) {\n                        $(\"#termsURL\").attr(\"data-url\", data.url);\n                        $(\"#termsCheckbox_default .terms-url\").attr(\"href\", data.url);\n                        callback({\"url\": data.url});\n                    } else {\n                        callback({\"error\": i18next.t(\"no url returned\")});\n                    }\n                } else {\n                    $(\".get-tou-error\").html(i18next.t(\"Server error occurred retrieving tou url.\"));\n                    callback({\"error\": i18next.t(\"Server error\")});\n                }\n            }\n        });\n    },\n    \"getInstrumentsList\": function(sync, callback) { //return instruments list by organization(s)\n        callback = callback || function() {};\n        this.sendRequest(\"api/questionnaire_bank\", \"GET\", null, {\n            sync: sync\n        }, function(data) {\n            if (data) {\n                if (!data.error) {\n                    if (data.entry) {\n                        if ((data.entry).length === 0) {\n                            callback({\"error\": i18next.t(\"no data returned\")});\n                        } else {\n                            var qList = {};\n                            (data.entry).forEach(function(item) {\n                                if (item.organization) {\n                                    var orgID = (item.organization.reference).split(\"/\")[2];\n                                    if (!qList[orgID]) {\n                                        qList[orgID] = []; //don't assign orgID to object if it was already present\n                                    }\n                                    if (item.questionnaires) {\n                                        (item.questionnaires).forEach(function(q) {\n                                            /*\n                                             * add instrument name to instruments array for the org - will not add if it is already in the array\n                                             * NOTE: inArray returns -1 if the item is NOT in the array\n                                             */\n                                            if ($.inArray(q.questionnaire.display, qList[orgID]) === -1) {\n                                                qList[orgID].push(q.questionnaire.display);\n                                            }\n                                        });\n                                    }\n                                }\n                            });\n                            callback(qList);\n                        }\n                    } else {\n                        callback({\"error\": i18next.t(\"no data returned\")});\n                    }\n                } else {\n                    callback({\"error\": i18next.t(\"error retrieving instruments list\")});\n                }\n            }\n        });\n    },\n    \"getTerms\": function(userId, type, sync, callback, params) {\n        callback = callback || function() {};\n        params = params || {};\n        var url = \"/api/user/{userId}/tou{type}{all}\".replace(\"{userId}\", userId)\n            .replace(\"{type}\", type ? (\"/\" + type) : \"\")\n            .replace(\"{all}\", (params.hasOwnProperty(\"all\") ? \"?all=true\" : \"\"));\n        this.sendRequest(url, \"GET\", userId, {sync: sync}, function(data) {\n            if (data) {\n                if (!data.error) {\n                    $(\".get-tou-error\").html(\"\");\n                    callback(data);\n                } else {\n                    var errorMessage = i18next.t(\"Server error occurred retrieving tou data.\");\n                    $(\".get-tou-error\").html(errorMessage);\n                    callback({\"error\": errorMessage});\n                }\n            }\n        });\n    },\n    \"postTermsByUser\": function(userId, toSend, callback) {\n        callback = callback || function() {};\n        this.sendRequest(\"/api/user/\" + userId + \"/tou/accepted\", \"POST\", userId, {data: JSON.stringify(toSend)}, function(data) {\n            if (!data || data.error) {\n                $(\".post-tou-error\").html(i18next.t(\"Server error occurred saving terms of use information.\"));\n                callback(data);\n                return;\n            }\n            $(\".post-tou-error\").html(\"\");\n            callback(data);\n        });\n    },\n    \"postTerms\": function(toSend, targetField, callback) {\n        callback = callback || function() {};\n        this.sendRequest(\"/api/tou/accepted\", \"POST\", null, {data: JSON.stringify(toSend), targetField: targetField}, function(data) {\n            if (!data || data.error) {\n                var errorMessage = i18next.t(\"Server error occurred saving terms of use information.\");\n                $(\".post-tou-error\").html(errorMessage);\n                callback({error: errorMessage});\n                return;\n            }\n            $(\".post-tou-error\").html(\"\");\n            callback(data);\n        });\n    },\n    \"accessUrl\": function(userId, sync, callback) {\n        callback = callback || function() {};\n        if (!userId) { callback({\"error\": i18next.t(\"User id is required.\")}); return false; }\n        this.sendRequest(\"/api/user/\" + userId + \"/access_url\", \"GET\", userId, {sync: sync}, function(data) {\n            if (data) {\n                if (!data.error) {\n                    callback({url: data.access_url});\n                } else {\n                    callback({\"error\": i18next.t(\"Error occurred retrieving access url.\")});\n                }\n            } else {\n                callback({\"error\": i18next.t(\"no data returned\")});\n            }\n        });\n    },\n    \"invite\": function(userId, data, callback) {\n        callback = callback || function() {};\n        if (!data) { callback({\"error\": i18next.t(\"Invite data are required.\")}); return false; }\n        this.sendRequest(\"/invite\", \"POST\", userId, {\n            \"contentType\": \"application/x-www-form-urlencoded; charset=UTF-8\",\n            \"data\": data,\n            \"dataType\": \"html\"\n        }, function(data) {\n            if (data) {\n                callback(data);\n            } else {\n                callback({\"error\": i18next.t(\"no data returned\")});\n            }\n        });\n    },\n    \"passwordReset\": function(userId, callback) {\n        callback = callback || function() {};\n        if (!userId) { callback({\"error\": i18next.t(\"User id is required.\")}); return false; }\n        this.sendRequest(\"/api/user/\" + userId + \"/password_reset\", \"POST\", userId, {\"contentType\": \"application/x-www-form-urlencoded; charset=UTF-8\"}, function(data) {\n            if (data) {\n                if (!data.error) {\n                    callback(data);\n                } else {\n                    callback({\"error\": i18next.t(\"Error occurred sending password reset request.\")});\n                }\n            } else {\n                callback({\"error\": i18next.t(\"no data returned\")});\n            }\n        });\n    },\n    \"assessmentStatus\": function(userId, callback) {\n        callback = callback || function() {};\n        if (!userId) { callback({\"error\": i18next.t(\"User id is required.\")}); return false; }\n        this.sendRequest(\"/api/patient/\" + userId + \"/assessment-status\", \"GET\", userId, null, function(data) {\n            if (data) {\n                if (!data.error) {\n                    callback(data);\n                } else {\n                    callback({\"error\": i18next.t(\"Error occurred retrieving assessment status.\")});\n                }\n            } else {\n                callback({\"error\": i18next.t(\"no data returned\")});\n            }\n        });\n    },\n    \"updateAssessment\": function(userId, data, callback) {\n        callback = callback || function() {};\n        if (!userId) { callback({\"error\": i18next.t(\"User id is required.\")}); return false; }\n        if (!data) { callback({\"error\": i18next.t(\"Questionnaire response data is required.\")}); return false;}\n        this.sendRequest(\"/api/patient/\" + userId + \"/assessment\", \"PUT\", userId, {data: JSON.stringify(data)}, function(data) {\n            if (data) {\n                if (!data.error) {\n                    callback(data);\n                } else {\n                    callback({\"error\": i18next.t(\"Error occurred retrieving assessment list.\")});\n                }\n\n            } else {\n                callback({\"error\": i18next.t(\"no data returned\")});\n            }\n        });\n    },\n    \"assessmentList\": function(userId, params, callback) {\n        callback = callback || function() {};\n        if (!userId) {\n            callback({error: i18next.t(\"User id is required.\")});\n            return false;\n        }\n        this.sendRequest(\"/api/patient/\" + userId + \"/assessment\", \"GET\", userId, params, function(data) {\n            if (data) {\n                if (!data.error) {\n                    callback(data);\n                } else {\n                    callback({\"error\": i18next.t(\"Error occurred retrieving assessment list.\")});\n                }\n            } else {\n                callback({\"error\": i18next.t(\"no data returned\")});\n            }\n        });\n    },\n    \"assessmentReport\": function(userId, instrumentId, callback) {\n        callback = callback || function() {};\n        if (!userId || !instrumentId) {\n            callback({error: i18next.t(\"User id and instrument Id are required.\")});\n            return false;\n        }\n        this.sendRequest(\"/api/patient/\" + userId + \"/assessment/\" + instrumentId, \"GET\", userId, null, function(data) {\n            if (data) {\n                if (!data.error) {\n                    callback(data);\n                } else {\n                    callback({\"error\": i18next.t(\"Error occurred retrieving assessment report.\")});\n                }\n            } else {\n                callback({\"error\": i18next.t(\"no data returned\")});\n            }\n        });\n    },\n    \"getCurrentQB\": function(userId, completionDate, params, callback) {\n        callback = callback || function() {};\n        if (!userId) {\n            callback({error: i18next.t(\"User id is required.\")});\n            return false;\n        }\n        params = params || {};\n        this.sendRequest(\"/api/user/\" + userId + \"/questionnaire_bank\", \"GET\", userId, {data: {as_of_date: completionDate}, sync: params.sync ? true : false}, function(data) {\n            if (!data || data.error) {\n                callback({\"error\": i18next.t(\"Error occurred retrieving current questionnaire bank for user.\")});\n                return false;\n            }\n            callback(data);\n        });\n    },\n    \"patientReport\": function(userId, params, callback) {\n        callback = callback || function() {};\n        if (!userId) {\n            callback({error: i18next.t(\"User id is required.\")});\n            return false;\n        }\n        this.sendRequest(\"/api/user/\" + userId + \"/user_documents?document_type=PatientReport\", \"GET\", userId, params, function(data) {\n            if (data) {\n                if (!data.error) {\n                    callback(data);\n                } else {\n                    callback({\"error\": i18next.t(\"Error occurred retrieving patient report.\")});\n                }\n            } else {\n                callback({\"error\": i18next.t(\"no data returned\")});\n            }\n        });\n    },\n    \"setTablePreference\": function(userId, tableName, params, callback) {\n        callback = callback || function() {};\n        if (!userId || !tableName) {\n            callback({error: \"User Id and table name is required for setting preference.\"});\n            return false;\n        }\n        params = params || {};\n        this.sendRequest(\"/api/user/\" + userId + \"/table_preferences/\" + tableName, \"PUT\", userId, {\"data\": params.data,\"sync\": params.sync}, function(data) {\n            if (!data || data.error) {\n                callback({\"error\": i18next.t(\"Error occurred setting table preference.\")});\n                return false;\n            }\n            callback(data);\n        });\n    },\n    \"getTablePreference\": function(userId, tableName, params={}, callback=(function(){})) {\n        if (!userId || !tableName) {\n            callback({error: \"User Id and table name is required for setting preference.\"});\n            return false;\n        }\n        this.sendRequest(\"/api/user/\" + userId + \"/table_preferences/\" + tableName, \"GET\", userId, {\"sync\": params.sync}, function(data) {\n            if (data) {\n                if (!data.error) {\n                    callback(data);\n                } else {\n                    callback({\"error\": i18next.t(\"Error occurred setting table preference.\")});\n                }\n            } else {\n                callback({\"error\": i18next.t(\"no data returned\")});\n            }\n        });\n    },\n    \"emailLog\": function(userId, params, callback) {\n        callback = callback || function() {};\n        if (!userId) {\n            callback({error: i18next.t(\"User id is required.\")});\n            return false;\n        }\n        this.sendRequest(\"/api/user/\" + userId + \"/messages\", \"GET\", userId, params, function(data) {\n            if (data) {\n                if (!data.error) {\n                    callback(data);\n                } else {\n                    callback({\"error\": i18next.t(\"Error occurred retrieving email audit entries.\")});\n                }\n            } else {\n                callback({\"error\": i18next.t(\"no data returned\")});\n            }\n        });\n    },\n    \"auditLog\": function(userId, params, callback) {\n        callback = callback || function() {};\n        if (!userId) {\n            callback({error: i18next.t(\"User id is required.\")});\n            return false;\n        }\n        this.sendRequest(\"/api/user/\" + userId + \"/audit\", \"GET\", userId, params, function(data) {\n            if (data) {\n                if (!data.error) {\n                    callback(data);\n                } else {\n                    callback({\"error\": i18next.t(\"Error occurred retrieving audit log.\")});\n                }\n            } else {\n                callback({\"error\": i18next.t(\"no data returned\")});\n            }\n        });\n    },\n    \"setting\": function(key, userId, params, callback) {\n        callback = callback || function() {};\n        if (!key) {\n            callback({\"error\": i18next.t(\"configuration key is required.\")});\n            return false;\n        }\n        params = params || {};\n        this.sendRequest(\"/api/settings/\" + key, \"GET\", userId, {\n            \"sync\": params.sync\n        }, function(data) {\n            if (data) {\n                if (!data.error) {\n                    callback(data);\n                } else {\n                    callback({\"error\": i18next.t(\"Error occurred retrieving content for configuration key.\")});\n                }\n            } else {\n                callback({\"error\": i18next.t(\"no data returned\")});\n            }\n        });\n    },\n    \"deactivateUser\": function(userId, params, callback) {\n        callback = callback||function() {};\n        if (!userId) {\n            callback({\"error\": i18next.t(\"User id is required\")});\n            return false;\n        }\n        this.sendRequest(\"/api/user/\" + userId, \"DELETE\", userId, (params || {}), function(data) {\n            callback = callback||function() {};\n            if (!data || data.error) {\n                callback({\"error\": i18next.t(\"Error occurred deactivating user.\")});\n                return;\n            }\n            callback(data);\n        });\n    },\n    \"reactivateUser\": function(userId, params, callback) {\n        callback = callback||function() {};\n        if (!userId) {\n            callback({\"error\": i18next.t(\"User id is required\")});\n            return false;\n        }\n        this.sendRequest(\"/api/user/\" + userId + \"/reactivate\", \"POST\", userId, (params || {}), function(data) {\n            if (!data || data.error) {\n                callback({\"error\": i18next.t(\"Error occurred reactivating user.\")});\n                return;\n            }\n            callback(data);\n        });\n    },\n    \"getConfigurationByKey\": function(configVar, params, callback) {\n        callback = callback || function() {};\n        if (!configVar) {\n            callback({\"error\": i18next.t(\"configuration variable name is required.\")});\n            return false;\n        }\n        var sessionConfigKey = \"config_\" + configVar;\n        if (sessionStorage.getItem(sessionConfigKey)) {\n            var data = JSON.parse(sessionStorage.getItem(sessionConfigKey));\n            callback(data);\n            return true;\n        }\n        this.sendRequest(\"/api/settings/\" + configVar, \"GET\", null, (params || {}), function(data) {\n            if (data) {\n                callback(data);\n                if (data.hasOwnProperty(configVar)) {\n                    sessionStorage.setItem(sessionConfigKey, JSON.stringify(data));\n                }\n            } else {\n                callback({\"error\": i18next.t(\"no data returned\")});\n            }\n        });\n    },\n    \"getConfiguration\": function(userId, params, callback) {\n        callback = callback || function() {};\n        var sessionConfigKey = \"settings_\" + userId;\n        if (sessionStorage.getItem(sessionConfigKey)) {\n            var data = JSON.parse(sessionStorage.getItem(sessionConfigKey));\n            callback(data);\n        } else {\n            this.sendRequest(\"/api/settings\", \"GET\", userId, (params || {}), function(data) {\n                if (data) {\n                    callback(data);\n                    sessionStorage.setItem(sessionConfigKey, JSON.stringify(data));\n                } else {\n                    callback({\n                        \"error\": i18next.t(\"no data returned\")\n                    });\n                }\n            });\n\n        }\n    },\n    \"getEmailReady\": function(userId, params, callback) {\n        callback = callback || function() {};\n        if (!userId) {\n            callback({error: i18next.t(\"User id is required.\")});\n            return false;\n        }\n        this.sendRequest(\"/api/user/\" + userId + \"/email_ready\", \"GET\", userId, params, function(data) {\n            callback(data);\n        });\n    }\n};\n","import tnthAjax from \"./modules/TnthAjax.js\";\nimport tnthDates from \"./modules/TnthDate.js\";\nimport SYSTEM_IDENTIFIER_ENUM from \"./modules/SYSTEM_IDENTIFIER_ENUM.js\";\n\n(function() {\n    var psaApp = window.psaApp = new Vue({ /*global Vue*/\n        el: \"#mainPsaApp\",\n        components: { //only re-usable components for now\n            \"refresh-icon\": {\n                props: [\"title\"],\n                template: \"<span class='glyphicon glyphicon-refresh refresh' aria-hidden='true' v-on:click='$emit(\\\"refresh\\\")' v-bind:title='title'></span>\"\n            },\n            \"filter-control\": {\n                props: [\"id\", \"prompt\", \"selectedvalue\", \"items\"],\n                template: \"<select v-bind:id='id' class='form-control filter-control' v-on:change='$emit(\\\"changeevent\\\", $event)'><option value='' class='select-option'>{{prompt}}</option><option v-bind:value='item' v-for='item in items' v-bind:selected='item == selectedvalue'>{{item}}</option></select>\"\n            }\n        },\n        errorCaptured: function(Error, Component, info) { /*eslint no-console: off */\n            console.error(\"Error: \", Error, \" Component: \", Component, \" Message: \", info);\n            return false;\n        },\n        errorHandler: function(err, vm) {\n            this.dataError = true;\n            var errorElement = document.getElementById(\"psaTrackerErrorMessageContainer\");\n            if(errorElement) {\n                errorElement.innerHTML = \"Error occurred initializing PSA Tracker Vue instance.\";\n            }\n            if (window.console) {\n                console.warn(\"PSA Tracker Vue instance threw an error: \", vm, this);\n                console.error(\"Error thrown: \", err); /*console global */\n            }\n        },\n        created: function() {\n            if (typeof Vue === \"undefined\") { return false; } /*global Vue */\n            var self = this;\n            Vue.config.errorHandler = function (err, vm, info)  {\n                var handler, current = vm;\n                if (vm.$options.errorHandler) {\n                    handler = vm.$options.errorHandler;\n                } else {\n                    while (!handler && current.$parent) {\n                        current = current.$parent;\n                        handler = current.$options.errorHandler;\n                    }\n                }\n                self.restoreVis();\n                if (handler) {\n                    handler.call(current, err, vm, info);\n                    return;\n                }\n                console.log(err);\n            };\n        },\n        data: {\n            userId: \"\",\n            userIdKey: \"psaTracker_currentUser\",\n            clinicalCode: \"666\",\n            clinicalDisplay: \"psa\",\n            clinicalSystem: \"http://us.truenth.org/clinical-codes\",\n            loading: false,\n            savingInProgress: false,\n            addErrorMessage: \"\",\n            noResultMessage: i18next.t(\"No PSA results to display\"),\n            editText: i18next.t(\"Edit\"),\n            saveText: i18next.t(\"Save\"),\n            closeText: i18next.t(\"Close\"),\n            filterText: i18next.t(\"Filter\"),\n            yLegendText: i18next.t(\"Result (ng/ml)\"),\n            xLegendText: i18next.t(\"PSA Test Date\"),\n            MAX_RESULT: 10000,\n            treatmentEditUrl: \"profile#profileProceduresWrapper\",\n            newItem: {\n                id: \"\",\n                result: \"\",\n                date: \"\",\n                edit: false\n            },\n            headers: [\n                i18next.t(\"Date\"),\n                i18next.t(\"PSA (ng/ml)\")\n            ],\n            intro: {\n                header: i18next.t(\"Track Your PSA\"),\n                body: i18next.t(\"Prostate-specific antigen, or PSA, is a protein produced by cells of the prostate gland. The PSA test measures the level of PSA in a man's blood. For this test, a blood sample is sent to a laboratory for analysis. The results are reported as nanograms of PSA per milliliter (ng/mL) of blood.\"),\n                addText: i18next.t(\"ADD NEW PSA RESULT\")\n            },\n            fields: {\n                resultLabel: i18next.t(\"PSA (ng/ml)\"),\n                dateLabel: i18next.t(\"PSA Test Date\"),\n                resultPlaceholder: i18next.t(\"Enter a number\"),\n                datePlaceholder: i18next.t(\"d M yyyy, example: 1 Jan, 2017\")\n            },\n            items: [],\n            history: {\n                title: i18next.t(\"PSA Result History\"),\n                items: [],\n                buttonLabel: i18next.t(\"History\"),\n                sidenote: \"\"\n            },\n            originals: [],\n            resultRange: [\"<= 4\", \">= 2\", \">= 3\", \">= 4\", \">= 5\"],\n            RANGE_ENUM: {\n                \"<= 4\": function(items) { return $.grep(items, function(item) {\n                    return item.result <= 4;\n                });},\n                \">= 2\": function(items) { return $.grep(items, function(item) {\n                    return item.result >= 2;\n                });},\n                \">= 3\": function(items) { return $.grep(items, function(item) {\n                    return item.result >= 3;\n                });},\n                \">= 4\": function(items) { return $.grep(items, function(item) {\n                    return item.result >= 4;\n                });},\n                \">= 5\": function(items) { return $.grep(items, function(item) {\n                    return item.result >= 5;\n                });}\n            },\n            filters: {\n                filterYearPrompt: i18next.t(\"Filter By Year\"),\n                filterResultPrompt: i18next.t(\"Filter By Result\"),\n                selectedFilterYearValue: \"\",\n                selectedFilterResultRange: \"\",\n                clearLabel: i18next.t(\"Clear Filters\")\n            },\n            showRefresh: false,\n            treatment: {\n                treatmentTextPrompt: i18next.t(\"Last Received Treatment:\"),\n                treatmentDatePrompt: i18next.t(\"Treatment Date:\"),\n                noTreatmentText: i18next.t(\"No treatment received as of today\"),\n                data: []\n            },\n            modalLoading: false,\n            editLink: i18next.t(\"Edit\"),\n            editTitle: i18next.t(\"Edit PSA Result\"),\n            addTitle: i18next.t(\"Add PSA Result\")\n        },\n        computed: {\n            yearList: function() {\n                var yearList = this.originals.map(function(item) {\n                    return item.titleYear;\n                });\n                yearList = $.grep(yearList, function(item, index) {\n                    return yearList.indexOf(item) === index;\n                });\n                return yearList;\n            }\n        },\n        methods: {\n            init: function(dependencies) {\n                var self = this;\n                dependencies = dependencies || {};\n                for(var prop in dependencies) {\n                    if (dependencies.hasOwnProperty(prop)) {\n                        self[prop] = dependencies[prop];\n                    }\n                }\n                sessionStorage.removeItem(this.userIdKey);\n                this.getData(true);\n                this.getProcedure();\n                setTimeout(function() {\n                    self.initElementsEvents();\n                }, 300);\n            },\n            isActedOn: function() {\n                return this.showRefresh && (this.filters.selectedFilterYearValue !== \"\" || this.filters.selectedFilterResultRange !== \"\");\n            },\n            restoreVis: function() {\n                var loadingElement = document.getElementById(\"loadingIndicator\"), mainElement = document.getElementById(\"mainHolder\");\n                if (loadingElement) { loadingElement.setAttribute(\"style\", \"display:none; visibility:hidden;\"); }\n                if (mainElement) { mainElement.setAttribute(\"style\", \"visibility:visible;-ms-filter:'progid:DXImageTransform.Microsoft.Alpha(Opacity=100)';filter:alpha(opacity=100); -moz-opacity:1; -khtml-opacity:1; opacity:1\"); }\n            },\n            isEdit: function() {\n                return this.newItem.edit;\n            },\n            refresh: function() {\n                this.clearFilter();\n                this.getData();\n            },\n            getAddModalTitle: function() {\n                if (this.newItem.edit) {\n                    return this.editTitle;\n                }\n                return this.addTitle;\n            },\n            getRefreshMessage: function() {\n                return i18next.t(\"Click to reload the page and try again.\");\n            },\n            validateResult: function(val) {\n                var isValid = !(isNaN(val) || parseInt(val) < 0 || parseInt(val) > this.MAX_RESULT);\n                if(!isValid) {\n                    this.addErrorMessage = i18next.t(\"Result must be a number and within valid range (less than {max_result}).\").replace(\"{max_result}\", this.MAX_RESULT);\n                    return false;\n                }\n                this.addErrorMessage = \"\";\n                return isValid;\n            },\n            validateDate: function(date) {\n                if (!date || date.length <= 9) { //don't show validation error until enough characters are entered, just return false\n                    return false;\n                }\n                var isValid = this.tnthDates.isValidDefaultDateFormat(date);\n                if(!isValid) {\n                    this.addErrorMessage = i18next.t(\"Date must be in the valid format.\");\n                } else {\n                    this.addErrorMessage = \"\";\n                }\n                return isValid;\n            },\n            formatDateString: function(date, format) {\n                return this.tnthDates.formatDateString(date, format);\n            },\n            initElementsEvents: function() {\n                var self = this;\n                /*\n                 * date picker events\n                 */\n                $(\"#psaDate\").datepicker({\n                    \"format\": \"d M yyyy\",\n                    \"forceParse\": false,\n                    \"endDate\": new Date(),\n                    \"maxViewMode\": 2,\n                    \"autoclose\": true\n                }).on(\"hide\", function() {\n                    $(\"#psaDate\").trigger(\"blur\");\n                });\n                $(\"#psaDate\").on(\"change blur\", function() {\n                    var newDate = $(this).val();\n                    if (!newDate || !self.validateDate(newDate)) {\n                        return false;\n                    }\n                    self.newItem.date = newDate;\n                }).on(\"focus\", function() {\n                    self.modalLoading = false;\n                });\n                /*\n                 * new result field event\n                 */\n                $(\"#psaResult\").on(\"blur\", function() {\n                    self.validateResult($(this).val());\n                });\n\n                $(\"#psaTrackerBtnAddNew\").on(\"click\", function() {\n                    self.clearNew();\n                });\n                /*\n                 * use numeric keypad for PSA result on mobile devices\n                 */\n                 this.convertToNumericField($(\"#psaResult\"));\n                /*\n                 * modal event\n                 */\n                $(\"#addPSAModal\").on(\"show.bs.modal\", function() {\n                    self.modalLoading = true;\n                });\n                $(\"#addPSAModal\").on(\"shown.bs.modal\", function() {\n                    $(\"#psaResult\").focus();\n                    $(\"#psaDate\").datepicker(\"update\", self.newItem.date||new Date());\n                    setTimeout(function() {\n                        self.modalLoading = false; //allow time for setting value with it being visible to user\n                    }, 50);\n                });\n                $(\"#psaTrackerResultsTable .result-row\").on(\"mouseover\", function() {\n                    $(this).addClass(\"edit\");\n                }).on(\"mouseout\", function() {\n                    $(this).removeClass(\"edit\");\n                });\n            },\n            convertToNumericField: function(field) {\n                if (field && (\"ontouchstart\" in window || (typeof(window.DocumentTouch) !== \"undefined\" && document instanceof window.DocumentTouch))) {\n                    field.each(function() {$(this).prop(\"type\", \"tel\");});\n                }\n            },\n            getCurrentUserId: function() {\n                var self = this;\n                if(!sessionStorage.getItem(this.userIdKey)) {\n                    this.tnthAjax.sendRequest(\"/api/me\", \"GET\", \"\", { sync: true }, function(data) {\n                        if(!data.error) {\n                            sessionStorage.setItem(self.userIdKey, data.id);\n                        } else {\n                            sessionStorage.setItem(self.userIdKey, $(\"#psaTracker_currentUser\").val());\n                        }\n                    });\n                }\n                return sessionStorage.getItem(this.userIdKey);\n            },\n            getExistingItemByDate: function(newDate) {\n                var convertedDate = this.tnthDates.formatDateString(newDate, \"iso-short\"), self = this;\n                return $.grep(this.items, function(item) {\n                    return convertedDate === self.tnthDates.formatDateString(item.date, \"iso-short\");\n                });\n            },\n            onEdit: function(item) {\n                var self = this;\n                if(item) {\n                    for(var prop in self.newItem) {\n                        if (self.newItem.hasOwnProperty(prop)) {\n                            self.newItem[prop] = item[prop];\n                        }\n                    }\n                    setTimeout(function() {\n                        $(\"#addPSAModal\").modal(\"show\");\n                    }, 250);\n                }\n            },\n            isValidData: function() {\n                var newDate = this.newItem.date;\n                var newResult = this.newItem.result;\n                return newDate && this.validateDate(newDate) && newResult && this.validateResult(newResult);\n            },\n            onAdd: function() {\n                if (!this.isValidData()) {\n                    return false;\n                }\n                this.addErrorMessage = \"\";\n                var existingItem = this.getExistingItemByDate(this.newItem.date);\n                if(existingItem.length > 0) {\n                    this.newItem.id = existingItem[0].id;\n                }\n                this.postData();\n            },\n            getProcedure: function() {\n                var self = this;\n                this.tnthAjax.getProc(this.getCurrentUserId(), false, function(data) {\n                    if (!data) { return false; }\n                    data.entry = data.entry || [];\n                    var treatmentData = $.grep(data.entry, function(item) {\n                        var code = item.resource.code.coding[0].code;\n                        return code !== SYSTEM_IDENTIFIER_ENUM.CANCER_TREATMENT_CODE && code !== SYSTEM_IDENTIFIER_ENUM.NONE_TREATMENT_CODE;\n                    });\n                    if (treatmentData.length === 0) { return false; }\n                    treatmentData.sort(function(a, b) {\n                        return new Date(b.resource.performedDateTime) - new Date(a.resource.performedDateTime);\n                    });\n                    self.treatment.data = [treatmentData.map(function(item) {\n                        return {\n                            \"display\": item.resource.code.coding[0].display,\n                            \"date\": self.formatDateString(item.resource.performedDateTime.substring(0, 19), \"d M y\")\n                        };\n                    })[0]];\n                });\n            },\n            showTreatment: function() {\n                return this.treatment.data.length > 0;\n            },\n            getData: function() {\n                var self = this;\n                this.loading = true;\n                this.tnthAjax.getClinical(this.getCurrentUserId(), {data: {patch_dstu2: true}}, function(data) {\n                    if(data.error) {\n                        $(\"#psaTrackerErrorMessageContainer\").html(i18next.t(\"Error occurred retrieving PSA result data\"));\n                        self.loading = false;\n                        return false;\n                    }\n                    if (!data.entry) {\n                        $(\"#psaTrackerErrorMessageContainer\").html(i18next.t(\"No result data found\"));\n                        self.loading = false;\n                        return false;\n                    }\n                    var results = (data.entry).map(function(item) {\n                        var dataObj = {}, content = item.resource, contentCoding = content.code.coding[0];\n                        item.updated = item.updated || \"\";\n                        dataObj.id = content.id;\n                        dataObj.code = contentCoding.code;\n                        dataObj.display = contentCoding.display;\n                        dataObj.updated = self.formatDateString(item.updated.substring(0, 19), \"yyyy-mm-dd hh:mm:ss\");\n                        dataObj.date = content.issued ? self.formatDateString(content.issued.substring(0, 19), \"d M y\"): \"\";\n                        dataObj.result = content.valueQuantity.value;\n                        dataObj.edit = true;\n                        dataObj.titleYear = new Date(content.issued).getFullYear();\n                        return dataObj;\n                    });\n                    results = $.grep(results, function(item) {\n                        return item.display.toLowerCase() === \"psa\";\n                    });\n                    // sort from newest to oldest\n                    results = results.sort(function(a, b) {\n                        return new Date(b.date) - new Date(a.date);\n                    });\n                    /*\n                     * display only 10 most recent results\n                     */\n                    if(results.length > 10) {\n                        var tempResults = results;\n                        results = results.slice(0, 10);\n                        self.history.items = tempResults.slice(10, 20);\n                        self.history.sidenote = String(i18next.t(\"* Maximum of {resultNumber} results since {year}\")).replace(\"{resultNumber}\", 10).replace(\"{year}\", self.getHistoryMinYear());\n                    }\n                    if (results.length === 0) {\n                        self.noResultMessage = i18next.t(\"No PSA results to display\");\n                    }\n                    self.items = self.originals = results;\n                    self.filterData();\n                    setTimeout(function() {\n                        self.drawGraph();\n                        self.loading = false;\n                    }, 500);\n                    $(\"#psaTrackerErrorMessageContainer\").html(\"\");\n                });\n            },\n            showHistory: function() {\n                $(\"#PSAHistoryModal\").modal(\"show\");\n            },\n            getHistoryMinYear: function() {\n                if (this.history.items.length === 0) {\n                    return false;\n                }\n                var yearArray = this.history.items.map(function(item) {\n                    return (new Date(item.date)).getFullYear();\n                });\n                yearArray.sort(function(a, b) {\n                    return a - b;\n                });\n                return yearArray[0];\n            },\n            clearFilter: function() {\n                this.filters.selectedFilterResultRange = \"\";\n                this.filters.selectedFilterYearValue = \"\";\n            },\n            filterData: function(redraw) {\n                var results = this.originals, self = this;\n                this.items = this.originals;\n                if (this.filters.selectedFilterYearValue !== \"\") {\n                    results = $.grep(results, function(item) {\n                        return parseInt(item.titleYear) === parseInt(self.filters.selectedFilterYearValue);\n                    });\n                    this.items = results;\n                }\n                if (this.filters.selectedFilterResultRange) {\n                    this.items = this.RANGE_ENUM[this.filters.selectedFilterResultRange](this.items);\n                }\n                if (this.items.length === 0 && this.isActedOn()) {\n                    this.noResultMessage = i18next.t(\"No PSA result matching the filtering criteria. Please try again.\");\n                }\n                if (!redraw) {\n                    return false;\n                }\n                setTimeout(function() {\n                    self.drawGraph();\n                }, 500);\n            },\n            filterDataByYearEvent: function(event) {\n                this.showRefresh = true;\n                this.filters.selectedFilterYearValue = event.target.value;\n                this.filterData(true);\n            },\n            filterDataByResultEvent: function(event) {\n                this.showRefresh = true;\n                this.filters.selectedFilterResultRange = event.target.value;\n                this.filterData(true);\n            },\n            showFilters: function() {\n                return this.originals.length > 1;\n            },\n            postData: function() {\n                var cDate = \"\";\n                var self = this;\n                var userId = this.getCurrentUserId();\n                if(this.newItem.date) {\n                    var dt = new Date(this.newItem.date);\n                    // in 2017-07-06T12:00:00 format\n                    cDate = [dt.getFullYear(), (dt.getMonth() + 1), dt.getDate()].join(\"-\");\n                    cDate = cDate + \"T12:00:00\";\n                }\n                var url = \"/api/patient/\" + userId + \"/clinical\";\n                var method = \"POST\";\n                var obsCode = [{ \"code\": this.clinicalCode, \"display\": this.clinicalDisplay, \"system\": this.clinicalSystem }];\n                var obsArray = {};\n                obsArray[\"resourceType\"] = \"Observation\";\n                obsArray[\"code\"] = { \"coding\": obsCode };\n                obsArray[\"issued\"] = cDate;\n                obsArray[\"valueQuantity\"] = { \"units\": \"g/dl\", \"code\": \"g/dl\", \"value\": this.newItem.result };\n\n                if(this.newItem.id) {\n                    method = \"PUT\";\n                    url = url + \"/\" + this.newItem.id;\n                }\n                this.savingInProgress = true;\n                this.tnthAjax.sendRequest(url, method, userId, { data: JSON.stringify(obsArray), async: true }, function(data) {\n                    if(data.error) {\n                        self.addErrorMessage = i18next.t(\"Server error occurred adding PSA result.\");\n                    } else {\n                        $(\"#addPSAModal\").modal(\"hide\");\n                        self.clearFilter(); //clear filter after every new data update?\n                        self.getData();\n                        self.addErrorMessage = \"\";\n                    }\n                    setTimeout(function() {\n                        self.savingInProgress = false;\n                    }, 550);\n                });\n            },\n            clearNew: function() {\n                var self = this;\n                for(var prop in self.newItem) {\n                    if (self.newItem.hasOwnProperty(prop)) {\n                        self.newItem[prop] = \"\";\n                    }\n                }\n                $(\"#psaDate\").datepicker(\"update\", \"\");\n            },\n            __handleTreatmentDate: function(minDate, maxDate, step) { //use internally\n                if (this.treatment.data.length === 0) {\n                    return false;\n                }\n                step = Math.floor(step/2); //should throw error if no value provided\n                var treatmentDate = new Date(this.treatment.data[0].date);\n                if (treatmentDate.getTime() < minDate.getTime()) {\n                    var startMinDate = new Date(minDate);\n                    return new Date(startMinDate.setUTCDate(startMinDate.getUTCDate() - step));\n                }\n                if (treatmentDate.getTime() > maxDate.getTime()) {\n                    var startMaxDate = new Date(maxDate);\n                    return new Date(startMaxDate.setUTCDate(startMaxDate.getUTCDate() + step));\n                }\n                return treatmentDate;\n            },\n            getNearestPow10: function(n){ //find the closest power of 10 given a number\n                var base = Math.log(n) / Math.LN10;\n                if (base >= Math.ceil(base)-0.1) {\n                    base = base + 1; //accounting for when log of number is perfect integer, 1, 10, 100, 1000, so need to draw next grid line up\n                }\n                else {\n                    base = Math.ceil(base);\n                }\n                return Math.pow(10, base);\n            },\n            getRange: function getRange(size, startAt, step) {\n                var arr = []; size=size||10; startAt=startAt||0; step = step||1;\n                for (var index=startAt; index < size; index++) {\n                    arr.push(step*index);\n                }\n                return arr;\n            },\n            getDayInMiliseconds: function() {\n                return 1000 * 60 * 60 * 24;\n            },\n            getInterval: function(minDate, maxDate, step) {\n                step = step || 8;\n                if (!maxDate || !minDate) {\n                    return step;\n                }\n                var DAY = this.getDayInMiliseconds();\n                var DIFF = (new Date(maxDate) - new Date(minDate)) / DAY;\n                return Math.ceil(DIFF / step);\n            },\n            dateTicks: function(t0, t1) {\n                var startTime = new Date(t0), endTime = new Date(t1), times = [], dateTime;\n                var INTERVAL = this.getInterval(t0, t1, 7) || 7;\n                startTime.setUTCDate(startTime.getUTCDate());\n                endTime.setUTCDate(endTime.getUTCDate());\n                while(startTime <= endTime) {\n                    dateTime = new Date(startTime);\n                    startTime.setUTCDate(startTime.getUTCDate() + INTERVAL);\n                    times.push(dateTime);\n                    if (startTime > endTime) {\n                        times.push(new Date(endTime));\n                    }\n                }\n                return times;\n            },\n            setLetterSpacing: function(string) {\n                string = string || \"\";\n                var dxString = \"0 \";\n                for (var index = 1; index < string.length; index++) {\n                    if (/\\s/.test(string.charAt(index))) {\n                        dxString += \"3 \";\n                        continue;\n                    }\n                    dxString += \"2 \";\n                }\n                return dxString;\n            },\n            drawGraph: function() { //using d3 library to draw graph\n                $(\"#psaTrackerGraph\").html(\"\");\n                var self = this;\n                var d3 = self.d3;\n                var WIDTH = 640, HEIGHT = 430, TOP = 50, RIGHT = 40, BOTTOM = 70, LEFT = 70, TIME_FORMAT = \"%d %b %Y\";\n\n                // Set the dimensions of the canvas / graph\n                var margin = { top: TOP, right: RIGHT, bottom: BOTTOM, left: LEFT },\n                    width = WIDTH - margin.left - margin.right,\n                    height = HEIGHT - margin.top - margin.bottom;\n\n                var timeFormat = d3.time.format(TIME_FORMAT);\n                var parseDate = timeFormat.parse; // Parse the date / time func\n                var data = self.items;\n\n                data.forEach(function(d) {\n                    d.graph_date = parseDate(d.date);\n                    d.result = isNaN(d.result) ? 0.1 : +d.result;\n                });\n\n                var minDate = d3.min(data, function(d) {\n                    return d.graph_date;\n                });\n                var maxDate = d3.max(data, function(d) {\n                    return d.graph_date;\n                });\n                var maxResult = d3.max(data, function(d) {\n                    return d.result;\n                });\n\n                var xDomain = d3.extent(data, function(d) { return d.graph_date; });\n                var bound = (width - margin.left - margin.right) / 7;\n                var x = d3.time.scale().range([bound, width - bound]);\n                var y = d3.scale.log().range([height, 0]); //log scale\n\n                if (data.length <= 2 || String(minDate) === String(maxDate)) {\n                    var firstDate = new Date(maxDate);\n                    maxDate = new Date(firstDate.setDate(firstDate.getDate() + 365));\n                    xDomain = [minDate, maxDate];\n                }\n\n                var maxResultInLog = self.getNearestPow10(maxResult);\n\n                x.domain(xDomain);\n                y.domain([0.1, maxResultInLog]); //scale to the closest power of 10 based on the maximum result\n                // Define the axes\n                var xAxis = d3.svg.axis()\n                    .scale(x)\n                    .orient(\"bottom\")\n                    .ticks(self.dateTicks)\n                    .tickSize(0, 0, 0)\n                    .tickFormat(timeFormat);\n\n                var yAxis = d3.svg.axis()\n                    .scale(y)\n                    .ticks(10)\n                    .orient(\"left\")\n                    .tickSize(0, 0, 0);\n\n                // Define the line\n                var valueline = d3.svg.line()\n                    .x(function(d) { return x(d.graph_date); })\n                    .y(function(d) { return y(d.result); });\n\n                // Adds the svg canvas\n                var svg = d3.select(\"#psaTrackerGraph\")\n                    .append(\"svg\")\n                    .attr(\"width\", width + margin.left + margin.right)\n                    .attr(\"height\", height + margin.top + margin.bottom);\n\n                var graphArea = svg.append(\"g\").attr(\"transform\", \"translate(\" + margin.left + \",\" + margin.top + \")\");\n\n                // Add the X Axis\n                graphArea.append(\"g\")\n                    .attr(\"class\", \"x axis x-axis\")\n                    .attr(\"transform\", \"translate(0,\" + (height +  5) + \")\")\n                    .call(xAxis)\n                    .selectAll(\"text\")\n                    .call(function(text) {\n                        text.each(function() {\n                            var textNode = d3.select(this);\n                            var dateString = textNode.text();\n                            var arrDate = dateString.split(/\\s+/);\n                            var dx = \"-1.25em\";\n                            textNode.text(null).append(\"tspan\").attr(\"x\", 0).attr(\"y\", textNode.attr(\"y\")).attr(\"dx\", dx).attr(\"dy\", textNode.attr(\"dy\")).text(arrDate[0] + \" \" + arrDate[1]);\n                            textNode.append(\"tspan\").attr(\"x\", 0).attr(\"y\", textNode.attr(\"y\")).attr(\"dx\", \"-1em\").attr(\"dy\", \"2em\").text(arrDate[2]);\n                        });\n                    })\n                    .attr(\"y\", 0)\n                    .attr(\"x\", 7)\n                    .attr(\"dy\", \".35em\")\n                    .attr(\"class\", \"axis-stroke\")\n                    .style(\"letter-spacing\", \"1px\")\n                    .style(\"text-anchor\", \"start\");\n\n                // add the X gridlines\n                graphArea.append(\"g\")\n                    .attr(\"class\", \"grid grid-x\")\n                    .attr(\"transform\", \"translate(0,\" + height + \")\")\n                    .call(xAxis\n                        .tickSize(-height, 0, 0)\n                        .tickFormat(\"\")\n                    );\n                // add the Y ticks and gridlines\n                graphArea.append(\"g\")\n                    .attr(\"class\", \"grid grid-y\")\n                    .call(yAxis\n                        .tickSize(-width, 0, 0)\n                        .tickValues(function() {\n                            return self.getRange(Math.log(maxResultInLog),-1,0.5).map(function(n) { //finer lines between each log base 10 line\n                                return Math.pow(10, n); //draw grid in log scale\n                            });\n                        })\n                        .tickFormat(function(d) {\n                            if (d === parseInt(d)) { //this will only show tick values that are integers\n                                return d;\n                            }\n                            return \"\";\n                        })\n                    )\n                    .selectAll(\"text\")\n                    .attr(\"dx\", \"-2px\")\n                    .attr(\"dy\", \"6px\")\n                    .attr(\"class\", \"axis-stroke\")\n                    .style(\"text-anchor\", \"end\");\n\n                //borders around graph area\n                var BORDER_STROKE_COLOR = \"#3F4B54\";\n                svg.append(\"path\").attr(\"d\", \"M \" + margin.left + \" \" + margin.top + \" V \" + (HEIGHT-margin.bottom) + \" H\" + (WIDTH-margin.right))\n                    .style(\"stroke\", BORDER_STROKE_COLOR)\n                    .style(\"stroke-width\", \"1\");\n                svg.append(\"path\").attr(\"d\", \"M \" + margin.left + \" \" + margin.top + \" H \" + (WIDTH-margin.right) + \" V \" + (HEIGHT-margin.bottom))\n                    .style(\"stroke\", BORDER_STROKE_COLOR)\n                    .style(\"stroke-width\", \"0.5\");\n\n                //add div for tooltip\n                var tooltipContainer = d3.select(\"body\").append(\"div\").attr(\"class\", \"tooltip\").style(\"opacity\", 0);\n\n                //treatment line\n                var treatmentDate = self.__handleTreatmentDate(minDate, maxDate, self.getInterval(minDate, maxDate, 7));\n                var TREATMENT_TEXT_COLOR = \"#EF425C\";\n                if (treatmentDate) {\n                    var treatmentPath = graphArea.append(\"path\");\n                    treatmentPath.attr(\"d\", \"M\"+x(treatmentDate) + \" 0\" + \" V \" + height + \" Z\")\n                        .style(\"stroke\", TREATMENT_TEXT_COLOR)\n                        .style(\"stroke-dasharray\", \"1, 5\")\n                        .style(\"stroke-width\", \"2\");\n\n                    graphArea.append(\"use\")\n                        .attr(\"x\", x(treatmentDate) - 2)\n                        .attr(\"y\", -2)\n                        .attr(\"xlink:href\", \"#marker\");\n\n                    graphArea.append(\"use\")\n                        .attr(\"x\", x(treatmentDate) + 6)\n                        .attr(\"y\", height - 6)\n                        .attr(\"xlink:href\", \"#arrow\");\n\n                    var RECT_HEIGHT = 25, RECT_WIDTH = 76;\n                    graphArea.append(\"rect\")\n                        .attr(\"x\", x(treatmentDate) - RECT_WIDTH/2)\n                        .attr(\"y\", 25)\n                        .attr(\"width\", RECT_WIDTH)\n                        .attr(\"height\", RECT_HEIGHT)\n                        .style(\"stroke\", TREATMENT_TEXT_COLOR)\n                        .style(\"stroke-width\", \"0.5\")\n                        .style(\"fill\", TREATMENT_TEXT_COLOR);\n                    graphArea.append(\"text\")\n                        .attr(\"x\", x(treatmentDate))\n                        .attr(\"y\", 41)\n                        .attr(\"text-anchor\", \"middle\")\n                        .attr(\"font-size\", \"11px\")\n                        .style(\"stroke-width\", \"4px\")\n                        .style(\"fill\", \"#FFF\")\n                        .style(\"letter-spacing\", \"2px\")\n                        .text(i18next.t(\"treatment\"));\n                }\n\n                // Add the valueline path.\n                graphArea.append(\"path\")\n                    .attr(\"class\", \"line\")\n                    .style(\"stroke\", \"#bec0c1\")\n                    .style(\"stroke-width\", 2)\n                    .attr(\"d\", valueline(data));\n\n                // Add the scatterplot\n                var circleRadius = 7.7, CIRCLE_STROKE_COLOR = \"#809EAE\";\n                graphArea.selectAll(\"circle\").data(data)\n                    .enter().append(\"circle\")\n                    .transition()\n                    .duration(850)\n                    .delay(function(d, i) { return i * 7; })\n                    .style(\"stroke\", CIRCLE_STROKE_COLOR)\n                    .style(\"stroke-width\", 2)\n                    .attr(\"r\", circleRadius)\n                    .attr(\"class\", \"circle\")\n                    .attr(\"cx\", function(d) { return x(d.graph_date); })\n                    .attr(\"cy\", function(d) { return y(d.result); });\n                graphArea.selectAll(\"circle\")\n                    .on(\"mouseover\", function(d) {\n                        var element = d3.select(this);\n                        element.transition().duration(100).attr(\"r\", circleRadius * 1.2);\n                        element.style(\"fill\", CIRCLE_STROKE_COLOR)\n                            .classed(\"focused\", true);\n                        var TOOLTIP_WIDTH = (String(d.date).length*8 + 10);\n                        tooltipContainer.transition().duration(200).style(\"opacity\", .9); //show tooltip for each data point\n                        tooltipContainer.html(\"<b>\" + i18next.t(\"PSA\") + \"</b> \" + d.result + \"<br/><span class='small-text'>\" + d.date + \"</span>\")\n                            .style(\"width\", TOOLTIP_WIDTH + \"px\")\n                            .style(\"height\", 35 + \"px\")\n                            .style(\"left\", (d3.event.pageX - TOOLTIP_WIDTH/2) + \"px\")\n                            .style(\"top\", (d3.event.pageY - TOOLTIP_WIDTH/2) + \"px\");\n                    })\n                    .on(\"mouseout\", function() {\n                        var element = d3.select(this);\n                        element.transition()\n                            .duration(100)\n                            .attr(\"r\", circleRadius);\n                        element.style(\"stroke\", CIRCLE_STROKE_COLOR)\n                            .style(\"fill\", \"#FFF\")\n                            .classed(\"focused\", false);\n                        tooltipContainer.transition().duration(500).style(\"opacity\", 0);\n                    });\n\n                // Add text labels\n                graphArea.selectAll(\"text.text-label\")\n                    .data(data)\n                    .enter()\n                    .append(\"text\")\n                    .classed(\"text-label\", true)\n                    .attr(\"x\", function(d) {\n                        return x(d.graph_date);\n                    })\n                    .attr(\"y\", function(d) {\n                        return y(d.result);\n                    })\n                    .attr(\"text-anchor\", \"middle\")\n                    .attr(\"dy\", \"-1.35em\")\n                    .attr(\"font-size\", \"11px\")\n                    .style(\"stroke-width\", \"2\")\n                    .attr(\"font-weight\", \"500\")\n                    .attr(\"letter-spacing\", \"2px\")\n                    .attr(\"fill\", \"#656F76\")\n                    .text(function(d) {\n                        return d.result;\n                    });\n\n                // Add caption\n                graphArea.append(\"text\")\n                    .attr(\"x\", (width / 2))\n                    .attr(\"y\", 0 - (margin.top / 2))\n                    .attr(\"text-anchor\", \"middle\")\n                    .attr(\"class\", \"graph-caption\")\n                    .text(\"PSA (ng/ml)\");\n\n                //add axis legends\n                var xlegend = graphArea.append(\"g\")\n                    .attr(\"transform\", \"translate(\" + (width / 2 - margin.left + margin.right - 20) + \",\" + (height + margin.bottom - margin.bottom / 5) + \")\");\n\n                xlegend.append(\"text\")\n                    .text(self.xLegendText)\n                    .attr(\"dx\", self.setLetterSpacing(self.xLegendText))\n                    .attr(\"class\", \"legend-text\");\n\n                var ylegend = graphArea.append(\"g\")\n                    .attr(\"transform\", \"translate(\" + (-margin.left + margin.left / 2 - 5) + \",\" + (height / 2 + height / 6) + \")\");\n\n                ylegend.append(\"text\")\n                    .attr(\"transform\", \"rotate(270)\")\n                    .attr(\"class\", \"legend-text\")\n                    .attr(\"dx\", self.setLetterSpacing(self.yLegendText)) //using dx attribute for letter spacing due to FF not supporting SVG element's letter spacing styling\n                    .text(self.yLegendText);\n\n            }\n        }\n    });\n    $(function() { /*global $ tnthDates, tnthAjax, SYSTEM_IDENTIFIER_ENUM, i18next, d3 */\n        psaApp.init({ tnthDates: tnthDates, tnthAjax: tnthAjax, SYSTEM_IDENTIFIER_ENUM: SYSTEM_IDENTIFIER_ENUM, d3: d3});\n    });\n})();\n"],"sourceRoot":""}