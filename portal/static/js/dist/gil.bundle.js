!function(e){var t={};function n(i){if(t[i])return t[i].exports;var o=t[i]={i:i,l:!1,exports:{}};return e[i].call(o.exports,o,o.exports,n),o.l=!0,o.exports}n.m=e,n.c=t,n.d=function(e,t,i){n.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:i})},n.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},n.t=function(e,t){if(1&t&&(e=n(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var i=Object.create(null);if(n.r(i),Object.defineProperty(i,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var o in e)n.d(i,o,function(t){return e[t]}.bind(null,o));return i},n.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return n.d(t,"a",t),t},n.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},n.p="",n(n.s=9)}({1:function(e,t,n){"use strict";n.d(t,"b",function(){return r}),n.d(t,"c",function(){return a});var i,o=((i=function(){this.requestAttempts=0}).prototype.hasValue=function(e){return"null"!==String(e)&&""!==String(e)&&"undefined"!==String(e)},i.prototype.showMain=function(){$("#mainHolder").css({visibility:"visible","-ms-filter":"progid:DXImageTransform.Microsoft.Alpha(Opacity=100)",filter:"alpha(opacity=100)","-moz-opacity":1,"-khtml-opacity":1,opacity:1})},i.prototype.hideLoader=function(e,t){e?$("#loadingIndicator").hide():setTimeout(function(){$("#loadingIndicator").fadeOut()},t||200)},i.prototype.loader=function(e){if(document.getElementById("fullSizeContainer"))return this.hideLoader(),this.showMain(),!1;if(e)$("#loadingIndicator").show();else if(!this.isDelayLoading()){var t=this;setTimeout(function(){t.showMain()},100),this.hideLoader(!0,350)}},i.prototype.isDelayLoading=function(){return"undefined"!=typeof DELAY_LOADING&&DELAY_LOADING},i.prototype.isTouchDevice=function(){return!0===("ontouchstart"in window||window.DocumentTouch&&document instanceof window.DocumentTouch)},i.prototype.getIEVersion=function(){var e=navigator.userAgent.match(/(?:MSIE |Trident\/.*; rv:)(\d+)/);return!!e&&parseInt(e[1])},i.prototype.newHttpRequest=function(e,t,n){this.requestAttempts++;var i,o=this;for(var r in n=n||function(){},window.XDomainRequest?(i=new XDomainRequest).onload=function(){n(i.responseText)}:i=window.XMLHttpRequest?new XMLHttpRequest:new ActiveXObject("Microsoft.XMLHTTP"),i.onreadystatechange=function(){if(4===i.readyState){if(200===i.status)return n(i.responseText),void(o.requestAttempts=0);o.requestAttempts<3?setTimeout(function(){o.newHttpRequest(e,t,n)},3e3):(n({error:i.responseText}),o.loader(),o.requestAttempts=0)}},t=t||{},i.open("GET",e,!0),t)t.hasOwnProperty(r)&&i.setRequestHeader(r,t[r]);t.cache||(i.setRequestHeader("cache-control","no-cache"),i.setRequestHeader("expires","-1"),i.setRequestHeader("pragma","no-cache")),i.send()},i.prototype.ajaxRequest=function(e,t,n){if(n=n||function(){},!e)return n({error:i18next.t("Url is required.")}),!1;var i={url:e,type:"GET",contentType:"text/plain",timeout:5e3,cache:!1};t=t||i,t=$.extend({},i,t),this.requestAttempts++;var o=this;$.ajax(t).done(function(e){n(e),o.requestAttempts=0}).fail(function(){o.requestAttempts<=3?setTimeout(function(){o.ajaxRequest(e,t,n)},3e3):(n({error:i18next.t("Error occurred processing request")}),o.requestAttempts=0,o.loader())}).always(function(){o.loader()})},i.prototype.initWorker=function(e,t,n){var i=new Worker("/static/js/ajaxWorker.js"),o=this;i.postMessage({url:e,params:t}),i.addEventListener("message",function(e){n.call(o,e.data),i.terminate()},!1),i.addEventListener("error",function(e){console.log("Worker runtime error: Line ",e.lineno," in ",e.filename,": ",e.message),i.terminate()},!1)},i.prototype.workerAllowed=function(){return window.Worker&&!this.isTouchDevice()},i.prototype.getRequestMethod=function(){return this.getIEVersion()?this.newHttpRequest:this.ajaxRequest},i.prototype.sendRequest=function(e,t,n){if((t=t||{}).useWorker&&this.workerAllowed())return this.initWorker(e,t,n),!0;this.getRequestMethod().call(this,e,t,function(e){n.call(this,e)})},i.prototype.LRKeyEvent=function(){$(".button--LR").length>0&&$("html").on("keydown",function(e){parseInt(e.keyCode)===parseInt(187)&&$(".button--LR").toggleClass("data-show")})},i.prototype.getLoaderHTML=function(e){return'<div class="loading-message-indicator"><i class="fa fa-spinner fa-spin fa-2x"></i>'.concat(e?"&nbsp;"+e:"","</div>")},i.prototype.convertToNumericField=function(e){e&&this.isTouchDevice()&&e.each(function(){$(this).prop("type","tel")})},i.prototype.isString=function(e){return"[object String]"===Object.prototype.toString.call(e)},i.prototype.disableHeaderFooterLinks=function(){var e=$("#tnthNavWrapper a, #homeFooter a").not("a[href*='logout']").not("a.required-link").not("a.home-link");e.addClass("disabled"),e.prop("onclick",null).off("click"),e.on("click",function(e){return e.preventDefault(),!1})},i.prototype.pad=function(e){return e=parseInt(e),!isNaN(e)&&e<10?"0"+e:e},i.prototype.escapeHtml=function(e){return null===e||"undefined"!==e||0===String(e).length?e:e.replace(/[\"&'\/<>]/g,function(e){return{'"':"&quot;","&":"&amp;","'":"&#39;","/":"&#47;","<":"&lt;",">":"&gt;"}[e]})},i.prototype.containHtmlTags=function(e){return!!e&&/[<>]/.test(e)},i.prototype.getExportFileName=function(e){var t=new Date;return(e||"ExportList_")+("00"+t.getDate()).slice(-2)+("00"+(t.getMonth()+1)).slice(-2)+t.getFullYear()},i.prototype.capitalize=function(e){return e.replace(/\w\S*/g,function(e){return e.charAt(0).toUpperCase()+e.substr(1).toLowerCase()})},i.prototype.restoreVis=function(){var e=document.getElementById("loadingIndicator"),t=document.getElementById("mainHolder");e&&e.setAttribute("style","display:none; visibility:hidden;"),t&&t.setAttribute("style","visibility:visible;-ms-filter:'progid:DXImageTransform.Microsoft.Alpha(Opacity=100)';filter:alpha(opacity=100); -moz-opacity:1; -khtml-opacity:1; opacity:1")},i.prototype.VueErrorHandling=function(){if("undefined"==typeof Vue)return!1;var e=this;Vue.config.errorHandler=function(t,n,i){var o,r=n;if(n.$options.errorHandler)o=n.$options.errorHandler;else for(;!o&&r.$parent;)o=(r=r.$parent).$options.errorHandler;e.restoreVis(),o?o.call(r,t,n,i):console.log(t)}},i.prototype.extend=function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n]);return e},i.prototype.getUrlParameter=function(e){e=e.replace(/[\[]/,"\\[").replace(/[\]]/,"\\]");var t=new RegExp("[\\?&]"+e+"=([^&#]*)").exec(location.search);return null===t?"":decodeURIComponent(t[1])},i.prototype.resetBrowserBackHistory=function(e,t,n){var i="undefined"!=typeof history&&history.pushState;e=e||location.href,i&&history.pushState(t,n,e),window.addEventListener("popstate",function(){i?history.pushState(t,n,e):window.history.forward(1)})},i.prototype.handlePostLogout=function(){if("undefined"==typeof sessionStorage)return!1;sessionStorage.getItem("logout")&&(this.resetBrowserBackHistory(location.orgin,"logout"),sessionStorage.removeItem("logout"))},i.prototype.displaySystemOutageMessage=function(e){if(e=(e=e||"en-us").replace("_","-"),document.getElementById("systemMaintenanceContainer")){var t=this;this.ajaxRequest("api/settings",{contentType:"application/json; charset=utf-8"},function(n){if(!n||!n.MAINTENANCE_MESSAGE&&!n.MAINTENANCE_WINDOW)return!1;var i=document.querySelector(".message-container");if(i||((i=document.createElement("div")).classList.add("message-container"),document.getElementById("systemMaintenanceContainer").appendChild(i)),n.MAINTENANCE_MESSAGE)i.innerHTML=t.escapeHtml(n.MAINTENANCE_MESSAGE);else if(n.MAINTENANCE_WINDOW&&n.MAINTENANCE_WINDOW.length){var o,r,a=new Date(n.MAINTENANCE_WINDOW[0]),s=new Date(n.MAINTENANCE_WINDOW[1]),l=(o=new Date,r=a,o&&r?Math.floor((r.getTime()-o.getTime())/36e5%24):0);if(l<0||isNaN(l))document.getElementById("systemMaintenanceContainer").classList.add("tnth-hide");else try{var c={year:"numeric",month:"long",day:"numeric",hour:"numeric",minute:"numeric",second:"numeric",hour12:!0,timeZoneName:"short"},d=a.toLocaleString(e,c).replace(/[,]/g," "),u=s.toLocaleString(e,c).replace(/[,]/g," "),p=["<div>"+i18next.t("Hi there.")+"</div>","<div>"+i18next.t("TrueNTH will be down for website maintenance starting <b>{startdate}</b>. This should last until <b>{enddate}</b>.".replace("{startdate}",d).replace("{enddate}",u))+"</div>","<div>"+i18next.t("Thanks for your patience while we upgrade our site.")+"</div>"].join("");i.innerHTML=t.escapeHtml(p)}catch(e){console.log("Error occurred converting system outage date/time ",e),document.getElementById("systemMaintenanceContainer").classList.add("tnth-hide")}}})}},new i);t.a=o;var r=o.getExportFileName,a=o.getUrlParameter},6:function(e,t,n){"use strict";t.a=function(){return{init:function(e,t){t=t||function(){};try{!function(e,t){var n=function(e){if(""===String(e))return{};for(var t={},n=0;n<e.length;++n){var i=e[n].split("=",2);1===i.length?t[i[0]]="":t[i[0]]=decodeURIComponent(i[1].replace(/\+/g," "))}return t}(window.location.search.substr(1).split("&"));void 0!==window.localStorage&&window.localStorage.getItem("i18nextLng")&&window.localStorage.removeItem("i18nextLng");var i=e.loadPath||"/static/files/locales/{{lng}}/translation.json",o={fallbackLng:"en-US",lng:"en-US",preload:!1,debug:!1,defaultNS:"translation",initImmediate:!1,keySeparator:"----",nsSeparator:"----",load:"currentOnly",returnEmptyString:!1,returnNull:!1,saveMissing:!1,missingKeyHandler:!1,parseMissingKeyHandler:function(e){var t=sessionStorage.getItem("i18nextData_"+this.lng);if(!t)return e;try{var n=JSON.parse(t);if(n&&n.hasOwnProperty(e))return n[e]}catch(t){return e}return e},backend:{language:e.lng,loadPath:i,ajax:function(e,t,n,i,o){n=n||function(){};var r,a="i18nextData_"+t.language;i&&"object"===(void 0===i?"undefined":_typeof(i))&&(o||(i._t=new Date),i=addQueryString("",i).slice(1)),t.queryStringParams&&(e=addQueryString(e,t.queryStringParams)),r=XMLHttpRequest?new XMLHttpRequest:new ActiveXObject("MSXML2.XMLHTTP.3.0");try{r.open(i?"POST":"GET",e,0),t.crossDomain||r.setRequestHeader("X-Requested-With","XMLHttpRequest"),r.withCredentials=!!t.withCredentials,i&&r.setRequestHeader("Content-type","application/x-www-form-urlencoded"),r.overrideMimeType&&r.overrideMimeType("application/json");var s=t.customHeaders;if(s)for(var l in s)s.hasOwnProperty(l)&&r.setRequestHeader(l,s[l]);r.onreadystatechange=function(){r.readyState>3&&(n(r.responseText,r),r.responseText&&!sessionStorage.getItem(a)&&sessionStorage.setItem(a,JSON.stringify(r.responseText)))},r.send(i)}catch(e){console&&console.log(e)}}}};(e=e||o).lng&&(e.lng=e.lng.replace("_","-")),e.debug=e.debug?e.debug:!!n.debugi18next;var r=o;for(var a in e)o.hasOwnProperty(a)&&(o[a]=e[a]);var s="i18nextData_"+e.language;if(t=t||function(){},"undefined"==typeof i18next)return t(),!1;"en-us"===String(e.lng).toLowerCase()||sessionStorage.getItem(s)?i18next.init(r,function(e,n){t(n)}):i18next.use(i18nextXHRBackend).init(r,function(e,n){t(n)})}(e,t)}catch(e){console.log("Error initialized i18next ",e.message),t()}}}}()},9:function(t,n,i){"use strict";i.r(n);var o,r=i(1),a=i(6);$.ajaxSetup({beforeSend:function(e,t){/^(GET|HEAD|OPTIONS|TRACE)$/i.test(t.type)||this.crossDomain||e.setRequestHeader("X-CSRFToken",$("#csrfToken").val())}}),a.a.init({debug:!1,initImmediate:!1});!function e(t,n,i){function r(s,l){if(!n[s]){if(!t[s]){if(!l&&("function"==typeof o&&o))return o(s,!0);if(a)return a(s,!0);throw new Error("Cannot find module '"+s+"'")}var c=n[s]={exports:{}};t[s][0].call(c.exports,function(e){var n=t[s][1][e];return r(n||e)},c,c.exports,e,t,n,i)}return n[s].exports}for(var a="function"==typeof o&&o,s=0;s<i.length;s++)r(i[s]);return r}({1:[function(e,t,n){t.exports={fx:{easing:"easeOutExpo",speed:{slow:1500,mid:1e3,fast:1e3}}}},{}],2:[function(e,t,n){var i=e("./modules/upper-banner"),o=e("./modules/window-scroll"),r=e("./modules/window-resize"),a=e("./modules/nav-toggle"),s=e("./modules/global"),l=e("./modules/admin"),c=e("./modules/video"),d=e("./modules/visobj"),u=e("./modules/menuObj"),p=e("./modules/interventionSessionObj"),f=e("./modules/orgTool"),h=e("./modules/accessCodeObj"),g=e("./modules/utilObj");$(function(){null==window.app&&(window.app={}),window.app.global=new s,window.app.upperBanner=new i,window.app.windowScroll=new o,window.app.windowResize=new r,window.app.navToggle=new a,window.app.admin=new l,window.app.visObj=new d,window.app.interventionSessionObj=new p,window.app.orgTool=new f,window.app.menuObj=new u,window.app.video=new c,window.app.accessCodeObj=new h,window.app.utilObj=new g})},{"./modules/admin":3,"./modules/global":4,"./modules/nav-toggle":5,"./modules/upper-banner":6,"./modules/video":7,"./modules/window-resize":8,"./modules/window-scroll":9,"./modules/visobj":10,"./modules/interventionSessionObj":11,"./modules/orgTool":12,"./modules/menuObj":13,"./modules/accessCodeObj":14,"./modules/utilObj":15}],3:[function(e,t,n){t.exports=function(){function e(){this.build()}return e.prototype.build=function(){return $(".js-mock-submit").on("submit",function(e){return e.preventDefault(),$(this).addClass("is-submitted")})},e}()},{}],4:[function(e,t,n){var i;i=e("../config"),t.exports=function(){function e(){this.addFX(),this.addPlugins(),this.bindEvents(),this.setRoles()}return e.prototype.addFX=function(){return $.extend($.easing,window.easing)},e.prototype.addPlugins=function(){return $(".modal").on("show.bs.modal",function(e){return $(this).addClass("is-modal-active")}),$(".modal").on("hide.bs.modal",function(e){var t;return t=$(this),setTimeout(function(){return t.removeClass("is-modal-active")},200)})},e.prototype.bindEvents=function(){return $(".js-scroll-down").on("click",function(e){var t,n;return e.preventDefault(),n=(t=$($(this).attr("data-target"))).offset().top+t.outerHeight()-92,$("html,body").animate({scrollTop:n},i.fx.speed.mid,i.fx.easing)})},e.prototype.setRoles=function(){var e=$("#currentUserId").val();e&&$.ajax({type:"GET",url:"/api/user/"+e+"/roles",contentType:"application/json; charset=utf-8",cache:!1,async:!1,dataType:"json"}).done(function(e){if(e&&e.roles){var t=[];e.roles.forEach(function(e){t.push(e.name)}),localStorage.setItem("userRoles",JSON.stringify(t))}}).fail(function(e){})},e.prototype.getRoles=function(){return localStorage.getItem("userRoles")?JSON.parse(localStorage.getItem("userRoles")):null},e.prototype.checkRole=function(e){if(e){var t=this.getRoles();return!!t&&-1!==t.indexOf(e)}return!1},e.prototype.reportError=function(e,t,n,i){var o={};e=e||$("#currentUserId").val(),o.subject_id=e||0,o.page_url=t||window.location.href,o.message="Error generated in JS - "+(n||"no detail available"),$.ajax({type:"GET",url:"/report-error",contentType:"application/json; charset=utf-8",cache:!1,async:!i,data:o}).done(function(e){}).fail(function(){})},e}()},{"../config":1}],5:[function(e,t,n){t.exports=function(){function e(){this.build()}return e.prototype.build=function(){return $(".js-nav-menu-toggle").on("click",function(e){return e.preventDefault(),$("html").toggleClass("is-nav-expanded",!$("html").hasClass("is-nav-expanded"))}),$("figure.nav-overlay, .js-close-nav").on("click",function(e){if($("html").hasClass("is-nav-expanded"))return $("html").removeClass("is-nav-expanded")}),$(".side-nav a").not("[data-toggle=modal]").on("click touchend",function(e){var t;return e.preventDefault(),t=$(this).attr("href"),$("html").removeClass("is-nav-expanded"),window.app.utilObj.setVis(!0),setTimeout(function(){return window.location=t},500)}),$(window).on("unload",function(){setTimeout(function(){window.app.utilObj.setVis()},500)}),$(".side-nav a[data-toggle=modal]").on("click touchend",function(e){var t;return e.preventDefault(),t=$(this).attr("data-target"),$("html").removeClass("is-nav-expanded"),setTimeout(function(){return $(t).modal("show")},500)})},e}()},{}],6:[function(e,t,n){t.exports=function(){function e(){this.build()}return e.prototype.build=function(){return $(".js-close-upper-banner").on("click touchstart",function(e){return e.preventDefault(),$("html").addClass("is-upper-banner-closed")})},e.prototype.handleAccess=function(){if("undefined"!=typeof sessionStorage){var e=sessionStorage.getItem("bannerAccessed");"yes"===String(e)&&$(".js-close-upper-banner").trigger("click"),$("a.js-close-upper-banner").on("click",function(){sessionStorage.setItem("bannerAccessed","yes")})}},e.prototype.handleWatermark=function(){var e=$("#env").val();""!==e&&"production"!==e.toLowerCase()&&0===$(".watermark").length&&$("<div class='watermark'>TRUE<sup>NTH</sup> - "+e+" version - Not for study or clinical use</div>").appendTo("body")},e}()},{}],7:[function(e,t,n){t.exports=function(){function e(){this.build()}return e.prototype.build=function(){return $(".js-video-toggle a").on("click",function(e){return e.preventDefault()}),$(".js-video-toggle").on("click",function(e){var t,n;return e.preventDefault(),$("html").addClass("is-video-active"),n=(t=$(this)).data("iframe-src"),t.append("<iframe src='"+n+"' allowfullscreen frameborder='0' />").addClass("is-js-video-active")})},e}()},{}],8:[function(e,t,n){t.exports=function(){return function(){var e;(e=$(".intro")).imagesLoaded(function(){return $(window).on("resize.setElements",_.debounce(function(t){var n;return n=$(window).width()<=767?e.find("img.intro__img--mobile").height():e.find("img.intro__img--desktop").height(),e.css("height",n)},50)).trigger("resize.setElements")})}}()},{}],9:[function(e,t,n){t.exports=function(){function e(){this.bindScroll()}return e.prototype.bindScroll=function(){var e;return e=_.debounce(function(){var e;return e=$(".upper-banner").outerHeight()>0?$(".upper-banner").outerHeight():0,$(window).scrollTop()<=e?$("html").removeClass("is-scrolled"):$("html").addClass("is-scrolled")},0),$(window).on("scroll.checkScroll",e).trigger("scroll.checkScroll")},e}()},{}],10:[function(e,t,n){t.exports=function(){this.HAS_REDIRECT=!1,this.hideMain=function(){$("#mainHolder").hide(),$("#mainHolder").css({visibility:"hidden","-ms-filter":"progid:DXImageTransform.Microsoft.Alpha(Opacity=0)",filter:"alpha(opacity=0)","-moz-opacity":0,"-khtml-opacity":0,opacity:0})},this.showMain=function(){this.HAS_REDIRECT||($(".watermark").length>0&&$("header.no-banner ").css("padding-top","35px"),$("#mainHolder").css({visibility:"visible","-ms-filter":"progid:DXImageTransform.Microsoft.Alpha(Opacity=100)",filter:"alpha(opacity=100)","-moz-opacity":1,"-khtml-opacity":1,opacity:1}),this.hideLoader())},this.showLoader=function(){$("#loadingIndicator").is(":visible")||$("#loadingIndicator").show()},this.hideLoader=function(){$("#loadingIndicator").hide()},this.setRedirect=function(){this.HAS_REDIRECT=!0,this.showLoader(),this.hideMain()}}},{}],11:[function(e,t,n){t.exports=function(){this.setInterventionSession=function(){var e=$("main").attr("data-link-identifier");e&&"undefined"!=typeof sessionStorage&&sessionStorage.setItem(e+"InSession","true")},this.getSession=function(e){return!!e&&"undefined"!=typeof sessionStorage&&sessionStorage.getItem(e+"InSession")},this.clearSession=function(e){this.getSession(e)&&sessionStorage.removeItem(e+"InSession")}}},{}],12:[function(e,t,n){t.exports=function(){var e=function(e,t,n){this.id=e,this.name=t,this.children=[],this.parentOrgId=n,this.isTopLevel=!1},t={staff_editable:!0,include_in_reports:!0,send_reminders:!0},n=[],i={};this.inArray=function(e,t){if(e&&t)for(var n=0;n<t.length;n++)if(t[n]===e)return!0;return!1},this.getTopLevelOrgs=function(){return n},this.getOrgsList=function(){return i},this.setDefaultConsent=function(e,n){if(!e&&!n)return!1;var i=$("#stock_consent_url").val(),o="";if(i&&(o=i.replace("placeholder",$("#"+n+"_org").attr("data-parent-name"))),o){var r=t;r.org=n,r.agreementUrl=encodeURIComponent(o),this.setConsent(e,r,"default",!0)}},this.setConsent=function(e,t,n,i){var o=window.app.utilObj.hasValue;e&&t&&(this.hasConsent(e,t.org,n)||$.ajax({type:"POST",url:"/api/user/"+e+"/consent",contentType:"application/json; charset=utf-8",cache:!1,dataType:"json",async:!i,data:JSON.stringify({user_id:e,organization_id:t.org,agreement_url:t.agreementUrl,staff_editable:!!o(t.staff_editable)&&t.staff_editable,include_in_reports:!!o(t.include_in_reports)&&t.include_in_reports,send_reminders:!!o(t.send_reminders)&&t.send_reminders})}).done(function(e){}).fail(function(t){window.app.global.reportError(e,"/api/user/"+e+"/consent",t.responseText)}))},this.hasConsent=function(e,t,n){if(!e)return!1;if(!t)return!1;var i=[],o=0,r=!1,a=!1,s=this;return $.ajax({type:"GET",url:"/api/user/"+e+"/consent",async:!1,cache:!1}).done(function(e){if(e.consent_agreements){var l=e.consent_agreements;if(l.length>0){var c=(l=l.sort(function(e,t){return new Date(t.signed)-new Date(e.signed)}))[0];if(o=s.getDateDiff(c.expires),c.deleted&&(r=!0),o>0&&(r=!0),c.staff_editable&&c.include_in_reports&&!c.send_reminders&&(a=!0),!r&&String(t)===String(c.organization_id)){switch(n){case"suspended":a&&(r=!0);break;case"purged":r=!0;break;case"consented":a||c.staff_editable&&c.send_reminders&&c.include_in_reports&&(r=!0);break;default:r=!0}r&&i.push(t)}}}}).fail(function(){return!1}),i.length>0?i:null},this.getDateDiff=function(e,t){var n,i=e.split(/[^0-9]/),o=new Date(i[0],i[1]-1,i[2]).getTime();if(t){var r=t.split(/[^0-9]/);n=new Date(r[0],r[1]-1,r[2]).getTime()}else n=(new Date).getTime();return Math.floor((n-o)/864e5)},this.validateIdentifier=function(e,t){if(this.identifiers)return this.identifiers;$.ajax({type:"GET",url:"/gil-shortcut-alias-validation/"+$("#shortcut_alias").val().toLowerCase(),async:!e}).done(function(e){t&&t(e)}).fail(function(){t&&t({error:"failed request"})})},this.getOrgs=function(e,n,i){var o=this;$.ajax({type:"GET",url:"/api/organization",async:!n}).done(function(n){$("#fillOrgs").attr("userId",e),o.populateOrgsList.apply(o,[n.entry]),o.populateUI(),i&&i(),$("#modal-org").on("hide.bs.modal",function(e){"undefined"!=typeof sessionStorage?sessionStorage.setItem("noOrgModalViewed","true"):alert(i18next.t("Unable to set session variable for organization modal viewed.")),setTimeout(function(){location.reload()},0)}),$("#submit-orgs").on("click",function(){var e=$("#userOrgs input[name='organization']:checked");e.length>0&&(e.each(function(){if("noOrgs"!==$(this).attr("id")){var e=$(this).attr("data-parent-id");e||(e=$(this).closest(".org-container[data-parent-id]").attr("data-parent-id"));var n=$("#"+e+"_agreement_url").val();if(n&&""!==String(n)){var i=t;i.org=e,i.agreementUrl=n,setTimeout(function(){o.setConsent($("#currentUserId").val(),i,"all",!0)},0)}else o.setDefaultConsent($("#currentUserId").val(),e)}}),o.updateOrg($("#currentUserId").val(),o.updateOrgCallback))}),$("#userOrgs input[name='organization']").each(function(){$(this).on("click",function(){$("#fillOrgs").attr("userId"),$(this).attr("data-parent-id"),$(this).prop("checked")&&("noOrgs"!==$(this).attr("id")?$("#noOrgs").prop("checked",!1):$("#userOrgs input[name='organization']").each(function(){"noOrgs"!==$(this).attr("id")&&$(this).prop("checked",!1)}))})})}).fail(function(t){window.app.global.reportError(e,"/api/organization",t.responseText),i&&i()})},this.updateOrg=function(e,t){var n={},i="",o=window.app.utilObj.hasValue;$.ajax({type:"GET",url:"/api/demographics/"+e,async:!1}).done(function(e){n=e}).fail(function(){i=i18next.t("Error retrieving demographics information for user.")});var r=$("#userOrgs input[name='organization']:checked").map(function(){return{reference:"api/organization/"+$(this).val()}}).get();o(i)?void 0!==t&&t(i):(void 0===r&&(r=[0]),n.careProvider=r,$.ajax({type:"PUT",url:"/api/demographics/"+e,contentType:"application/json; charset=utf-8",dataType:"json",async:!0,data:JSON.stringify(n)}).done(function(e){t&&t(i)}).fail(function(){i+=(o(i)?"<br/>":"")+i18next.t("Error occurred updating user organization."),t&&t(i)}))},this.filterOrgs=function(e){if(!e)return!1;var t=this;$("input[name='organization']:checkbox").each(function(){t.inArray($(this).val(),e)||($(this).hide(),i[$(this).val()]&&0===i[$(this).val()].children.length&&$(this).closest("label").hide())}),t.getTopLevelOrgs().forEach(function(e){var t=!0;$(".org-container[data-parent-id='"+e+"']").each(function(){var e=$(this).find(".org-container");if(e.length>0){var n=!0;e.each(function(){var e=!1;$(this).find("input[name='organization']").each(function(){$(this).is(":visible")&&(e=!0,t=!1)}),e?n=!1:$(this).hide()}),n&&$(this).children("label").hide()}else{var i=$(this).find("input[name='organization']");i.length>0&&i.each(function(){$(this).is(":visible")&&(t=!1)})}}),t&&$("#fillOrgs").find("legend[orgid='"+e+"']").hide()})},this.findOrg=function(e,t){var n;return e&&t&&e.forEach(function(e){n||String(e.id)===String(t)&&(n=e)}),n},this.getTopLevelOrgs=function(){if(0===n.length){var e=$("#fillOrgs").find('input[name="organization"][parent_org="true"]');e.length>0&&e.each(function(){n.push[$(this).val()]})}return n},this.populateOrgsList=function(t){if(!t)return!1;var o,r=t,a=this;return t.forEach(function(t){if(t.partOf){if(o=t.partOf.reference.split("/").pop(),!i[o]){var s=a.findOrg(r,o);i[o]=new e(s.id,s.name)}i[o].children.push(new e(t.id,t.name,o)),i[t.id]?i[t.id].parentOrgId=o:i[t.id]=new e(t.id,t.name,o)}else i[t.id]||(i[t.id]=new e(t.id,t.name)),0!==parseInt(t.id)&&(i[t.id].isTopLevel=!0,n.push(t.id))}),t.forEach(function(e){e.partOf&&(o=e.partOf.reference.split("/").pop(),i[e.id]&&(i[e.id].parentOrgId=o))}),i},this.populateUI=function(){var e=0;for(var t in this.getTopLevelOrgs(),i){if(i[t].isTopLevel&&(i[t].children.length>0?$("#fillOrgs").append("<legend orgId='"+t+"'>"+i18next.t(i[t].name)+"</legend><input class='tnth-hide' type='radio' name='organization' parent_org=\"true\" org_name=\""+i[t].name+"\" id='"+i[t].id+"_org' value='"+i[t].id+"' />"):$("#fillOrgs").append('<div id="'+i[t].id+'_container" data-parent-id="'+i[t].name+'"  data-parent-name="'+i[t].name+'" class="org-container"><label id="org-label-'+i[t].id+'" class="org-label"><input class="clinic" type="radio" name="organization" parent_org="true" id="'+i[t].id+'_org" value="'+i[t].id+'"  data-parent-id="'+i[t].id+'"  data-parent-name="'+i[t].name+'"/><span>'+i18next.t(i[t].name)+"</span></label></div>"),e++),i[t].children.length>0){var n="";i[t].children.forEach(function(e,t){var o=e.parentOrgId,r=i[o],a=!!r&&r.isTopLevel;n='<div id="'+e.id+'_container" '+(a?' data-parent-id="'+o+'"  data-parent-name="'+r.name+'" ':"")+' class="indent org-container">',i[e.id].children.length>0?n+='<label class="org-label '+(i[e.parentOrgId].isTopLevel?"text-muted":"text-muter")+'"><input class="clinic" type="radio" name="organization" id="'+e.id+'_org" value="'+e.id+'"  '+(a?' data-parent-id="'+o+'"  data-parent-name="'+r.name+'" ':"")+"/><span>"+i18next.t(e.name)+"</span></label>":n+='<label class="org-label"><input class="clinic" type="radio" name="organization" id="'+e.id+'_org" value="'+e.id+'"  '+(a?' data-parent-id="'+o+'"  data-parent-name="'+r.name+'" ':"")+"/><span>"+i18next.t(e.name)+"</span></label>",n+="</div>",$("#"+o+"_container").length>0?$("#"+o+"_container").append(n):$("#fillOrgs").append(n)})}e>0&&i[t].isTopLevel&&$("#fillOrgs").append("<span class='divider'>&nbsp;</span>")}},this.handleNoOrgs=function(e){$(".intervention-link, a.decision-support-link").each(function(){if(/decision\s?support/gi.test($(this).text())||$(this).hasClass("decision-support-link")){if("undefined"!=typeof sessionStorage&&sessionStorage.getItem("noOrgModalViewed"))return!1;var t=this;$.ajax({type:"GET",url:"/api/demographics/"+e,async:!1}).done(function(e){e&&e.careProvider&&$.each(e.careProvider,function(e,n){var i=n.reference.split("/").pop();0===parseInt(i)&&($(t).removeAttr("href"),$(t).on("click",function(){$("figure.js-close-nav").trigger("click"),setTimeout(function(){$("#modal-org").modal("show")},0)}),window.app.interventionSessionObj.clearSession("decision-support"))})}).fail(function(t){window.app.global.reportError(e,"/api/demographics/"+e,t.responseText)})}})},this.updateOrgCallback=function(e){e?$("#modal-org-error").html(i18next.t("Error updating organization")):($("#modal-org a.box-modal__close").trigger("click"),window.app.utilObj.setVis(!0),setTimeout(function(){location.reload()},1e3),"undefined"!=typeof sessionStorage&&sessionStorage.setItem("noOrgModalViewed","true"))}}},{}],13:[function(e,t,n){t.exports=function(){this.init=function(e){window.app.global.checkRole("patient")||window.app.global.checkRole("partner")?this.filterMenu(e):window.app.visObj.hideLoader(),this.setSelectedNavItem($(".side-nav-items__item--"+$("main").attr("data-section"))),this.handleDisabledLinks(),$("footer a[href='/"+$("main").attr("data-link-identifier")+"']").hide(),"about"===$("main").attr("data-section")&&$("#repoVersion").show()},this.handleDisabledLinks=function(){window.app.utilObj.getUrlParameter("disableLinks")&&$("nav.side-nav li.side-nav-items__item, footer .nav-list__item").each(function(){$(this).hasClass("side-nav-items__item--home")||$(this).hasClass("side-nav-items__item--logout")||$(this).hasClass("nav-list__item--home")||$(this).children("a").each(function(){$(this).addClass("disabled"),$(this).prop("onclick",null).off("click"),$(this).on("click",function(e){return e.preventDefault(),!1})})})},this.setSelectedNavItem=function(e){$(e).addClass("side-nave-items__item--selected"),$("li.side-nave-items__item--selected").find("a").attr("href","#"),$(e).on("click",function(e){e.preventDefault(),window.app.utilObj.setVis(!1),$(".side-nav__close").trigger("click")})},this.handleItemRedirect=function(e,t,n){var i=window.app.visObj;if(n){if(window.app.orgTool.handleNoOrgs(e),window.app.interventionSessionObj.getSession(t)){var o=$("#intervention_item_"+t+" a"),r=o.attr("href");if(o.length>0&&window.app.utilObj.validateUrl(r))return window.app.interventionSessionObj.clearSession(t),i.setRedirect(),setTimeout(function(){location.replace(o.attr("href"))},0),!0}}else $("."+t+"-link").each(function(){$(this).removeAttr("href"),$(this).addClass("icon-box__button--disabled")}),$(".icon-box-"+t).addClass("icon-box--theme-inactive"),window.app.interventionSessionObj.clearSession(t)},this.setItemVis=function(e,t,n){if(e)switch(n){case"disabled":e.removeAttr("href"),e.addClass("icon-box__button--disabled");break;default:e.attr("href",t),e.removeClass("icon-box__button--disabled")}},this.handleInterventionItemLinks=function(e,t){var n=this;if(e){var i=e.link_url,o="disabled"===String(i),r=t||e.name,a=$("."+r+"-link"),s=$("#intervention_item_"+r);o||0!==s.length||$(".side-nav-items__item--dashboard").after('<li id="intervention_item_'+r+'" class="side-nav-items__item side-nav-items__item--has-icon side-nav-items__item--accentuated"><a href="'+i+'" class="capitalize intervention-link">'+e.description+"</a></li>"),a.length>0&&(o?(a.each(function(){n.setItemVis($(this),i,"disabled")}),$(".icon-box-"+r).addClass("icon-box--theme-inactive")):(a.each(function(){n.setItemVis($(this),i)}),$(".icon-box-"+r).removeClass("icon-box--theme-inactive")))}},this.filterMenu=function(e){if(!e)return!1;var t=this,n=$("#portalURI").val();$.ajax({url:n+"/gil-interventions-items/"+e,context:document.body,async:!1,cache:!1}).done(function(i){var o=!1,r=!1;i.interventions&&(i.interventions.length>0&&(0===$(".side-nav-items__item--dashboard").length&&($(".side-nav-items").prepend('<li class="side-nav-items__item side-nav-items__item--dashboard"><a href="'+n+'/home">'+i18next.t("My Dashboard")+"</a></li>"),$("#portalMain").length>0&&t.setSelectedNavItem($(".side-nav-items__item--dashboard"))),$(".side-nav-items__item--home").hide()),i.interventions.forEach(function(e){var n=e.description,i=(e.link_url,e.name.replace(/\_/g," ")),a="disabled"==e.link_url,s=/decision\s?support/gi;s.test(n)||s.test(i)?(a||(o=!0),t.handleInterventionItemLinks(e,"decision-support")):/symptom\s?tracker/gi.test(n)||/self[_\s]?management/gi.test(i)?(a||(r=!0),t.handleInterventionItemLinks(e,"symptom-tracker")):""!==$.trim(n)&&t.handleInterventionItemLinks(e)}),t.handleItemRedirect(e,"decision-support",o),t.handleItemRedirect(e,"symptom-tracker",r)),window.app.utilObj.setVis(!1)}).fail(function(){window.app.utilObj.setVis(!1)})}}},{}],14:[function(e,t,n){t.exports=function(){this.handleAccessCode=function(){""!==$("#shortcut_alias").val()&&""===$("#access_code_error").text()?($("#access_code_info").show(),$("#accessCodeLink").addClass("icon-box__button--disabled"),$("#btnCreateAccount").removeAttr("href").addClass("icon-box__button--disabled"),$("#shortcut_alias").attr("disabled",!0),window.app.interventionSessionObj.setInterventionSession(),setTimeout(function(){location.replace("/go/"+$("#shortcut_alias").val().toLowerCase())},4e3)):""!==$("#access_code_error").text()&&$("#access_code_error").show()},this.handleEvents=function(){var e=this;$("#shortcut_alias").on("keyup paste",function(e){""!==$(this).val()?window.app.orgTool.validateIdentifier(!1,function(e){e?e.name?($("#access_code_info").html(i18next.t("Thank you, your access code {shortcut_alias} indicates you are located at the {org_name}. Proceeding to registration ...").replace("{shortcut_alias}","<b>"+$("#shortcut_alias").val()+"</b>").replace("{org_name}","<b>"+e.name+"</b>")),$("#access_code_error").text("")):e.error&&($("#access_code_info").text(""),$("#access_code_error").text(i18next.t("You have entered an invalid access code.  Please try again"))):""!==$("#shortcut_alias").val()&&($("#access_code_info").text(""),$("#access_code_error").text(i18next.t("System was unable to process your request.")))}):$("#access_code_info").text("")}).on("keydown",function(t){13===t.keyCode&&(t.preventDefault(),e.handleAccessCode())}),$("#accessCodeLink").on("click",function(){e.handleAccessCode()})}}},{}],15:[function(e,t,n){t.exports=function(){this.handlePostLogout=function(){$("main[data-section='home']").length&&r.a.handlePostLogout()},this.setVis=function(e){e?window.app.visObj.showLoader():window.app.visObj.showMain()},this.LRKeyEvent=function(){$(".button--LR").length>0&&$("html").on("keydown",function(e){187===e.keyCode&&$(".button--LR").toggleClass("show")})},this.appendLREditContainer=function(e,t,n){if(!t)return!1;e||(e=$(document)),e.append('<div><a href="'+t+'" target="_blank" class="menu button button--small button--teal button--LR">'+i18next.t("Edit in Liferay")+"</a></div>"),n&&$(".button--LR").addClass("show")},this.hasValue=function(e){return null!=e&&""!=e&&"undefined"!=e},this.validateUrl=function(e){return e&&"#"!==$.trim(e)&&/^(https?|ftp)?(:)?(\/\/)?([a-zA-Z0-9.-]+(:[a-zA-Z0-9.&%$-]+)*@)*((25[0-5]|2[0-4][0-9]|1[0-9]{2}|[1-9][0-9]?)(\.(25[0-5]|2[0-4][0-9]|1[0-9]{2}|[1-9]?[0-9])){3}|([a-zA-Z0-9-]+\.)*[a-zA-Z0-9-]+\.(com|edu|gov|int|mil|net|org|biz|arpa|info|name|pro|aero|coop|museum|[a-zA-Z]{2}))(:[0-9]+)*(\/($|[a-zA-Z0-9.,?'\\+&%$#=~_-]+))*$/.test(e)},this.getUrlParameter=function(e){e=e.replace(/[\[]/,"\\[").replace(/[\]]/,"\\]");var t=new RegExp("[\\?&]"+e+"=([^&#]*)").exec(location.search);return null===t?"":decodeURIComponent(t[1].replace(/\+/g," "))},this.initSessionMonitor=function(){$.ajax({url:$("#portalURI").val()+"/api/portal-wrapper-html/",type:"GET",contentType:"text/plain"},"html").done(function(e){$("#portalWrapperNav").html(e)}).fail(function(e){var t={};t.subject_id=$("#currentUserId").val()?$("#currentUserId").val():0,t.page_url=window.location.href,t.message="In GIL, error loading nav elements from portal - "+e.responseText,$.ajax({type:"GET",url:"/report-error",contentType:"application/json; charset=utf-8",cache:!1,async:!0,data:t}).done(function(e){})})},this.handleLoginAsUser=function(){"undefined"!=typeof sessionStorage&&sessionStorage.getItem("loginAsPatient")&&("undefined"!=typeof history&&history.pushState&&history.pushState(null,null,location.href),window.addEventListener("popstate",function(e){"undefined"!=typeof history&&history.pushState?(history.pushState(null,null,location.href),setTimeout(function(){location.reload()},0)):(window.history.forward(1),setTimeout(function(){location.reload()},0))}))}}},{}]},{},[2]),$(document).ready(function(){r.a.displaySystemOutageMessage();var t=$("#currentUserId").val();""!==t?(window.app.utilObj.initSessionMonitor(),window.app.utilObj.handleLoginAsUser(),window.app.orgTool.getOrgs(t)):window.app.utilObj.handlePostLogout(),$(".button--login--register").on("click",function(){$("#modal-login-register").modal("hide"),setTimeout(function(){$("#modal-login").modal("show")},400)}),$("#modal-login").on("show.bs.modal",function(e){window.app.utilObj.setVis(!1)}),$("#btnCreateAccount").on("click",function(){window.app.interventionSessionObj.setInterventionSession()}),$("a.icon-box__button--disabled, .side-nave-items__item--selected a").on("click",function(e){return e.preventDefault(),window.app.utilObj.setVis(!1),!1}),$("#password").on("keyup",function(){13===e.keyCode&&(e.preventDefault(),""!==$("input[name='email']").val()&&$("#btnLogin").trigger("click"))}),$("input[type='text']").on("blur paste",function(){$(this).val($.trim($(this).val()))}),"true"===$("#sessionTimedOut").val()&&$("#timeout-modal").modal("show"),"white"===$("main").attr("data-theme")&&$("body").addClass("theme--intro-light"),"true"===String($("#showFlashMessageModal").val()).toLowerCase()&&$("#alertModal").modal("show"),window.app.upperBanner.handleAccess(),window.app.upperBanner.handleWatermark(),window.app.accessCodeObj.handleEvents(),window.app.menuObj.init(t),window.app.interventionSessionObj.clearSession($("main").attr("data-link-identifier")),window.app.utilObj.appendLREditContainer($("main .LR-content-container"),$("#LREditorURL").val(),window.app.global.checkRole("content_manager")),setTimeout(function(){window.app.utilObj.setVis(!1)},0)})}});
//# sourceMappingURL=../../maps/gil.bundle.js.map